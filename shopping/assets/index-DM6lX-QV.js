import{r as $,a as fp}from"./vendor-YsBxPMQB.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();var Ph={exports:{}},qo={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pp=$,gp=Symbol.for("react.element"),mp=Symbol.for("react.fragment"),_p=Object.prototype.hasOwnProperty,yp=pp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wp={key:!0,ref:!0,__self:!0,__source:!0};function Dh(n,t,e){var r,i={},o=null,s=null;e!==void 0&&(o=""+e),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)_p.call(t,r)&&!wp.hasOwnProperty(r)&&(i[r]=t[r]);if(n&&n.defaultProps)for(r in t=n.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:gp,type:n,key:o,ref:s,props:i,_owner:yp.current}}qo.Fragment=mp;qo.jsx=Dh;qo.jsxs=Dh;Ph.exports=qo;var y=Ph.exports,xh,Wc=fp;xh=Wc.createRoot,Wc.hydrateRoot;const Ki=({onClick:n,Icon:t,alt:e,className:r,color:i,TextColor:o})=>y.jsxs("div",{className:`flex flex-col w-fit ${r}`,onClick:n,children:[y.jsx(t,{className:"w-6 h-6 mx-auto",color:i}),y.jsx("p",{className:`text-10 ${o}`,children:e})]}),vp=({Icon:n,alt:t,className:e,onClick:r})=>y.jsxs("div",{className:`flex rounded-2xl flex-col w-custom bg-gradient-to-b from-[#edaa5b] to-[#df5822] ${e}`,onClick:r,children:[y.jsx(n,{alt:t,className:"w-12 h-12  mx-auto"}),y.jsx("p",{className:"text-10 mx-auto  pb-2 text-white",children:t})]}),lo=n=>{const{style:t,color:e="#ACACAC",width:r=24,height:i=24,className:o=""}=n;return y.jsx("svg",{width:r,height:i,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:t,className:o,children:y.jsx("g",{mask:"url(#mask0_1235_3833)",children:y.jsx("path",{d:"M0.192187 1.79063C0.065625 1.60313 0 1.37813 0 1.15313C0 0.515625 0.515625 0 1.15313 0H6.27656C6.80156 0 7.29375 0.276562 7.56094 0.726562L10.7719 6.075C8.5125 6.36094 6.49219 7.41563 4.9875 8.97656L0.192187 1.79063ZM23.8031 1.79063L19.0125 8.97656C17.5078 7.41563 15.4875 6.36094 13.2281 6.075L16.4391 0.726562C16.7109 0.276562 17.1984 0 17.7234 0H22.8469C23.4844 0 24 0.515625 24 1.15313C24 1.37813 23.9344 1.60313 23.8078 1.79063H23.8031ZM3.75 15.75C3.75 13.562 4.61919 11.4635 6.16637 9.91637C7.71354 8.36919 9.81196 7.5 12 7.5C14.188 7.5 16.2865 8.36919 17.8336 9.91637C19.3808 11.4635 20.25 13.562 20.25 15.75C20.25 17.938 19.3808 20.0365 17.8336 21.5836C16.2865 23.1308 14.188 24 12 24C9.81196 24 7.71354 23.1308 6.16637 21.5836C4.61919 20.0365 3.75 17.938 3.75 15.75ZM12.3937 11.3016C12.2344 10.9734 11.7703 10.9734 11.6063 11.3016L10.5562 13.4297C10.4906 13.5609 10.3687 13.65 10.2281 13.6688L7.875 14.0109C7.51406 14.0625 7.37344 14.5031 7.63125 14.7609L9.33281 16.4203C9.43594 16.5234 9.48281 16.6641 9.45938 16.8094L9.05625 19.1484C8.99531 19.5047 9.37031 19.7812 9.69375 19.6125L11.7938 18.5062C11.9203 18.4406 12.075 18.4406 12.2016 18.5062L14.3016 19.6125C14.625 19.7812 15 19.5094 14.9391 19.1484L14.5359 16.8094C14.5125 16.6688 14.5594 16.5234 14.6625 16.4203L16.3641 14.7609C16.6266 14.5078 16.4812 14.0672 16.1203 14.0109L13.7719 13.6688C13.6312 13.65 13.5047 13.5562 13.4437 13.4297L12.3937 11.3016Z",fill:e})})})},Ep=n=>{const{style:t,color:e="#ACACAC",width:r=30,height:i=24,ClassName:o="mx-auto"}=n;return y.jsx("svg",{className:o,width:r,height:i,viewBox:"0 0 30 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:t,children:y.jsx("path",{d:"M1.725 9H28.2703C29.2219 9 29.9953 8.22656 29.9953 7.275C29.9953 6.93281 29.8922 6.6 29.7047 6.31875L26.1656 1.00312C25.7484 0.375 25.05 0 24.2953 0H5.70469C4.95469 0 4.25156 0.375 3.83438 1.00312L0.290625 6.31406C0.103125 6.6 0 6.93281 0 7.27031C0 8.22656 0.773438 9 1.725 9ZM3 10.5V18V21.75C3 22.9922 4.00781 24 5.25 24H15.75C16.9922 24 18 22.9922 18 21.75V18V10.5H15V18H6V10.5H3ZM24 10.5V22.5C24 23.3297 24.6703 24 25.5 24C26.3297 24 27 23.3297 27 22.5V10.5H24Z",fill:e})})},Ip=n=>{const{style:t,color:e="white",width:r=46,height:i=46}=n;return y.jsxs("svg",{className:"mx-auto",width:r,height:i,viewBox:"0 0 46 46",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:t,children:[y.jsx("path",{d:"M17.25 11.5H13.4167C12.9083 11.5 12.4208 11.7019 12.0614 12.0614C11.7019 12.4208 11.5 12.9083 11.5 13.4167V17.25",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),y.jsx("path",{d:"M28.75 11.5H32.5833C33.0917 11.5 33.5792 11.7019 33.9386 12.0614C34.2981 12.4208 34.5 12.9083 34.5 13.4167V17.25",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),y.jsx("path",{d:"M34.5 28.75V32.5833C34.5 33.0917 34.2981 33.5792 33.9386 33.9386C33.5792 34.2981 33.0917 34.5 32.5833 34.5H28.75",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),y.jsx("path",{d:"M17.25 34.5H13.4167C12.9083 34.5 12.4208 34.2981 12.0614 33.9386C11.7019 33.5792 11.5 33.0917 11.5 32.5833V28.75",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),y.jsx("path",{d:"M11.5 23H34.5",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})},Ap=n=>{const{style:t,color:e="#ACACAC",width:r=26,height:i=26}=n;return y.jsxs("svg",{className:"mx-auto",width:r,height:i,viewBox:"0 0 26 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:t,children:[y.jsxs("g",{clipPath:"url(#clip0)",children:[y.jsx("path",{d:"M1.10093 26C1.09318 26 1.08543 26 1.07768 25.9995H0.455219C0.2035 25.9995 -0.000793457 25.7947 -0.000793457 25.5424V0.457151C-0.000337445 0.204804 0.203956 0 0.455675 0H2.27699C2.52871 0 2.733 0.204804 2.733 0.457151V23.2576H25.5441C25.7958 23.2576 26.0001 23.4624 26.0001 23.7147V25.5337C26.0001 25.7861 25.7963 25.9909 25.5441 25.9909L1.10139 26.0005L1.10093 26Z",fill:e}),y.jsx("path",{d:"M5.30709 18.324C5.24826 18.324 5.18898 18.3126 5.13243 18.2892C4.96189 18.2184 4.85107 18.052 4.85107 17.8668V14.1881C4.85107 14.067 4.89896 13.9504 4.98469 13.8649L10.1581 8.67856C10.2471 8.58942 10.3638 8.54462 10.4805 8.54462C10.5973 8.54462 10.714 8.58942 10.8029 8.67856L15.1866 13.0727L21.0632 7.18185L19.3646 5.47896C19.2342 5.34822 19.1954 5.15164 19.2656 4.98067C19.3363 4.8097 19.5023 4.69861 19.687 4.69861H25.544C25.7957 4.69861 26 4.90341 26 5.15576V11.0274C26 11.2121 25.8887 11.379 25.7187 11.4498C25.6621 11.4731 25.6028 11.4846 25.544 11.4846C25.4254 11.4846 25.3087 11.4379 25.2216 11.3506L23.543 9.66784L15.5095 17.721C15.4205 17.8102 15.3038 17.855 15.1871 17.855C15.0703 17.855 14.9536 17.8102 14.8646 17.721L10.481 13.3269L5.62994 18.19C5.54285 18.2774 5.42611 18.324 5.30754 18.324H5.30709Z",fill:e})]}),y.jsx("defs",{children:y.jsx("clipPath",{id:"clip0",children:y.jsx("rect",{width:"26",height:"26",fill:"white"})})})]})},Tp=n=>{const{style:t,color:e="#ACACAC",width:r=29,height:i=24}=n;return y.jsx("svg",{className:"mx-auto",width:r,height:i,viewBox:"0 0 29 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:t,children:y.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 1C0 0.447715 0.447715 0 1 0H27.1935C27.7458 0 28.1935 0.447715 28.1935 1C28.1935 1.55228 27.7458 2 27.1935 2H1C0.447715 2 0 1.55228 0 1ZM0 11.8387C0 11.2864 0.447715 10.8387 1 10.8387H27.1935C27.7458 10.8387 28.1935 11.2864 28.1935 11.8387C28.1935 12.391 27.7458 12.8387 27.1935 12.8387H1C0.447715 12.8387 0 12.391 0 11.8387ZM1 21.6774C0.447715 21.6774 0 22.1251 0 22.6774C0 23.2297 0.447715 23.6774 1 23.6774H27.1935C27.7458 23.6774 28.1935 23.2297 28.1935 22.6774C28.1935 22.1251 27.7458 21.6774 27.1935 21.6774H1Z",fill:e})})},Cp=({setCurrentPage:n})=>{const[t,e]=$.useState("map"),r=(i,o)=>{n(i),e(o)};return y.jsx("footer",{className:"z-50 fixed bottom-0 left-0 w-full overflow-x-auto",children:y.jsxs("div",{className:"bg-white w-screen flex justify-around items-center py-6 shadow-inner shadow-gray-300",children:[y.jsx(Ki,{Icon:lo,alt:"ランキング",onClick:()=>r("ranking","ranking"),className:"mx-auto",TextColor:t==="ranking"?"text-red-500":"text-gray-500",color:t==="ranking"?"red":"#ACACAC"}),y.jsx(Ki,{Icon:Ep,alt:"マップ",onClick:()=>r("map","map"),className:"mx-auto",TextColor:t==="map"?"text-red-500":"text-gray-500",color:t==="map"?"red":"#ACACAC"}),y.jsx(vp,{Icon:Ip,alt:"チェックイン",onClick:()=>r("QRCodeReader","QRCodeReader"),className:"mx-auto",color:t==="QRCodeReader"?"red":"#ACACAC"}),y.jsx(Ki,{Icon:Ap,alt:"急上昇",onClick:()=>r("trending","trending"),className:"mx-auto",TextColor:t==="trending"?"text-red-500":"text-gray-500",color:t==="trending"?"red":"#ACACAC"}),y.jsx(Ki,{Icon:Tp,alt:"メニュー",onClick:()=>r("menu","menu"),className:"mx-auto",TextColor:t==="menu"?"text-red-500":"text-gray-500",color:t==="menu"?"red":"#ACACAC"})]})})};var zc={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},Sp=function(n){const t=[];let e=0,r=0;for(;e<n.length;){const i=n[e++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[e++];t[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[e++],s=n[e++],a=n[e++],u=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(u&1023))}else{const o=n[e++],s=n[e++];t[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return t.join("")},kh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],s=i+1<n.length,a=s?n[i+1]:0,u=i+2<n.length,c=u?n[i+2]:0,h=o>>2,d=(o&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;u||(g=64,s||(f=64)),r.push(e[h],e[d],e[f],e[g])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Mh(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):Sp(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=e[n.charAt(i++)],a=i<n.length?e[n.charAt(i)]:0;++i;const c=i<n.length?e[n.charAt(i)]:64;++i;const d=i<n.length?e[n.charAt(i)]:64;if(++i,o==null||a==null||c==null||d==null)throw new bp;const f=o<<2|a>>4;if(r.push(f),c!==64){const g=a<<4&240|c>>2;if(r.push(g),d!==64){const _=c<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Rp=function(n){const t=Mh(n);return kh.encodeByteArray(t,!0)},Co=function(n){return Rp(n).replace(/\./g,"")},Lh=function(n){try{return kh.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op=()=>Np().__FIREBASE_DEFAULTS__,Pp=()=>{if(typeof process>"u"||typeof zc>"u")return;const n=zc.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Dp=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Lh(n[1]);return t&&JSON.parse(t)},$o=()=>{try{return Op()||Pp()||Dp()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Vh=n=>{var t,e;return(e=(t=$o())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},Bh=n=>{const t=Vh(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),r]:[t.substring(0,e),r]},Fh=()=>{var n;return(n=$o())===null||n===void 0?void 0:n.config},Uh=n=>{var t;return(t=$o())===null||t===void 0?void 0:t[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},r=t||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Co(JSON.stringify(e)),Co(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ee(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Mp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ee())}function kp(){var n;const t=(n=$o())===null||n===void 0?void 0:n.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Lp(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Vp(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Bp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Fp(){const n=ee();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Up(){return!kp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jp(){try{return typeof indexedDB=="object"}catch{return!1}}function Hp(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var o;t(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="FirebaseError";class Le extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=Gp,Object.setPrototypeOf(this,Le.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_i.prototype.create)}}class _i{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},i=`${this.service}/${t}`,o=this.errors[t],s=o?Wp(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new Le(i,a,r)}}function Wp(n,t){return n.replace(zp,(e,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const zp=/\{\$([^}]+)}/g;function Xp(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function So(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const i of e){if(!r.includes(i))return!1;const o=n[i],s=t[i];if(Xc(o)&&Xc(s)){if(!So(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!e.includes(i))return!1;return!0}function Xc(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function qp(n,t){const e=new $p(n,t);return e.subscribe.bind(e)}class $p{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let i;if(t===void 0&&e===void 0&&r===void 0)throw new Error("Missing Observer.");Kp(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:r},i.next===void 0&&(i.next=js),i.error===void 0&&(i.error=js),i.complete===void 0&&(i.complete=js);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Kp(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function js(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(n){return n&&n._delegate?n._delegate:n}class yn{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new xp;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Zp(t))try{this.getOrInitializeService({instanceIdentifier:Dn})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(t=Dn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Dn){return this.instances.has(t)}getOptions(t=Dn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(t,e){var r;const i=this.normalizeInstanceIdentifier(e),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(t),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&t(s,i),()=>{o.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Qp(t),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Dn){return this.component?this.component.multipleInstances?t:Dn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Qp(n){return n===Dn?void 0:n}function Zp(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Yp(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(rt||(rt={}));const t0={debug:rt.DEBUG,verbose:rt.VERBOSE,info:rt.INFO,warn:rt.WARN,error:rt.ERROR,silent:rt.SILENT},e0=rt.INFO,n0={[rt.DEBUG]:"log",[rt.VERBOSE]:"log",[rt.INFO]:"info",[rt.WARN]:"warn",[rt.ERROR]:"error"},r0=(n,t,...e)=>{if(t<n.logLevel)return;const r=new Date().toISOString(),i=n0[t];if(i)console[i](`[${r}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Ua{constructor(t){this.name=t,this._logLevel=e0,this._logHandler=r0,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in rt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?t0[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,rt.DEBUG,...t),this._logHandler(this,rt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,rt.VERBOSE,...t),this._logHandler(this,rt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,rt.INFO,...t),this._logHandler(this,rt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,rt.WARN,...t),this._logHandler(this,rt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,rt.ERROR,...t),this._logHandler(this,rt.ERROR,...t)}}const i0=(n,t)=>t.some(e=>n instanceof e);let qc,$c;function o0(){return qc||(qc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s0(){return $c||($c=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hh=new WeakMap,ua=new WeakMap,Gh=new WeakMap,Hs=new WeakMap,ja=new WeakMap;function a0(n){const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{e(dn(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return t.then(e=>{e instanceof IDBCursor&&Hh.set(e,n)}).catch(()=>{}),ja.set(t,n),t}function u0(n){if(ua.has(n))return;const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{e(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});ua.set(n,t)}let ca={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return ua.get(n);if(t==="objectStoreNames")return n.objectStoreNames||Gh.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return dn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function c0(n){ca=n(ca)}function l0(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const r=n.call(Gs(this),t,...e);return Gh.set(r,t.sort?t.sort():[t]),dn(r)}:s0().includes(n)?function(...t){return n.apply(Gs(this),t),dn(Hh.get(this))}:function(...t){return dn(n.apply(Gs(this),t))}}function h0(n){return typeof n=="function"?l0(n):(n instanceof IDBTransaction&&u0(n),i0(n,o0())?new Proxy(n,ca):n)}function dn(n){if(n instanceof IDBRequest)return a0(n);if(Hs.has(n))return Hs.get(n);const t=h0(n);return t!==n&&(Hs.set(n,t),ja.set(t,n)),t}const Gs=n=>ja.get(n);function d0(n,t,{blocked:e,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(n,t),a=dn(s);return r&&s.addEventListener("upgradeneeded",u=>{r(dn(s.result),u.oldVersion,u.newVersion,dn(s.transaction),u)}),e&&s.addEventListener("blocked",u=>e(u.oldVersion,u.newVersion,u)),a.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const f0=["get","getKey","getAll","getAllKeys","count"],p0=["put","add","delete","clear"],Ws=new Map;function Kc(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Ws.get(t))return Ws.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,i=p0.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!(i||f0.includes(e)))return;const o=async function(s,...a){const u=this.transaction(s,i?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),i&&u.done]))[0]};return Ws.set(t,o),o}c0(n=>({...n,get:(t,e,r)=>Kc(t,e)||n.get(t,e,r),has:(t,e)=>!!Kc(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(m0(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(e=>e).join(" ")}}function m0(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const la="@firebase/app",Yc="0.10.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ze=new Ua("@firebase/app"),_0="@firebase/app-compat",y0="@firebase/analytics-compat",w0="@firebase/analytics",v0="@firebase/app-check-compat",E0="@firebase/app-check",I0="@firebase/auth",A0="@firebase/auth-compat",T0="@firebase/database",C0="@firebase/database-compat",S0="@firebase/functions",b0="@firebase/functions-compat",R0="@firebase/installations",N0="@firebase/installations-compat",O0="@firebase/messaging",P0="@firebase/messaging-compat",D0="@firebase/performance",x0="@firebase/performance-compat",M0="@firebase/remote-config",k0="@firebase/remote-config-compat",L0="@firebase/storage",V0="@firebase/storage-compat",B0="@firebase/firestore",F0="@firebase/vertexai-preview",U0="@firebase/firestore-compat",j0="firebase",H0="10.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="[DEFAULT]",G0={[la]:"fire-core",[_0]:"fire-core-compat",[w0]:"fire-analytics",[y0]:"fire-analytics-compat",[E0]:"fire-app-check",[v0]:"fire-app-check-compat",[I0]:"fire-auth",[A0]:"fire-auth-compat",[T0]:"fire-rtdb",[C0]:"fire-rtdb-compat",[S0]:"fire-fn",[b0]:"fire-fn-compat",[R0]:"fire-iid",[N0]:"fire-iid-compat",[O0]:"fire-fcm",[P0]:"fire-fcm-compat",[D0]:"fire-perf",[x0]:"fire-perf-compat",[M0]:"fire-rc",[k0]:"fire-rc-compat",[L0]:"fire-gcs",[V0]:"fire-gcs-compat",[B0]:"fire-fst",[U0]:"fire-fst-compat",[F0]:"fire-vertex","fire-js":"fire-js",[j0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=new Map,W0=new Map,da=new Map;function Qc(n,t){try{n.container.addComponent(t)}catch(e){ze.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Hn(n){const t=n.name;if(da.has(t))return ze.debug(`There were multiple attempts to register component ${t}.`),!1;da.set(t,n);for(const e of bo.values())Qc(e,n);for(const e of W0.values())Qc(e,n);return!0}function Ko(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function Ue(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fn=new _i("app","Firebase",z0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw fn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=H0;function Wh(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const r=Object.assign({name:ha,automaticDataCollectionEnabled:!1},t),i=r.name;if(typeof i!="string"||!i)throw fn.create("bad-app-name",{appName:String(i)});if(e||(e=Fh()),!e)throw fn.create("no-options");const o=bo.get(i);if(o){if(So(e,o.options)&&So(r,o.config))return o;throw fn.create("duplicate-app",{appName:i})}const s=new Jp(i);for(const u of da.values())s.addComponent(u);const a=new X0(e,r,s);return bo.set(i,a),a}function Ha(n=ha){const t=bo.get(n);if(!t&&n===ha&&Fh())return Wh();if(!t)throw fn.create("no-app",{appName:n});return t}function Re(n,t,e){var r;let i=(r=G0[n])!==null&&r!==void 0?r:n;e&&(i+=`-${e}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${t}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ze.warn(a.join(" "));return}Hn(new yn(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="firebase-heartbeat-database",$0=1,ci="firebase-heartbeat-store";let zs=null;function zh(){return zs||(zs=d0(q0,$0,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(ci)}catch(e){console.warn(e)}}}}).catch(n=>{throw fn.create("idb-open",{originalErrorMessage:n.message})})),zs}async function K0(n){try{const e=(await zh()).transaction(ci),r=await e.objectStore(ci).get(Xh(n));return await e.done,r}catch(t){if(t instanceof Le)ze.warn(t.message);else{const e=fn.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ze.warn(e.message)}}}async function Zc(n,t){try{const r=(await zh()).transaction(ci,"readwrite");await r.objectStore(ci).put(t,Xh(n)),await r.done}catch(e){if(e instanceof Le)ze.warn(e.message);else{const r=fn.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});ze.warn(r.message)}}}function Xh(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=1024,Q0=30*24*60*60*1e3;class Z0{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new t2(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,e;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Jc();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const a=new Date(s.date).valueOf();return Date.now()-a<=Q0}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ze.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jc(),{heartbeatsToSend:r,unsentEntries:i}=J0(this._heartbeatsCache.heartbeats),o=Co(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return ze.warn(e),""}}}function Jc(){return new Date().toISOString().substring(0,10)}function J0(n,t=Y0){const e=[];let r=n.slice();for(const i of n){const o=e.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),tl(e)>t){o.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),tl(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}class t2{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jp()?Hp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await K0(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zc(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zc(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function tl(n){return Co(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(n){Hn(new yn("platform-logger",t=>new g0(t),"PRIVATE")),Hn(new yn("heartbeat",t=>new Z0(t),"PRIVATE")),Re(la,Yc,n),Re(la,Yc,"esm2017"),Re("fire-js","")}e2("");var n2="firebase",r2="10.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Re(n2,r2,"app");function Ga(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e}function qh(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const i2=qh,$h=new _i("auth","Firebase",qh());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new Ua("@firebase/auth");function o2(n,...t){Ro.logLevel<=rt.WARN&&Ro.warn(`Auth (${qn}): ${n}`,...t)}function ho(n,...t){Ro.logLevel<=rt.ERROR&&Ro.error(`Auth (${qn}): ${n}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(n,...t){throw za(n,...t)}function Te(n,...t){return za(n,...t)}function Wa(n,t,e){const r=Object.assign(Object.assign({},i2()),{[t]:e});return new _i("auth","Firebase",r).create(t,{appName:n.name})}function Bn(n){return Wa(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function s2(n,t,e){const r=e;if(!(t instanceof r))throw r.name!==t.constructor.name&&xe(n,"argument-error"),Wa(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function za(n,...t){if(typeof n!="string"){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return $h.create(n,...t)}function Q(n,t,...e){if(!n)throw za(t,...e)}function je(n){const t="INTERNAL ASSERTION FAILED: "+n;throw ho(t),new Error(t)}function Xe(n,t){n||je(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function a2(){return el()==="http:"||el()==="https:"}function el(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(a2()||Vp()||"connection"in navigator)?navigator.onLine:!0}function c2(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(t,e){this.shortDelay=t,this.longDelay=e,Xe(e>t,"Short delay should be less than long delay!"),this.isMobile=Mp()||Bp()}get(){return u2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(n,t){Xe(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;je("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;je("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;je("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=new wi(3e4,6e4);function qa(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}async function vr(n,t,e,r,i={}){return Yh(n,i,async()=>{let o={},s={};r&&(t==="GET"?s=r:o={body:JSON.stringify(r)});const a=yi(Object.assign({key:n.config.apiKey},s)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:t,headers:u},o);return Lp()||(c.referrerPolicy="no-referrer"),Kh.fetch()(Qh(n,n.config.apiHost,e,a),c)})}async function Yh(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},l2),t);try{const i=new f2(n),o=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Yi(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[u,c]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yi(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw Yi(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw Yi(n,"user-disabled",s);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Wa(n,h,c);xe(n,h)}}catch(i){if(i instanceof Le)throw i;xe(n,"network-request-failed",{message:String(i)})}}async function d2(n,t,e,r,i={}){const o=await vr(n,t,e,r,i);return"mfaPendingCredential"in o&&xe(n,"multi-factor-auth-required",{_serverResponse:o}),o}function Qh(n,t,e,r){const i=`${t}${e}?${r}`;return n.config.emulator?Xa(n.config,i):`${n.config.apiScheme}://${i}`}class f2{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(Te(this.auth,"network-request-failed")),h2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yi(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const i=Te(n,t,r);return i.customData._tokenResponse=e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p2(n,t){return vr(n,"POST","/v1/accounts:delete",t)}async function Zh(n,t){return vr(n,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function g2(n,t=!1){const e=kt(n),r=await e.getIdToken(t),i=$a(r);Q(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:ti(Xs(i.auth_time)),issuedAtTime:ti(Xs(i.iat)),expirationTime:ti(Xs(i.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Xs(n){return Number(n)*1e3}function $a(n){const[t,e,r]=n.split(".");if(t===void 0||e===void 0||r===void 0)return ho("JWT malformed, contained fewer than 3 sections"),null;try{const i=Lh(e);return i?JSON.parse(i):(ho("Failed to decode base64 JWT payload"),null)}catch(i){return ho("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function nl(n){const t=$a(n);return Q(t,"internal-error"),Q(typeof t.exp<"u","internal-error"),Q(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function li(n,t,e=!1){if(e)return t;try{return await t}catch(r){throw r instanceof Le&&m2(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function m2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((e=this.user.stsTokenManager.expirationTime)!==null&&e!==void 0?e:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=ti(this.lastLoginAt),this.creationTime=ti(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(n){var t;const e=n.auth,r=await n.getIdToken(),i=await li(n,Zh(e,{idToken:r}));Q(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const s=!((t=o.providerUserInfo)===null||t===void 0)&&t.length?Jh(o.providerUserInfo):[],a=w2(n.providerData,s),u=n.isAnonymous,c=!(n.email&&o.passwordHash)&&!(a!=null&&a.length),h=u?c:!1,d={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new pa(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function y2(n){const t=kt(n);await No(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function w2(n,t){return[...n.filter(r=>!t.some(i=>i.providerId===r.providerId)),...t]}function Jh(n){return n.map(t=>{var{providerId:e}=t,r=Ga(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2(n,t){const e=await Yh(n,{},async()=>{const r=yi({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=Qh(n,i,"/v1/token",`key=${o}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Kh.fetch()(s,{method:"POST",headers:a,body:r})});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function E2(n,t){return vr(n,"POST","/v2/accounts:revokeToken",qa(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Q(t.idToken,"internal-error"),Q(typeof t.idToken<"u","internal-error"),Q(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):nl(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Q(t.length!==0,"internal-error");const e=nl(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(Q(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:r,refreshToken:i,expiresIn:o}=await v2(t,e);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(t,e){const{refreshToken:r,accessToken:i,expirationTime:o}=e,s=new ar;return r&&(Q(typeof r=="string","internal-error",{appName:t}),s.refreshToken=r),i&&(Q(typeof i=="string","internal-error",{appName:t}),s.accessToken=i),o&&(Q(typeof o=="number","internal-error",{appName:t}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new ar,this.toJSON())}_performRefresh(){return je("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n,t){Q(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class He{constructor(t){var{uid:e,auth:r,stsTokenManager:i}=t,o=Ga(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new pa(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(t){const e=await li(this,this.stsTokenManager.getToken(this.auth,t));return Q(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return g2(this,t)}reload(){return y2(this)}_assign(t){this!==t&&(Q(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new He(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let r=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),e&&await No(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ue(this.auth.app))return Promise.reject(Bn(this.auth));const t=await this.getIdToken();return await li(this,p2(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,i,o,s,a,u,c,h;const d=(r=e.displayName)!==null&&r!==void 0?r:void 0,f=(i=e.email)!==null&&i!==void 0?i:void 0,g=(o=e.phoneNumber)!==null&&o!==void 0?o:void 0,_=(s=e.photoURL)!==null&&s!==void 0?s:void 0,v=(a=e.tenantId)!==null&&a!==void 0?a:void 0,I=(u=e._redirectEventId)!==null&&u!==void 0?u:void 0,T=(c=e.createdAt)!==null&&c!==void 0?c:void 0,N=(h=e.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:k,emailVerified:P,isAnonymous:B,providerData:F,stsTokenManager:S}=e;Q(k&&S,t,"internal-error");const A=ar.fromJSON(this.name,S);Q(typeof k=="string",t,"internal-error"),nn(d,t.name),nn(f,t.name),Q(typeof P=="boolean",t,"internal-error"),Q(typeof B=="boolean",t,"internal-error"),nn(g,t.name),nn(_,t.name),nn(v,t.name),nn(I,t.name),nn(T,t.name),nn(N,t.name);const C=new He({uid:k,auth:t,email:f,emailVerified:P,displayName:d,isAnonymous:B,photoURL:_,phoneNumber:g,tenantId:v,stsTokenManager:A,createdAt:T,lastLoginAt:N});return F&&Array.isArray(F)&&(C.providerData=F.map(R=>Object.assign({},R))),I&&(C._redirectEventId=I),C}static async _fromIdTokenResponse(t,e,r=!1){const i=new ar;i.updateFromServerResponse(e);const o=new He({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:r});return await No(o),o}static async _fromGetAccountInfoResponse(t,e,r){const i=e.users[0];Q(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Jh(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),a=new ar;a.updateFromIdToken(r);const u=new He({uid:i.localId,auth:t,stsTokenManager:a,isAnonymous:s}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new pa(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(u,c),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl=new Map;function Ge(n){Xe(n instanceof Function,"Expected a class definition");let t=rl.get(n);return t?(Xe(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,rl.set(n,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}td.type="NONE";const il=td;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fo(n,t,e){return`firebase:${n}:${t}:${e}`}class ur{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=fo(this.userKey,i.apiKey,o),this.fullPersistenceKey=fo("persistence",i.apiKey,o),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?He._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,r="authUser"){if(!e.length)return new ur(Ge(il),t,r);const i=(await Promise.all(e.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let o=i[0]||Ge(il);const s=fo(r,t.config.apiKey,t.name);let a=null;for(const c of e)try{const h=await c._get(s);if(h){const d=He._fromJSON(t,h);c!==o&&(a=d),o=c;break}}catch{}const u=i.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new ur(o,t,r):(o=u[0],a&&await o._set(s,a.toJSON()),await Promise.all(e.map(async c=>{if(c!==o)try{await c._remove(s)}catch{}})),new ur(o,t,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(id(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ed(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(sd(t))return"Blackberry";if(ad(t))return"Webos";if(nd(t))return"Safari";if((t.includes("chrome/")||rd(t))&&!t.includes("edge/"))return"Chrome";if(od(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(e);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ed(n=ee()){return/firefox\//i.test(n)}function nd(n=ee()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function rd(n=ee()){return/crios\//i.test(n)}function id(n=ee()){return/iemobile/i.test(n)}function od(n=ee()){return/android/i.test(n)}function sd(n=ee()){return/blackberry/i.test(n)}function ad(n=ee()){return/webos/i.test(n)}function Ka(n=ee()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function I2(n=ee()){var t;return Ka(n)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function A2(){return Fp()&&document.documentMode===10}function ud(n=ee()){return Ka(n)||od(n)||ad(n)||sd(n)||/windows phone/i.test(n)||id(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(n,t=[]){let e;switch(n){case"Browser":e=ol(ee());break;case"Worker":e=`${ol(ee())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${qn}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=o=>new Promise((s,a)=>{try{const u=t(o);s(u)}catch(u){a(u)}});r.onAbort=e,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const r of this.queue)await r(t),r.onAbort&&e.push(r.onAbort)}catch(r){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C2(n,t={}){return vr(n,"GET","/v2/passwordPolicy",qa(n,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2=6;class b2{constructor(t){var e,r,i,o;const s=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(e=s.minPasswordLength)!==null&&e!==void 0?e:S2,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=t.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=t.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,r,i,o,s,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,u),this.validatePasswordCharacterOptions(t,u),u.isValid&&(u.isValid=(e=u.meetsMinPasswordLength)!==null&&e!==void 0?e:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsUppercaseLetter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(s=u.containsNumericCharacter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(t,e){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=t.length>=r),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let r;for(let i=0;i<t.length;i++)r=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,e,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(t,e,r,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sl(this),this.idTokenSubscription=new sl(this),this.beforeStateQueue=new T2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$h,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Ge(e)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ur.create(this,t),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Zh(this,{idToken:t}),r=await He._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(Ue(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(e=this.redirectUser)===null||e===void 0?void 0:e._redirectEventId,a=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(t);(!s||s===a)&&(u!=null&&u.user)&&(i=u.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Q(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await No(t)}catch(e){if((e==null?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=c2()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Ue(this.app))return Promise.reject(Bn(this));const e=t?kt(t):null;return e&&Q(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Q(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Ue(this.app)?Promise.reject(Bn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Ue(this.app)?Promise.reject(Bn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ge(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await C2(this),e=new b2(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new _i("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged(()=>{r(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(r.tenantId=this.tenantId),await E2(this,r)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,e){const r=await this.getOrInitRedirectPersistenceManager(e);return t===null?r.removeCurrentUser():r.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Ge(t)||this._popupRedirectResolver;Q(e,this,"argument-error"),this.redirectPersistenceManager=await ur.create(this,[Ge(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,r;return this._isInitialized&&await this.queue(async()=>{}),((e=this._currentUser)===null||e===void 0?void 0:e._redirectEventId)===t?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(e=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&e!==void 0?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,i){if(this._deleted)return()=>{};const o=typeof e=="function"?e:e.next.bind(e);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Q(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof e=="function"){const u=t.addObserver(e,r,i);return()=>{s=!0,u()}}else{const u=t.addObserver(e);return()=>{s=!0,u()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=cd(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return e!=null&&e.error&&o2(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Yo(n){return kt(n)}class sl{constructor(t){this.auth=t,this.observer=null,this.addObserver=qp(e=>this.observer=e)}get next(){return Q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ya={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function N2(n){Ya=n}function O2(n){return Ya.loadJS(n)}function P2(){return Ya.gapiScript}function D2(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(n,t){const e=Ko(n,"auth");if(e.isInitialized()){const i=e.getImmediate(),o=e.getOptions();if(So(o,t??{}))return i;xe(i,"already-initialized")}return e.initialize({options:t})}function M2(n,t){const e=(t==null?void 0:t.persistence)||[],r=(Array.isArray(e)?e:[e]).map(Ge);t!=null&&t.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t==null?void 0:t.popupRedirectResolver)}function k2(n,t,e){const r=Yo(n);Q(r._canInitEmulator,r,"emulator-config-failed"),Q(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!1,o=ld(t),{host:s,port:a}=L2(t),u=a===null?"":`:${a}`;r.config.emulator={url:`${o}//${s}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),V2()}function ld(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function L2(n){const t=ld(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:al(r.substr(o.length+1))}}else{const[o,s]=r.split(":");return{host:o,port:al(s)}}}function al(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function V2(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return je("not implemented")}_getIdTokenResponse(t){return je("not implemented")}_linkToIdToken(t,e){return je("not implemented")}_getReauthenticationResolver(t){return je("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cr(n,t){return d2(n,"POST","/v1/accounts:signInWithIdp",qa(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="http://localhost";class qe extends hd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new qe(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):xe("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:r,signInMethod:i}=e,o=Ga(e,["providerId","signInMethod"]);if(!r||!i)return null;const s=new qe(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(t){const e=this.buildRequest();return cr(t,e)}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,cr(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,cr(t,e)}buildRequest(){const t={requestUri:B2,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=yi(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends Qa{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class ei extends Er{static credentialFromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;return Q("providerId"in e&&"signInMethod"in e,"argument-error"),qe._fromParams(e)}credential(t){return this._credential(Object.assign(Object.assign({},t),{nonce:t.rawNonce}))}_credential(t){return Q(t.idToken||t.accessToken,"argument-error"),qe._fromParams(Object.assign(Object.assign({},t),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(t){return ei.oauthCredentialFromTaggedObject(t)}static credentialFromError(t){return ei.oauthCredentialFromTaggedObject(t.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:o,nonce:s,providerId:a}=t;if(!r&&!i&&!e&&!o||!a)return null;try{return new ei(a)._credential({idToken:e,accessToken:r,nonce:s,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an extends Er{constructor(){super("facebook.com")}static credential(t){return qe._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return an.credentialFromTaggedObject(t)}static credentialFromError(t){return an.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return an.credential(t.oauthAccessToken)}catch{return null}}}an.FACEBOOK_SIGN_IN_METHOD="facebook.com";an.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce extends Er{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return qe._fromParams({providerId:Ce.PROVIDER_ID,signInMethod:Ce.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Ce.credentialFromTaggedObject(t)}static credentialFromError(t){return Ce.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:r}=t;if(!e&&!r)return null;try{return Ce.credential(e,r)}catch{return null}}}Ce.GOOGLE_SIGN_IN_METHOD="google.com";Ce.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un extends Er{constructor(){super("github.com")}static credential(t){return qe._fromParams({providerId:un.PROVIDER_ID,signInMethod:un.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return un.credentialFromTaggedObject(t)}static credentialFromError(t){return un.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return un.credential(t.oauthAccessToken)}catch{return null}}}un.GITHUB_SIGN_IN_METHOD="github.com";un.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe extends Er{constructor(){super("twitter.com")}static credential(t,e){return qe._fromParams({providerId:Fe.PROVIDER_ID,signInMethod:Fe.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Fe.credentialFromTaggedObject(t)}static credentialFromError(t){return Fe.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:r}=t;if(!e||!r)return null;try{return Fe.credential(e,r)}catch{return null}}}Fe.TWITTER_SIGN_IN_METHOD="twitter.com";Fe.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,r,i=!1){const o=await He._fromIdTokenResponse(t,r,i),s=ul(r);return new hr({user:o,providerId:s,_tokenResponse:r,operationType:e})}static async _forOperation(t,e,r){await t._updateTokensIfNecessary(r,!0);const i=ul(r);return new hr({user:t,providerId:i,_tokenResponse:r,operationType:e})}}function ul(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo extends Le{constructor(t,e,r,i){var o;super(e.code,e.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Oo.prototype),this.customData={appName:t.name,tenantId:(o=t.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,i){return new Oo(t,e,r,i)}}function dd(n,t,e,r){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Oo._fromErrorAndOperation(n,o,t,r):o})}async function F2(n,t,e=!1){const r=await li(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return hr._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U2(n,t,e=!1){const{auth:r}=n;if(Ue(r.app))return Promise.reject(Bn(r));const i="reauthenticate";try{const o=await li(n,dd(r,i,t,n),e);Q(o.idToken,r,"internal-error");const s=$a(o.idToken);Q(s,r,"internal-error");const{sub:a}=s;return Q(n.uid===a,r,"user-mismatch"),hr._forOperation(n,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&xe(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j2(n,t,e=!1){if(Ue(n.app))return Promise.reject(Bn(n));const r="signIn",i=await dd(n,r,t),o=await hr._fromIdTokenResponse(n,r,i);return e||await n._updateCurrentUser(o.user),o}function H2(n,t,e,r){return kt(n).onIdTokenChanged(t,e,r)}function G2(n,t,e){return kt(n).beforeAuthStateChanged(t,e)}function W2(n,t,e,r){return kt(n).onAuthStateChanged(t,e,r)}const Po="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Po,"1"),this.storage.removeItem(Po),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2=1e3,X2=10;class pd extends fd{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ud(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const r=this.storage.getItem(e),i=this.localCache[e];r!==i&&t(e,i,r)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((s,a,u)=>{this.notifyListeners(s,u)});return}const r=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(r);!e&&this.localCache[r]===s||this.notifyListeners(r,s)},o=this.storage.getItem(r);A2()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,X2):i()}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const i of Array.from(r))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:r}),!0)})},z2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}pd.type="LOCAL";const q2=pd;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd extends fd{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}gd.type="SESSION";const md=gd;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $2(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const r=new Qo(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:r,eventType:i,data:o}=e.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(s).map(async c=>c(e.origin,o)),u=await $2(a);e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qo.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(Math.random()*10);return n+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,u)=>{const c=Za("",20);i.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(f.data.response);break;default:clearTimeout(h),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(){return window}function Y2(n){Ne().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(){return typeof Ne().WorkerGlobalScope<"u"&&typeof Ne().importScripts=="function"}async function Q2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Z2(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function J2(){return _d()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yd="firebaseLocalStorageDb",tg=1,Do="firebaseLocalStorage",wd="fbase_key";class vi{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Zo(n,t){return n.transaction([Do],t?"readwrite":"readonly").objectStore(Do)}function eg(){const n=indexedDB.deleteDatabase(yd);return new vi(n).toPromise()}function ga(){const n=indexedDB.open(yd,tg);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Do,{keyPath:wd})}catch(i){e(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Do)?t(r):(r.close(),await eg(),t(await ga()))})})}async function cl(n,t,e){const r=Zo(n,!0).put({[wd]:t,value:e});return new vi(r).toPromise()}async function ng(n,t){const e=Zo(n,!1).get(t),r=await new vi(e).toPromise();return r===void 0?null:r.value}function ll(n,t){const e=Zo(n,!0).delete(t);return new vi(e).toPromise()}const rg=800,ig=3;class vd{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ga(),this.db)}async _withRetries(t){let e=0;for(;;)try{const r=await this._openDb();return await t(r)}catch(r){if(e++>ig)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _d()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qo._getInstance(J2()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){var t,e;if(this.activeServiceWorker=await Q2(),!this.activeServiceWorker)return;this.sender=new K2(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((e=r[0])===null||e===void 0)&&e.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||Z2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await ga();return await cl(t,Po,"1"),await ll(t,Po),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(r=>cl(r,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(r=>ng(r,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>ll(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const o=Zo(i,!1).getAll();return new vi(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],r=new Set;if(t.length!==0)for(const{fbase_key:i,value:o}of t)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const i of Array.from(r))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rg)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vd.type="LOCAL";const og=vd;new wi(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(n,t){return t?Ge(t):(Q(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja extends hd{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return cr(t,this._buildIdpRequest())}_linkToIdToken(t,e){return cr(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return cr(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function sg(n){return j2(n.auth,new Ja(n),n.bypassAuthState)}function ag(n){const{auth:t,user:e}=n;return Q(e,t,"internal-error"),U2(e,new Ja(n),n.bypassAuthState)}async function ug(n){const{auth:t,user:e}=n;return Q(e,t,"internal-error"),F2(e,new Ja(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(t,e,r,i,o=!1){this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=t;if(s){this.reject(s);return}const u={auth:this.auth,requestUri:e,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return sg;case"linkViaPopup":case"linkViaRedirect":return ug;case"reauthViaPopup":case"reauthViaRedirect":return ag;default:xe(this.auth,"internal-error")}}resolve(t){Xe(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Xe(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=new wi(2e3,1e4);async function tu(n,t,e){if(Ue(n.app))return Promise.reject(Te(n,"operation-not-supported-in-this-environment"));const r=Yo(n);s2(n,t,Qa);const i=Ed(r,e);return new kn(r,"signInViaPopup",t,i).executeNotNull()}class kn extends Id{constructor(t,e,r,i,o){super(t,e,i,o),this.provider=r,this.authWindow=null,this.pollId=null,kn.currentPopupAction&&kn.currentPopupAction.cancel(),kn.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Q(t,this.auth,"internal-error"),t}async onExecution(){Xe(this.filter.length===1,"Popup operations only handle one event");const t=Za();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Te(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Te(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,kn.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,r;if(!((r=(e=this.authWindow)===null||e===void 0?void 0:e.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Te(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,cg.get())};t()}}kn.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lg="pendingRedirect",po=new Map;class hg extends Id{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}async execute(){let t=po.get(this.auth._key());if(!t){try{const r=await dg(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(r)}catch(e){t=()=>Promise.reject(e)}po.set(this.auth._key(),t)}return this.bypassAuthState||po.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dg(n,t){const e=gg(t),r=pg(n);if(!await r._isAvailable())return!1;const i=await r._get(e)==="true";return await r._remove(e),i}function fg(n,t){po.set(n._key(),t)}function pg(n){return Ge(n._redirectPersistence)}function gg(n){return fo(lg,n.config.apiKey,n.name)}async function mg(n,t,e=!1){if(Ue(n.app))return Promise.reject(Bn(n));const r=Yo(n),i=Ed(r,t),s=await new hg(r,i,e).execute();return s&&!e&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g=10*60*1e3;class yg{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!wg(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!Ad(t)){const i=((r=t.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";e.onError(Te(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=_g&&this.cachedEventUids.clear(),this.cachedEventUids.has(hl(t))}saveEventToCache(t){this.cachedEventUids.add(hl(t)),this.lastProcessedEventTime=Date.now()}}function hl(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function Ad({type:n,error:t}){return n==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function wg(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ad(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vg(n,t={}){return vr(n,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eg=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ig=/^https?/;async function Ag(n){if(n.config.emulator)return;const{authorizedDomains:t}=await vg(n);for(const e of t)try{if(Tg(e))return}catch{}xe(n,"unauthorized-domain")}function Tg(n){const t=fa(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const s=new URL(n);return s.hostname===""&&r===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&s.hostname===r}if(!Ig.test(e))return!1;if(Eg.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg=new wi(3e4,6e4);function dl(){const n=Ne().___jsl;if(n!=null&&n.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function Sg(n){return new Promise((t,e)=>{var r,i,o;function s(){dl(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{dl(),e(Te(n,"network-request-failed"))},timeout:Cg.get()})}if(!((i=(r=Ne().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((o=Ne().gapi)===null||o===void 0)&&o.load)s();else{const a=D2("iframefcb");return Ne()[a]=()=>{gapi.load?s():e(Te(n,"network-request-failed"))},O2(`${P2()}?onload=${a}`).catch(u=>e(u))}}).catch(t=>{throw go=null,t})}let go=null;function bg(n){return go=go||Sg(n),go}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg=new wi(5e3,15e3),Ng="__/auth/iframe",Og="emulator/auth/iframe",Pg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Dg=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xg(n){const t=n.config;Q(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?Xa(t,Og):`https://${n.config.authDomain}/${Ng}`,r={apiKey:t.apiKey,appName:n.name,v:qn},i=Dg.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${e}?${yi(r).slice(1)}`}async function Mg(n){const t=await bg(n),e=Ne().gapi;return Q(e,n,"internal-error"),t.open({where:document.body,url:xg(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Pg,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const s=Te(n,"network-request-failed"),a=Ne().setTimeout(()=>{o(s)},Rg.get());function u(){Ne().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Lg=500,Vg=600,Bg="_blank",Fg="http://localhost";class fl{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Ug(n,t,e,r=Lg,i=Vg){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const u=Object.assign(Object.assign({},kg),{width:r.toString(),height:i.toString(),top:o,left:s}),c=ee().toLowerCase();e&&(a=rd(c)?Bg:e),ed(c)&&(t=t||Fg,u.scrollbars="yes");const h=Object.entries(u).reduce((f,[g,_])=>`${f}${g}=${_},`,"");if(I2(c)&&a!=="_self")return jg(t||"",a),new fl(null);const d=window.open(t||"",a,h);Q(d,n,"popup-blocked");try{d.focus()}catch{}return new fl(d)}function jg(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="__/auth/handler",Gg="emulator/auth/handler",Wg=encodeURIComponent("fac");async function pl(n,t,e,r,i,o){Q(n.config.authDomain,n,"auth-domain-config-required"),Q(n.config.apiKey,n,"invalid-api-key");const s={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:qn,eventId:i};if(t instanceof Qa){t.setDefaultLanguage(n.languageCode),s.providerId=t.providerId||"",Xp(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,d]of Object.entries({}))s[h]=d}if(t instanceof Er){const h=t.getScopes().filter(d=>d!=="");h.length>0&&(s.scopes=h.join(","))}n.tenantId&&(s.tid=n.tenantId);const a=s;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const u=await n._getAppCheckToken(),c=u?`#${Wg}=${encodeURIComponent(u)}`:"";return`${zg(n)}?${yi(a).slice(1)}${c}`}function zg({config:n}){return n.emulator?Xa(n,Gg):`https://${n.authDomain}/${Hg}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs="webStorageSupport";class Xg{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=md,this._completeRedirectFn=mg,this._overrideRedirectResult=fg}async _openPopup(t,e,r,i){var o;Xe((o=this.eventManagers[t._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await pl(t,e,r,fa(),i);return Ug(t,s,Za())}async _openRedirect(t,e,r,i){await this._originValidation(t);const o=await pl(t,e,r,fa(),i);return Y2(o),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:o}=this.eventManagers[e];return i?Promise.resolve(i):(Xe(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}async initAndGetManager(t){const e=await Mg(t),r=new yg(t);return e.register("authEvent",i=>(Q(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=e,r}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(qs,{type:qs},i=>{var o;const s=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[qs];s!==void 0&&e(!!s),xe(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=Ag(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return ud()||nd()||Ka()}}const qg=Xg;var gl="@firebase/auth",ml="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{t((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Yg(n){Hn(new yn("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;Q(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cd(n)},c=new R2(r,i,o,u);return M2(c,e),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Hn(new yn("auth-internal",t=>{const e=Yo(t.getProvider("auth").getImmediate());return(r=>new $g(r))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Re(gl,ml,Kg(n)),Re(gl,ml,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=5*60,Zg=Uh("authIdTokenMaxAge")||Qg;let _l=null;const Jg=n=>async t=>{const e=t&&await t.getIdTokenResult(),r=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(r&&r>Zg)return;const i=e==null?void 0:e.token;_l!==i&&(_l=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function tm(n=Ha()){const t=Ko(n,"auth");if(t.isInitialized())return t.getImmediate();const e=x2(n,{popupRedirectResolver:qg,persistence:[og,q2,md]}),r=Uh("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const s=Jg(o.toString());G2(e,s,()=>s(e.currentUser)),H2(e,a=>s(a))}}const i=Vh("auth");return i&&k2(e,`http://${i}`),e}function em(){var n,t;return(t=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&t!==void 0?t:document}N2({loadJS(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=i=>{const o=Te("internal-error");o.customData=i,e(o)},r.type="text/javascript",r.charset="UTF-8",em().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Yg("Browser");var yl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fn,Td;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(S,A){function C(){}C.prototype=A.prototype,S.D=A.prototype,S.prototype=new C,S.prototype.constructor=S,S.C=function(R,O,D){for(var b=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)b[Nt-2]=arguments[Nt];return A.prototype[O].apply(R,b)}}function e(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(r,e),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,A,C){C||(C=0);var R=Array(16);if(typeof A=="string")for(var O=0;16>O;++O)R[O]=A.charCodeAt(C++)|A.charCodeAt(C++)<<8|A.charCodeAt(C++)<<16|A.charCodeAt(C++)<<24;else for(O=0;16>O;++O)R[O]=A[C++]|A[C++]<<8|A[C++]<<16|A[C++]<<24;A=S.g[0],C=S.g[1],O=S.g[2];var D=S.g[3],b=A+(D^C&(O^D))+R[0]+3614090360&4294967295;A=C+(b<<7&4294967295|b>>>25),b=D+(O^A&(C^O))+R[1]+3905402710&4294967295,D=A+(b<<12&4294967295|b>>>20),b=O+(C^D&(A^C))+R[2]+606105819&4294967295,O=D+(b<<17&4294967295|b>>>15),b=C+(A^O&(D^A))+R[3]+3250441966&4294967295,C=O+(b<<22&4294967295|b>>>10),b=A+(D^C&(O^D))+R[4]+4118548399&4294967295,A=C+(b<<7&4294967295|b>>>25),b=D+(O^A&(C^O))+R[5]+1200080426&4294967295,D=A+(b<<12&4294967295|b>>>20),b=O+(C^D&(A^C))+R[6]+2821735955&4294967295,O=D+(b<<17&4294967295|b>>>15),b=C+(A^O&(D^A))+R[7]+4249261313&4294967295,C=O+(b<<22&4294967295|b>>>10),b=A+(D^C&(O^D))+R[8]+1770035416&4294967295,A=C+(b<<7&4294967295|b>>>25),b=D+(O^A&(C^O))+R[9]+2336552879&4294967295,D=A+(b<<12&4294967295|b>>>20),b=O+(C^D&(A^C))+R[10]+4294925233&4294967295,O=D+(b<<17&4294967295|b>>>15),b=C+(A^O&(D^A))+R[11]+2304563134&4294967295,C=O+(b<<22&4294967295|b>>>10),b=A+(D^C&(O^D))+R[12]+1804603682&4294967295,A=C+(b<<7&4294967295|b>>>25),b=D+(O^A&(C^O))+R[13]+4254626195&4294967295,D=A+(b<<12&4294967295|b>>>20),b=O+(C^D&(A^C))+R[14]+2792965006&4294967295,O=D+(b<<17&4294967295|b>>>15),b=C+(A^O&(D^A))+R[15]+1236535329&4294967295,C=O+(b<<22&4294967295|b>>>10),b=A+(O^D&(C^O))+R[1]+4129170786&4294967295,A=C+(b<<5&4294967295|b>>>27),b=D+(C^O&(A^C))+R[6]+3225465664&4294967295,D=A+(b<<9&4294967295|b>>>23),b=O+(A^C&(D^A))+R[11]+643717713&4294967295,O=D+(b<<14&4294967295|b>>>18),b=C+(D^A&(O^D))+R[0]+3921069994&4294967295,C=O+(b<<20&4294967295|b>>>12),b=A+(O^D&(C^O))+R[5]+3593408605&4294967295,A=C+(b<<5&4294967295|b>>>27),b=D+(C^O&(A^C))+R[10]+38016083&4294967295,D=A+(b<<9&4294967295|b>>>23),b=O+(A^C&(D^A))+R[15]+3634488961&4294967295,O=D+(b<<14&4294967295|b>>>18),b=C+(D^A&(O^D))+R[4]+3889429448&4294967295,C=O+(b<<20&4294967295|b>>>12),b=A+(O^D&(C^O))+R[9]+568446438&4294967295,A=C+(b<<5&4294967295|b>>>27),b=D+(C^O&(A^C))+R[14]+3275163606&4294967295,D=A+(b<<9&4294967295|b>>>23),b=O+(A^C&(D^A))+R[3]+4107603335&4294967295,O=D+(b<<14&4294967295|b>>>18),b=C+(D^A&(O^D))+R[8]+1163531501&4294967295,C=O+(b<<20&4294967295|b>>>12),b=A+(O^D&(C^O))+R[13]+2850285829&4294967295,A=C+(b<<5&4294967295|b>>>27),b=D+(C^O&(A^C))+R[2]+4243563512&4294967295,D=A+(b<<9&4294967295|b>>>23),b=O+(A^C&(D^A))+R[7]+1735328473&4294967295,O=D+(b<<14&4294967295|b>>>18),b=C+(D^A&(O^D))+R[12]+2368359562&4294967295,C=O+(b<<20&4294967295|b>>>12),b=A+(C^O^D)+R[5]+4294588738&4294967295,A=C+(b<<4&4294967295|b>>>28),b=D+(A^C^O)+R[8]+2272392833&4294967295,D=A+(b<<11&4294967295|b>>>21),b=O+(D^A^C)+R[11]+1839030562&4294967295,O=D+(b<<16&4294967295|b>>>16),b=C+(O^D^A)+R[14]+4259657740&4294967295,C=O+(b<<23&4294967295|b>>>9),b=A+(C^O^D)+R[1]+2763975236&4294967295,A=C+(b<<4&4294967295|b>>>28),b=D+(A^C^O)+R[4]+1272893353&4294967295,D=A+(b<<11&4294967295|b>>>21),b=O+(D^A^C)+R[7]+4139469664&4294967295,O=D+(b<<16&4294967295|b>>>16),b=C+(O^D^A)+R[10]+3200236656&4294967295,C=O+(b<<23&4294967295|b>>>9),b=A+(C^O^D)+R[13]+681279174&4294967295,A=C+(b<<4&4294967295|b>>>28),b=D+(A^C^O)+R[0]+3936430074&4294967295,D=A+(b<<11&4294967295|b>>>21),b=O+(D^A^C)+R[3]+3572445317&4294967295,O=D+(b<<16&4294967295|b>>>16),b=C+(O^D^A)+R[6]+76029189&4294967295,C=O+(b<<23&4294967295|b>>>9),b=A+(C^O^D)+R[9]+3654602809&4294967295,A=C+(b<<4&4294967295|b>>>28),b=D+(A^C^O)+R[12]+3873151461&4294967295,D=A+(b<<11&4294967295|b>>>21),b=O+(D^A^C)+R[15]+530742520&4294967295,O=D+(b<<16&4294967295|b>>>16),b=C+(O^D^A)+R[2]+3299628645&4294967295,C=O+(b<<23&4294967295|b>>>9),b=A+(O^(C|~D))+R[0]+4096336452&4294967295,A=C+(b<<6&4294967295|b>>>26),b=D+(C^(A|~O))+R[7]+1126891415&4294967295,D=A+(b<<10&4294967295|b>>>22),b=O+(A^(D|~C))+R[14]+2878612391&4294967295,O=D+(b<<15&4294967295|b>>>17),b=C+(D^(O|~A))+R[5]+4237533241&4294967295,C=O+(b<<21&4294967295|b>>>11),b=A+(O^(C|~D))+R[12]+1700485571&4294967295,A=C+(b<<6&4294967295|b>>>26),b=D+(C^(A|~O))+R[3]+2399980690&4294967295,D=A+(b<<10&4294967295|b>>>22),b=O+(A^(D|~C))+R[10]+4293915773&4294967295,O=D+(b<<15&4294967295|b>>>17),b=C+(D^(O|~A))+R[1]+2240044497&4294967295,C=O+(b<<21&4294967295|b>>>11),b=A+(O^(C|~D))+R[8]+1873313359&4294967295,A=C+(b<<6&4294967295|b>>>26),b=D+(C^(A|~O))+R[15]+4264355552&4294967295,D=A+(b<<10&4294967295|b>>>22),b=O+(A^(D|~C))+R[6]+2734768916&4294967295,O=D+(b<<15&4294967295|b>>>17),b=C+(D^(O|~A))+R[13]+1309151649&4294967295,C=O+(b<<21&4294967295|b>>>11),b=A+(O^(C|~D))+R[4]+4149444226&4294967295,A=C+(b<<6&4294967295|b>>>26),b=D+(C^(A|~O))+R[11]+3174756917&4294967295,D=A+(b<<10&4294967295|b>>>22),b=O+(A^(D|~C))+R[2]+718787259&4294967295,O=D+(b<<15&4294967295|b>>>17),b=C+(D^(O|~A))+R[9]+3951481745&4294967295,S.g[0]=S.g[0]+A&4294967295,S.g[1]=S.g[1]+(O+(b<<21&4294967295|b>>>11))&4294967295,S.g[2]=S.g[2]+O&4294967295,S.g[3]=S.g[3]+D&4294967295}r.prototype.u=function(S,A){A===void 0&&(A=S.length);for(var C=A-this.blockSize,R=this.B,O=this.h,D=0;D<A;){if(O==0)for(;D<=C;)i(this,S,D),D+=this.blockSize;if(typeof S=="string"){for(;D<A;)if(R[O++]=S.charCodeAt(D++),O==this.blockSize){i(this,R),O=0;break}}else for(;D<A;)if(R[O++]=S[D++],O==this.blockSize){i(this,R),O=0;break}}this.h=O,this.o+=A},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var A=1;A<S.length-8;++A)S[A]=0;var C=8*this.o;for(A=S.length-8;A<S.length;++A)S[A]=C&255,C/=256;for(this.u(S),S=Array(16),A=C=0;4>A;++A)for(var R=0;32>R;R+=8)S[C++]=this.g[A]>>>R&255;return S};function o(S,A){var C=a;return Object.prototype.hasOwnProperty.call(C,S)?C[S]:C[S]=A(S)}function s(S,A){this.h=A;for(var C=[],R=!0,O=S.length-1;0<=O;O--){var D=S[O]|0;R&&D==A||(C[O]=D,R=!1)}this.g=C}var a={};function u(S){return-128<=S&&128>S?o(S,function(A){return new s([A|0],0>A?-1:0)}):new s([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return d;if(0>S)return I(c(-S));for(var A=[],C=1,R=0;S>=C;R++)A[R]=S/C|0,C*=4294967296;return new s(A,0)}function h(S,A){if(S.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(S.charAt(0)=="-")return I(h(S.substring(1),A));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=c(Math.pow(A,8)),R=d,O=0;O<S.length;O+=8){var D=Math.min(8,S.length-O),b=parseInt(S.substring(O,O+D),A);8>D?(D=c(Math.pow(A,D)),R=R.j(D).add(c(b))):(R=R.j(C),R=R.add(c(b)))}return R}var d=u(0),f=u(1),g=u(16777216);n=s.prototype,n.m=function(){if(v(this))return-I(this).m();for(var S=0,A=1,C=0;C<this.g.length;C++){var R=this.i(C);S+=(0<=R?R:4294967296+R)*A,A*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(_(this))return"0";if(v(this))return"-"+I(this).toString(S);for(var A=c(Math.pow(S,6)),C=this,R="";;){var O=P(C,A).g;C=T(C,O.j(A));var D=((0<C.g.length?C.g[0]:C.h)>>>0).toString(S);if(C=O,_(C))return D+R;for(;6>D.length;)D="0"+D;R=D+R}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function _(S){if(S.h!=0)return!1;for(var A=0;A<S.g.length;A++)if(S.g[A]!=0)return!1;return!0}function v(S){return S.h==-1}n.l=function(S){return S=T(this,S),v(S)?-1:_(S)?0:1};function I(S){for(var A=S.g.length,C=[],R=0;R<A;R++)C[R]=~S.g[R];return new s(C,~S.h).add(f)}n.abs=function(){return v(this)?I(this):this},n.add=function(S){for(var A=Math.max(this.g.length,S.g.length),C=[],R=0,O=0;O<=A;O++){var D=R+(this.i(O)&65535)+(S.i(O)&65535),b=(D>>>16)+(this.i(O)>>>16)+(S.i(O)>>>16);R=b>>>16,D&=65535,b&=65535,C[O]=b<<16|D}return new s(C,C[C.length-1]&-2147483648?-1:0)};function T(S,A){return S.add(I(A))}n.j=function(S){if(_(this)||_(S))return d;if(v(this))return v(S)?I(this).j(I(S)):I(I(this).j(S));if(v(S))return I(this.j(I(S)));if(0>this.l(g)&&0>S.l(g))return c(this.m()*S.m());for(var A=this.g.length+S.g.length,C=[],R=0;R<2*A;R++)C[R]=0;for(R=0;R<this.g.length;R++)for(var O=0;O<S.g.length;O++){var D=this.i(R)>>>16,b=this.i(R)&65535,Nt=S.i(O)>>>16,ue=S.i(O)&65535;C[2*R+2*O]+=b*ue,N(C,2*R+2*O),C[2*R+2*O+1]+=D*ue,N(C,2*R+2*O+1),C[2*R+2*O+1]+=b*Nt,N(C,2*R+2*O+1),C[2*R+2*O+2]+=D*Nt,N(C,2*R+2*O+2)}for(R=0;R<A;R++)C[R]=C[2*R+1]<<16|C[2*R];for(R=A;R<2*A;R++)C[R]=0;return new s(C,0)};function N(S,A){for(;(S[A]&65535)!=S[A];)S[A+1]+=S[A]>>>16,S[A]&=65535,A++}function k(S,A){this.g=S,this.h=A}function P(S,A){if(_(A))throw Error("division by zero");if(_(S))return new k(d,d);if(v(S))return A=P(I(S),A),new k(I(A.g),I(A.h));if(v(A))return A=P(S,I(A)),new k(I(A.g),A.h);if(30<S.g.length){if(v(S)||v(A))throw Error("slowDivide_ only works with positive integers.");for(var C=f,R=A;0>=R.l(S);)C=B(C),R=B(R);var O=F(C,1),D=F(R,1);for(R=F(R,2),C=F(C,2);!_(R);){var b=D.add(R);0>=b.l(S)&&(O=O.add(C),D=b),R=F(R,1),C=F(C,1)}return A=T(S,O.j(A)),new k(O,A)}for(O=d;0<=S.l(A);){for(C=Math.max(1,Math.floor(S.m()/A.m())),R=Math.ceil(Math.log(C)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),D=c(C),b=D.j(A);v(b)||0<b.l(S);)C-=R,D=c(C),b=D.j(A);_(D)&&(D=f),O=O.add(D),S=T(S,b)}return new k(O,S)}n.A=function(S){return P(this,S).h},n.and=function(S){for(var A=Math.max(this.g.length,S.g.length),C=[],R=0;R<A;R++)C[R]=this.i(R)&S.i(R);return new s(C,this.h&S.h)},n.or=function(S){for(var A=Math.max(this.g.length,S.g.length),C=[],R=0;R<A;R++)C[R]=this.i(R)|S.i(R);return new s(C,this.h|S.h)},n.xor=function(S){for(var A=Math.max(this.g.length,S.g.length),C=[],R=0;R<A;R++)C[R]=this.i(R)^S.i(R);return new s(C,this.h^S.h)};function B(S){for(var A=S.g.length+1,C=[],R=0;R<A;R++)C[R]=S.i(R)<<1|S.i(R-1)>>>31;return new s(C,S.h)}function F(S,A){var C=A>>5;A%=32;for(var R=S.g.length-C,O=[],D=0;D<R;D++)O[D]=0<A?S.i(D+C)>>>A|S.i(D+C+1)<<32-A:S.i(D+C);return new s(O,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Td=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=h,Fn=s}).apply(typeof yl<"u"?yl:typeof self<"u"?self:typeof window<"u"?window:{});var Qi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cd,Sd,$r,bd,mo,ma,Rd,Nd,Od;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,p,m){return l==Array.prototype||l==Object.prototype||(l[p]=m.value),l};function e(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qi=="object"&&Qi];for(var p=0;p<l.length;++p){var m=l[p];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=e(this);function i(l,p){if(p)t:{var m=r;l=l.split(".");for(var w=0;w<l.length-1;w++){var x=l[w];if(!(x in m))break t;m=m[x]}l=l[l.length-1],w=m[l],p=p(w),p!=w&&p!=null&&t(m,l,{configurable:!0,writable:!0,value:p})}}function o(l,p){l instanceof String&&(l+="");var m=0,w=!1,x={next:function(){if(!w&&m<l.length){var L=m++;return{value:p(L,l[L]),done:!1}}return w=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}i("Array.prototype.values",function(l){return l||function(){return o(this,function(p,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function u(l){var p=typeof l;return p=p!="object"?p:l?Array.isArray(l)?"array":p:"null",p=="array"||p=="object"&&typeof l.length=="number"}function c(l){var p=typeof l;return p=="object"&&l!=null||p=="function"}function h(l,p,m){return l.call.apply(l.bind,arguments)}function d(l,p,m){if(!l)throw Error();if(2<arguments.length){var w=Array.prototype.slice.call(arguments,2);return function(){var x=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(x,w),l.apply(p,x)}}return function(){return l.apply(p,arguments)}}function f(l,p,m){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function g(l,p){var m=Array.prototype.slice.call(arguments,1);return function(){var w=m.slice();return w.push.apply(w,arguments),l.apply(this,w)}}function _(l,p){function m(){}m.prototype=p.prototype,l.aa=p.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(w,x,L){for(var G=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)G[ft-2]=arguments[ft];return p.prototype[x].apply(w,G)}}function v(l){const p=l.length;if(0<p){const m=Array(p);for(let w=0;w<p;w++)m[w]=l[w];return m}return[]}function I(l,p){for(let m=1;m<arguments.length;m++){const w=arguments[m];if(u(w)){const x=l.length||0,L=w.length||0;l.length=x+L;for(let G=0;G<L;G++)l[x+G]=w[G]}else l.push(w)}}class T{constructor(p,m){this.i=p,this.j=m,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function N(l){return/^[\s\xa0]*$/.test(l)}function k(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function P(l){return P[" "](l),l}P[" "]=function(){};var B=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function F(l,p,m){for(const w in l)p.call(m,l[w],w,l)}function S(l,p){for(const m in l)p.call(void 0,l[m],m,l)}function A(l){const p={};for(const m in l)p[m]=l[m];return p}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(l,p){let m,w;for(let x=1;x<arguments.length;x++){w=arguments[x];for(m in w)l[m]=w[m];for(let L=0;L<C.length;L++)m=C[L],Object.prototype.hasOwnProperty.call(w,m)&&(l[m]=w[m])}}function O(l){var p=1;l=l.split(":");const m=[];for(;0<p&&l.length;)m.push(l.shift()),p--;return l.length&&m.push(l.join(":")),m}function D(l){a.setTimeout(()=>{throw l},0)}function b(){var l=_s;let p=null;return l.g&&(p=l.g,l.g=l.g.next,l.g||(l.h=null),p.next=null),p}class Nt{constructor(){this.h=this.g=null}add(p,m){const w=ue.get();w.set(p,m),this.h?this.h.next=w:this.g=w,this.h=w}}var ue=new T(()=>new br,l=>l.reset());class br{constructor(){this.next=this.g=this.h=null}set(p,m){this.h=p,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let An,Tn=!1,_s=new Nt,Wu=()=>{const l=a.Promise.resolve(void 0);An=()=>{l.then(x1)}};var x1=()=>{for(var l;l=b();){try{l.h.call(l.g)}catch(m){D(m)}var p=ue;p.j(l),100>p.h&&(p.h++,l.next=p.g,p.g=l)}Tn=!1};function Ze(){this.s=this.s,this.C=this.C}Ze.prototype.s=!1,Ze.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ze.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $t(l,p){this.type=l,this.g=this.target=p,this.defaultPrevented=!1}$t.prototype.h=function(){this.defaultPrevented=!0};var M1=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,p=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};a.addEventListener("test",m,p),a.removeEventListener("test",m,p)}catch{}return l}();function Rr(l,p){if($t.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,w=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=p,p=l.relatedTarget){if(B){t:{try{P(p.nodeName);var x=!0;break t}catch{}x=!1}x||(p=null)}}else m=="mouseover"?p=l.fromElement:m=="mouseout"&&(p=l.toElement);this.relatedTarget=p,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:k1[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Rr.aa.h.call(this)}}_(Rr,$t);var k1={2:"touch",3:"pen",4:"mouse"};Rr.prototype.h=function(){Rr.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Pi="closure_listenable_"+(1e6*Math.random()|0),L1=0;function V1(l,p,m,w,x){this.listener=l,this.proxy=null,this.src=p,this.type=m,this.capture=!!w,this.ha=x,this.key=++L1,this.da=this.fa=!1}function Di(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function xi(l){this.src=l,this.g={},this.h=0}xi.prototype.add=function(l,p,m,w,x){var L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);var G=ws(l,p,w,x);return-1<G?(p=l[G],m||(p.fa=!1)):(p=new V1(p,this.src,L,!!w,x),p.fa=m,l.push(p)),p};function ys(l,p){var m=p.type;if(m in l.g){var w=l.g[m],x=Array.prototype.indexOf.call(w,p,void 0),L;(L=0<=x)&&Array.prototype.splice.call(w,x,1),L&&(Di(p),l.g[m].length==0&&(delete l.g[m],l.h--))}}function ws(l,p,m,w){for(var x=0;x<l.length;++x){var L=l[x];if(!L.da&&L.listener==p&&L.capture==!!m&&L.ha==w)return x}return-1}var vs="closure_lm_"+(1e6*Math.random()|0),Es={};function zu(l,p,m,w,x){if(Array.isArray(p)){for(var L=0;L<p.length;L++)zu(l,p[L],m,w,x);return null}return m=$u(m),l&&l[Pi]?l.K(p,m,c(w)?!!w.capture:!!w,x):B1(l,p,m,!1,w,x)}function B1(l,p,m,w,x,L){if(!p)throw Error("Invalid event type");var G=c(x)?!!x.capture:!!x,ft=As(l);if(ft||(l[vs]=ft=new xi(l)),m=ft.add(p,m,w,G,L),m.proxy)return m;if(w=F1(),m.proxy=w,w.src=l,w.listener=m,l.addEventListener)M1||(x=G),x===void 0&&(x=!1),l.addEventListener(p.toString(),w,x);else if(l.attachEvent)l.attachEvent(qu(p.toString()),w);else if(l.addListener&&l.removeListener)l.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return m}function F1(){function l(m){return p.call(l.src,l.listener,m)}const p=U1;return l}function Xu(l,p,m,w,x){if(Array.isArray(p))for(var L=0;L<p.length;L++)Xu(l,p[L],m,w,x);else w=c(w)?!!w.capture:!!w,m=$u(m),l&&l[Pi]?(l=l.i,p=String(p).toString(),p in l.g&&(L=l.g[p],m=ws(L,m,w,x),-1<m&&(Di(L[m]),Array.prototype.splice.call(L,m,1),L.length==0&&(delete l.g[p],l.h--)))):l&&(l=As(l))&&(p=l.g[p.toString()],l=-1,p&&(l=ws(p,m,w,x)),(m=-1<l?p[l]:null)&&Is(m))}function Is(l){if(typeof l!="number"&&l&&!l.da){var p=l.src;if(p&&p[Pi])ys(p.i,l);else{var m=l.type,w=l.proxy;p.removeEventListener?p.removeEventListener(m,w,l.capture):p.detachEvent?p.detachEvent(qu(m),w):p.addListener&&p.removeListener&&p.removeListener(w),(m=As(p))?(ys(m,l),m.h==0&&(m.src=null,p[vs]=null)):Di(l)}}}function qu(l){return l in Es?Es[l]:Es[l]="on"+l}function U1(l,p){if(l.da)l=!0;else{p=new Rr(p,this);var m=l.listener,w=l.ha||l.src;l.fa&&Is(l),l=m.call(w,p)}return l}function As(l){return l=l[vs],l instanceof xi?l:null}var Ts="__closure_events_fn_"+(1e9*Math.random()>>>0);function $u(l){return typeof l=="function"?l:(l[Ts]||(l[Ts]=function(p){return l.handleEvent(p)}),l[Ts])}function Kt(){Ze.call(this),this.i=new xi(this),this.M=this,this.F=null}_(Kt,Ze),Kt.prototype[Pi]=!0,Kt.prototype.removeEventListener=function(l,p,m,w){Xu(this,l,p,m,w)};function ne(l,p){var m,w=l.F;if(w)for(m=[];w;w=w.F)m.push(w);if(l=l.M,w=p.type||p,typeof p=="string")p=new $t(p,l);else if(p instanceof $t)p.target=p.target||l;else{var x=p;p=new $t(w,l),R(p,x)}if(x=!0,m)for(var L=m.length-1;0<=L;L--){var G=p.g=m[L];x=Mi(G,w,!0,p)&&x}if(G=p.g=l,x=Mi(G,w,!0,p)&&x,x=Mi(G,w,!1,p)&&x,m)for(L=0;L<m.length;L++)G=p.g=m[L],x=Mi(G,w,!1,p)&&x}Kt.prototype.N=function(){if(Kt.aa.N.call(this),this.i){var l=this.i,p;for(p in l.g){for(var m=l.g[p],w=0;w<m.length;w++)Di(m[w]);delete l.g[p],l.h--}}this.F=null},Kt.prototype.K=function(l,p,m,w){return this.i.add(String(l),p,!1,m,w)},Kt.prototype.L=function(l,p,m,w){return this.i.add(String(l),p,!0,m,w)};function Mi(l,p,m,w){if(p=l.i.g[String(p)],!p)return!0;p=p.concat();for(var x=!0,L=0;L<p.length;++L){var G=p[L];if(G&&!G.da&&G.capture==m){var ft=G.listener,Ft=G.ha||G.src;G.fa&&ys(l.i,G),x=ft.call(Ft,w)!==!1&&x}}return x&&!w.defaultPrevented}function Ku(l,p,m){if(typeof l=="function")m&&(l=f(l,m));else if(l&&typeof l.handleEvent=="function")l=f(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(l,p||0)}function Yu(l){l.g=Ku(()=>{l.g=null,l.i&&(l.i=!1,Yu(l))},l.l);const p=l.h;l.h=null,l.m.apply(null,p)}class j1 extends Ze{constructor(p,m){super(),this.m=p,this.l=m,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Yu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(l){Ze.call(this),this.h=l,this.g={}}_(Nr,Ze);var Qu=[];function Zu(l){F(l.g,function(p,m){this.g.hasOwnProperty(m)&&Is(p)},l),l.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),Zu(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cs=a.JSON.stringify,H1=a.JSON.parse,G1=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Ss(){}Ss.prototype.h=null;function Ju(l){return l.h||(l.h=l.i())}function tc(){}var Or={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function bs(){$t.call(this,"d")}_(bs,$t);function Rs(){$t.call(this,"c")}_(Rs,$t);var Cn={},ec=null;function ki(){return ec=ec||new Kt}Cn.La="serverreachability";function nc(l){$t.call(this,Cn.La,l)}_(nc,$t);function Pr(l){const p=ki();ne(p,new nc(p))}Cn.STAT_EVENT="statevent";function rc(l,p){$t.call(this,Cn.STAT_EVENT,l),this.stat=p}_(rc,$t);function re(l){const p=ki();ne(p,new rc(p,l))}Cn.Ma="timingevent";function ic(l,p){$t.call(this,Cn.Ma,l),this.size=p}_(ic,$t);function Dr(l,p){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},p)}function xr(){this.g=!0}xr.prototype.xa=function(){this.g=!1};function W1(l,p,m,w,x,L){l.info(function(){if(l.g)if(L)for(var G="",ft=L.split("&"),Ft=0;Ft<ft.length;Ft++){var st=ft[Ft].split("=");if(1<st.length){var Yt=st[0];st=st[1];var Qt=Yt.split("_");G=2<=Qt.length&&Qt[1]=="type"?G+(Yt+"="+st+"&"):G+(Yt+"=redacted&")}}else G=null;else G=L;return"XMLHTTP REQ ("+w+") [attempt "+x+"]: "+p+`
`+m+`
`+G})}function z1(l,p,m,w,x,L,G){l.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+x+"]: "+p+`
`+m+`
`+L+" "+G})}function Yn(l,p,m,w){l.info(function(){return"XMLHTTP TEXT ("+p+"): "+q1(l,m)+(w?" "+w:"")})}function X1(l,p){l.info(function(){return"TIMEOUT: "+p})}xr.prototype.info=function(){};function q1(l,p){if(!l.g)return p;if(!p)return null;try{var m=JSON.parse(p);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var w=m[l];if(!(2>w.length)){var x=w[1];if(Array.isArray(x)&&!(1>x.length)){var L=x[0];if(L!="noop"&&L!="stop"&&L!="close")for(var G=1;G<x.length;G++)x[G]=""}}}}return Cs(m)}catch{return p}}var Li={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},oc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ns;function Vi(){}_(Vi,Ss),Vi.prototype.g=function(){return new XMLHttpRequest},Vi.prototype.i=function(){return{}},Ns=new Vi;function Je(l,p,m,w){this.j=l,this.i=p,this.l=m,this.R=w||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new sc}function sc(){this.i=null,this.g="",this.h=!1}var ac={},Os={};function Ps(l,p,m){l.L=1,l.v=ji(Ve(p)),l.m=m,l.P=!0,uc(l,null)}function uc(l,p){l.F=Date.now(),Bi(l),l.A=Ve(l.v);var m=l.A,w=l.R;Array.isArray(w)||(w=[String(w)]),Ic(m.i,"t",w),l.C=0,m=l.j.J,l.h=new sc,l.g=Uc(l.j,m?p:null,!l.m),0<l.O&&(l.M=new j1(f(l.Y,l,l.g),l.O)),p=l.U,m=l.g,w=l.ca;var x="readystatechange";Array.isArray(x)||(x&&(Qu[0]=x.toString()),x=Qu);for(var L=0;L<x.length;L++){var G=zu(m,x[L],w||p.handleEvent,!1,p.h||p);if(!G)break;p.g[G.key]=G}p=l.H?A(l.H):{},l.m?(l.u||(l.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,p)):(l.u="GET",l.g.ea(l.A,l.u,null,p)),Pr(),W1(l.i,l.u,l.A,l.l,l.R,l.m)}Je.prototype.ca=function(l){l=l.target;const p=this.M;p&&Be(l)==3?p.j():this.Y(l)},Je.prototype.Y=function(l){try{if(l==this.g)t:{const Qt=Be(this.g);var p=this.g.Ba();const Jn=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||Nc(this.g)))){this.J||Qt!=4||p==7||(p==8||0>=Jn?Pr(3):Pr(2)),Ds(this);var m=this.g.Z();this.X=m;e:if(cc(this)){var w=Nc(this.g);l="";var x=w.length,L=Be(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Sn(this),Mr(this);var G="";break e}this.h.i=new a.TextDecoder}for(p=0;p<x;p++)this.h.h=!0,l+=this.h.i.decode(w[p],{stream:!(L&&p==x-1)});w.length=0,this.h.g+=l,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=m==200,z1(this.i,this.u,this.A,this.l,this.R,Qt,m),this.o){if(this.T&&!this.K){e:{if(this.g){var ft,Ft=this.g;if((ft=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(ft)){var st=ft;break e}}st=null}if(m=st)Yn(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xs(this,m);else{this.o=!1,this.s=3,re(12),Sn(this),Mr(this);break t}}if(this.P){m=!0;let Ee;for(;!this.J&&this.C<G.length;)if(Ee=$1(this,G),Ee==Os){Qt==4&&(this.s=4,re(14),m=!1),Yn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ee==ac){this.s=4,re(15),Yn(this.i,this.l,G,"[Invalid Chunk]"),m=!1;break}else Yn(this.i,this.l,Ee,null),xs(this,Ee);if(cc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||G.length!=0||this.h.h||(this.s=1,re(16),m=!1),this.o=this.o&&m,!m)Yn(this.i,this.l,G,"[Invalid Chunked Response]"),Sn(this),Mr(this);else if(0<G.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),Fs(Yt),Yt.M=!0,re(11))}}else Yn(this.i,this.l,G,null),xs(this,G);Qt==4&&Sn(this),this.o&&!this.J&&(Qt==4?Lc(this.j,this):(this.o=!1,Bi(this)))}else hp(this.g),m==400&&0<G.indexOf("Unknown SID")?(this.s=3,re(12)):(this.s=0,re(13)),Sn(this),Mr(this)}}}catch{}finally{}};function cc(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function $1(l,p){var m=l.C,w=p.indexOf(`
`,m);return w==-1?Os:(m=Number(p.substring(m,w)),isNaN(m)?ac:(w+=1,w+m>p.length?Os:(p=p.slice(w,w+m),l.C=w+m,p)))}Je.prototype.cancel=function(){this.J=!0,Sn(this)};function Bi(l){l.S=Date.now()+l.I,lc(l,l.I)}function lc(l,p){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Dr(f(l.ba,l),p)}function Ds(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Je.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(X1(this.i,this.A),this.L!=2&&(Pr(),re(17)),Sn(this),this.s=2,Mr(this)):lc(this,this.S-l)};function Mr(l){l.j.G==0||l.J||Lc(l.j,l)}function Sn(l){Ds(l);var p=l.M;p&&typeof p.ma=="function"&&p.ma(),l.M=null,Zu(l.U),l.g&&(p=l.g,l.g=null,p.abort(),p.ma())}function xs(l,p){try{var m=l.j;if(m.G!=0&&(m.g==l||Ms(m.h,l))){if(!l.K&&Ms(m.h,l)&&m.G==3){try{var w=m.Da.g.parse(p)}catch{w=null}if(Array.isArray(w)&&w.length==3){var x=w;if(x[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)Xi(m),Wi(m);else break t;Bs(m),re(18)}}else m.za=x[1],0<m.za-m.T&&37500>x[2]&&m.F&&m.v==0&&!m.C&&(m.C=Dr(f(m.Za,m),6e3));if(1>=fc(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Rn(m,11)}else if((l.K||m.g==l)&&Xi(m),!N(p))for(x=m.Da.g.parse(p),p=0;p<x.length;p++){let st=x[p];if(m.T=st[0],st=st[1],m.G==2)if(st[0]=="c"){m.K=st[1],m.ia=st[2];const Yt=st[3];Yt!=null&&(m.la=Yt,m.j.info("VER="+m.la));const Qt=st[4];Qt!=null&&(m.Aa=Qt,m.j.info("SVER="+m.Aa));const Jn=st[5];Jn!=null&&typeof Jn=="number"&&0<Jn&&(w=1.5*Jn,m.L=w,m.j.info("backChannelRequestTimeoutMs_="+w)),w=m;const Ee=l.g;if(Ee){const $i=Ee.g?Ee.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($i){var L=w.h;L.g||$i.indexOf("spdy")==-1&&$i.indexOf("quic")==-1&&$i.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(ks(L,L.h),L.h=null))}if(w.D){const Us=Ee.g?Ee.g.getResponseHeader("X-HTTP-Session-Id"):null;Us&&(w.ya=Us,mt(w.I,w.D,Us))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),w=m;var G=l;if(w.qa=Fc(w,w.J?w.ia:null,w.W),G.K){pc(w.h,G);var ft=G,Ft=w.L;Ft&&(ft.I=Ft),ft.B&&(Ds(ft),Bi(ft)),w.g=G}else Mc(w);0<m.i.length&&zi(m)}else st[0]!="stop"&&st[0]!="close"||Rn(m,7);else m.G==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?Rn(m,7):Vs(m):st[0]!="noop"&&m.l&&m.l.ta(st),m.v=0)}}Pr(4)}catch{}}var K1=class{constructor(l,p){this.g=l,this.map=p}};function hc(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dc(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function fc(l){return l.h?1:l.g?l.g.size:0}function Ms(l,p){return l.h?l.h==p:l.g?l.g.has(p):!1}function ks(l,p){l.g?l.g.add(p):l.h=p}function pc(l,p){l.h&&l.h==p?l.h=null:l.g&&l.g.has(p)&&l.g.delete(p)}hc.prototype.cancel=function(){if(this.i=gc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function gc(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let p=l.i;for(const m of l.g.values())p=p.concat(m.D);return p}return v(l.i)}function Y1(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var p=[],m=l.length,w=0;w<m;w++)p.push(l[w]);return p}p=[],m=0;for(w in l)p[m++]=l[w];return p}function Q1(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var p=[];l=l.length;for(var m=0;m<l;m++)p.push(m);return p}p=[],m=0;for(const w in l)p[m++]=w;return p}}}function mc(l,p){if(l.forEach&&typeof l.forEach=="function")l.forEach(p,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,p,void 0);else for(var m=Q1(l),w=Y1(l),x=w.length,L=0;L<x;L++)p.call(void 0,w[L],m&&m[L],l)}var _c=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Z1(l,p){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var w=l[m].indexOf("="),x=null;if(0<=w){var L=l[m].substring(0,w);x=l[m].substring(w+1)}else L=l[m];p(L,x?decodeURIComponent(x.replace(/\+/g," ")):"")}}}function bn(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof bn){this.h=l.h,Fi(this,l.j),this.o=l.o,this.g=l.g,Ui(this,l.s),this.l=l.l;var p=l.i,m=new Vr;m.i=p.i,p.g&&(m.g=new Map(p.g),m.h=p.h),yc(this,m),this.m=l.m}else l&&(p=String(l).match(_c))?(this.h=!1,Fi(this,p[1]||"",!0),this.o=kr(p[2]||""),this.g=kr(p[3]||"",!0),Ui(this,p[4]),this.l=kr(p[5]||"",!0),yc(this,p[6]||"",!0),this.m=kr(p[7]||"")):(this.h=!1,this.i=new Vr(null,this.h))}bn.prototype.toString=function(){var l=[],p=this.j;p&&l.push(Lr(p,wc,!0),":");var m=this.g;return(m||p=="file")&&(l.push("//"),(p=this.o)&&l.push(Lr(p,wc,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(Lr(m,m.charAt(0)=="/"?ep:tp,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",Lr(m,rp)),l.join("")};function Ve(l){return new bn(l)}function Fi(l,p,m){l.j=m?kr(p,!0):p,l.j&&(l.j=l.j.replace(/:$/,""))}function Ui(l,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);l.s=p}else l.s=null}function yc(l,p,m){p instanceof Vr?(l.i=p,ip(l.i,l.h)):(m||(p=Lr(p,np)),l.i=new Vr(p,l.h))}function mt(l,p,m){l.i.set(p,m)}function ji(l){return mt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function kr(l,p){return l?p?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Lr(l,p,m){return typeof l=="string"?(l=encodeURI(l).replace(p,J1),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function J1(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var wc=/[#\/\?@]/g,tp=/[#\?:]/g,ep=/[#\?]/g,np=/[#\?@]/g,rp=/#/g;function Vr(l,p){this.h=this.g=null,this.i=l||null,this.j=!!p}function tn(l){l.g||(l.g=new Map,l.h=0,l.i&&Z1(l.i,function(p,m){l.add(decodeURIComponent(p.replace(/\+/g," ")),m)}))}n=Vr.prototype,n.add=function(l,p){tn(this),this.i=null,l=Qn(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(p),this.h+=1,this};function vc(l,p){tn(l),p=Qn(l,p),l.g.has(p)&&(l.i=null,l.h-=l.g.get(p).length,l.g.delete(p))}function Ec(l,p){return tn(l),p=Qn(l,p),l.g.has(p)}n.forEach=function(l,p){tn(this),this.g.forEach(function(m,w){m.forEach(function(x){l.call(p,x,w,this)},this)},this)},n.na=function(){tn(this);const l=Array.from(this.g.values()),p=Array.from(this.g.keys()),m=[];for(let w=0;w<p.length;w++){const x=l[w];for(let L=0;L<x.length;L++)m.push(p[w])}return m},n.V=function(l){tn(this);let p=[];if(typeof l=="string")Ec(this,l)&&(p=p.concat(this.g.get(Qn(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)p=p.concat(l[m])}return p},n.set=function(l,p){return tn(this),this.i=null,l=Qn(this,l),Ec(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[p]),this.h+=1,this},n.get=function(l,p){return l?(l=this.V(l),0<l.length?String(l[0]):p):p};function Ic(l,p,m){vc(l,p),0<m.length&&(l.i=null,l.g.set(Qn(l,p),v(m)),l.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],p=Array.from(this.g.keys());for(var m=0;m<p.length;m++){var w=p[m];const L=encodeURIComponent(String(w)),G=this.V(w);for(w=0;w<G.length;w++){var x=L;G[w]!==""&&(x+="="+encodeURIComponent(String(G[w]))),l.push(x)}}return this.i=l.join("&")};function Qn(l,p){return p=String(p),l.j&&(p=p.toLowerCase()),p}function ip(l,p){p&&!l.j&&(tn(l),l.i=null,l.g.forEach(function(m,w){var x=w.toLowerCase();w!=x&&(vc(this,w),Ic(this,x,m))},l)),l.j=p}function op(l,p){const m=new xr;if(a.Image){const w=new Image;w.onload=g(en,m,"TestLoadImage: loaded",!0,p,w),w.onerror=g(en,m,"TestLoadImage: error",!1,p,w),w.onabort=g(en,m,"TestLoadImage: abort",!1,p,w),w.ontimeout=g(en,m,"TestLoadImage: timeout",!1,p,w),a.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=l}else p(!1)}function sp(l,p){const m=new xr,w=new AbortController,x=setTimeout(()=>{w.abort(),en(m,"TestPingServer: timeout",!1,p)},1e4);fetch(l,{signal:w.signal}).then(L=>{clearTimeout(x),L.ok?en(m,"TestPingServer: ok",!0,p):en(m,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(x),en(m,"TestPingServer: error",!1,p)})}function en(l,p,m,w,x){try{x&&(x.onload=null,x.onerror=null,x.onabort=null,x.ontimeout=null),w(m)}catch{}}function ap(){this.g=new G1}function up(l,p,m){const w=m||"";try{mc(l,function(x,L){let G=x;c(x)&&(G=Cs(x)),p.push(w+L+"="+encodeURIComponent(G))})}catch(x){throw p.push(w+"type="+encodeURIComponent("_badmap")),x}}function Br(l){this.l=l.Ub||null,this.j=l.eb||!1}_(Br,Ss),Br.prototype.g=function(){return new Hi(this.l,this.j)},Br.prototype.i=function(l){return function(){return l}}({});function Hi(l,p){Kt.call(this),this.D=l,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Hi,Kt),n=Hi.prototype,n.open=function(l,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=p,this.readyState=1,Ur(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(p.body=l),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fr(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Ur(this)),this.g&&(this.readyState=3,Ur(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ac(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ac(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var p=l.value?l.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!l.done}))&&(this.response=this.responseText+=p)}l.done?Fr(this):Ur(this),this.readyState==3&&Ac(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Fr(this))},n.Qa=function(l){this.g&&(this.response=l,Fr(this))},n.ga=function(){this.g&&Fr(this)};function Fr(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Ur(l)}n.setRequestHeader=function(l,p){this.u.append(l,p)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],p=this.h.entries();for(var m=p.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=p.next();return l.join(`\r
`)};function Ur(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Hi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Tc(l){let p="";return F(l,function(m,w){p+=w,p+=":",p+=m,p+=`\r
`}),p}function Ls(l,p,m){t:{for(w in m){var w=!1;break t}w=!0}w||(m=Tc(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):mt(l,p,m))}function Et(l){Kt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Et,Kt);var cp=/^https?$/i,lp=["POST","PUT"];n=Et.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,p,m,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);p=p?p.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ns.g(),this.v=this.o?Ju(this.o):Ju(Ns),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(p,String(l),!0),this.B=!1}catch(L){Cc(this,L);return}if(l=m||"",m=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var x in w)m.set(x,w[x]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const L of w.keys())m.set(L,w.get(L));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(m.keys()).find(L=>L.toLowerCase()=="content-type"),x=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(lp,p,void 0))||w||x||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,G]of m)this.g.setRequestHeader(L,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Rc(this),this.u=!0,this.g.send(l),this.u=!1}catch(L){Cc(this,L)}};function Cc(l,p){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=p,l.m=5,Sc(l),Gi(l)}function Sc(l){l.A||(l.A=!0,ne(l,"complete"),ne(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ne(this,"complete"),ne(this,"abort"),Gi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gi(this,!0)),Et.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?bc(this):this.bb())},n.bb=function(){bc(this)};function bc(l){if(l.h&&typeof s<"u"&&(!l.v[1]||Be(l)!=4||l.Z()!=2)){if(l.u&&Be(l)==4)Ku(l.Ea,0,l);else if(ne(l,"readystatechange"),Be(l)==4){l.h=!1;try{const G=l.Z();t:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break t;default:p=!1}var m;if(!(m=p)){var w;if(w=G===0){var x=String(l.D).match(_c)[1]||null;!x&&a.self&&a.self.location&&(x=a.self.location.protocol.slice(0,-1)),w=!cp.test(x?x.toLowerCase():"")}m=w}if(m)ne(l,"complete"),ne(l,"success");else{l.m=6;try{var L=2<Be(l)?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.Z()+"]",Sc(l)}}finally{Gi(l)}}}}function Gi(l,p){if(l.g){Rc(l);const m=l.g,w=l.v[0]?()=>{}:null;l.g=null,l.v=null,p||ne(l,"ready");try{m.onreadystatechange=w}catch{}}}function Rc(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function Be(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<Be(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var p=this.g.responseText;return l&&p.indexOf(l)==0&&(p=p.substring(l.length)),H1(p)}};function Nc(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function hp(l){const p={};l=(l.g&&2<=Be(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<l.length;w++){if(N(l[w]))continue;var m=O(l[w]);const x=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const L=p[x]||[];p[x]=L,L.push(m)}S(p,function(w){return w.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function jr(l,p,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||p}function Oc(l){this.Aa=0,this.i=[],this.j=new xr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=jr("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=jr("baseRetryDelayMs",5e3,l),this.cb=jr("retryDelaySeedMs",1e4,l),this.Wa=jr("forwardChannelMaxRetries",2,l),this.wa=jr("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new hc(l&&l.concurrentRequestLimit),this.Da=new ap,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Oc.prototype,n.la=8,n.G=1,n.connect=function(l,p,m,w){re(0),this.W=l,this.H=p||{},m&&w!==void 0&&(this.H.OSID=m,this.H.OAID=w),this.F=this.X,this.I=Fc(this,null,this.W),zi(this)};function Vs(l){if(Pc(l),l.G==3){var p=l.U++,m=Ve(l.I);if(mt(m,"SID",l.K),mt(m,"RID",p),mt(m,"TYPE","terminate"),Hr(l,m),p=new Je(l,l.j,p),p.L=2,p.v=ji(Ve(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=p.v,m=!0),m||(p.g=Uc(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Bi(p)}Bc(l)}function Wi(l){l.g&&(Fs(l),l.g.cancel(),l.g=null)}function Pc(l){Wi(l),l.u&&(a.clearTimeout(l.u),l.u=null),Xi(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function zi(l){if(!dc(l.h)&&!l.s){l.s=!0;var p=l.Ga;An||Wu(),Tn||(An(),Tn=!0),_s.add(p,l),l.B=0}}function dp(l,p){return fc(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=p.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Dr(f(l.Ga,l,p),Vc(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const x=new Je(this,this.j,l);let L=this.o;if(this.S&&(L?(L=A(L),R(L,this.S)):L=this.S),this.m!==null||this.O||(x.H=L,L=null),this.P)t:{for(var p=0,m=0;m<this.i.length;m++){e:{var w=this.i[m];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break e}w=void 0}if(w===void 0)break;if(p+=w,4096<p){p=m;break t}if(p===4096||m===this.i.length-1){p=m+1;break t}}p=1e3}else p=1e3;p=xc(this,x,p),m=Ve(this.I),mt(m,"RID",l),mt(m,"CVER",22),this.D&&mt(m,"X-HTTP-Session-Id",this.D),Hr(this,m),L&&(this.O?p="headers="+encodeURIComponent(String(Tc(L)))+"&"+p:this.m&&Ls(m,this.m,L)),ks(this.h,x),this.Ua&&mt(m,"TYPE","init"),this.P?(mt(m,"$req",p),mt(m,"SID","null"),x.T=!0,Ps(x,m,null)):Ps(x,m,p),this.G=2}}else this.G==3&&(l?Dc(this,l):this.i.length==0||dc(this.h)||Dc(this))};function Dc(l,p){var m;p?m=p.l:m=l.U++;const w=Ve(l.I);mt(w,"SID",l.K),mt(w,"RID",m),mt(w,"AID",l.T),Hr(l,w),l.m&&l.o&&Ls(w,l.m,l.o),m=new Je(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),p&&(l.i=p.D.concat(l.i)),p=xc(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),ks(l.h,m),Ps(m,w,p)}function Hr(l,p){l.H&&F(l.H,function(m,w){mt(p,w,m)}),l.l&&mc({},function(m,w){mt(p,w,m)})}function xc(l,p,m){m=Math.min(l.i.length,m);var w=l.l?f(l.l.Na,l.l,l):null;t:{var x=l.i;let L=-1;for(;;){const G=["count="+m];L==-1?0<m?(L=x[0].g,G.push("ofs="+L)):L=0:G.push("ofs="+L);let ft=!0;for(let Ft=0;Ft<m;Ft++){let st=x[Ft].g;const Yt=x[Ft].map;if(st-=L,0>st)L=Math.max(0,x[Ft].g-100),ft=!1;else try{up(Yt,G,"req"+st+"_")}catch{w&&w(Yt)}}if(ft){w=G.join("&");break t}}}return l=l.i.splice(0,m),p.D=l,w}function Mc(l){if(!l.g&&!l.u){l.Y=1;var p=l.Fa;An||Wu(),Tn||(An(),Tn=!0),_s.add(p,l),l.v=0}}function Bs(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Dr(f(l.Fa,l),Vc(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,kc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Dr(f(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,re(10),Wi(this),kc(this))};function Fs(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function kc(l){l.g=new Je(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var p=Ve(l.qa);mt(p,"RID","rpc"),mt(p,"SID",l.K),mt(p,"AID",l.T),mt(p,"CI",l.F?"0":"1"),!l.F&&l.ja&&mt(p,"TO",l.ja),mt(p,"TYPE","xmlhttp"),Hr(l,p),l.m&&l.o&&Ls(p,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=ji(Ve(p)),m.m=null,m.P=!0,uc(m,l)}n.Za=function(){this.C!=null&&(this.C=null,Wi(this),Bs(this),re(19))};function Xi(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Lc(l,p){var m=null;if(l.g==p){Xi(l),Fs(l),l.g=null;var w=2}else if(Ms(l.h,p))m=p.D,pc(l.h,p),w=1;else return;if(l.G!=0){if(p.o)if(w==1){m=p.m?p.m.length:0,p=Date.now()-p.F;var x=l.B;w=ki(),ne(w,new ic(w,m)),zi(l)}else Mc(l);else if(x=p.s,x==3||x==0&&0<p.X||!(w==1&&dp(l,p)||w==2&&Bs(l)))switch(m&&0<m.length&&(p=l.h,p.i=p.i.concat(m)),x){case 1:Rn(l,5);break;case 4:Rn(l,10);break;case 3:Rn(l,6);break;default:Rn(l,2)}}}function Vc(l,p){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*p}function Rn(l,p){if(l.j.info("Error code "+p),p==2){var m=f(l.fb,l),w=l.Xa;const x=!w;w=new bn(w||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Fi(w,"https"),ji(w),x?op(w.toString(),m):sp(w.toString(),m)}else re(2);l.G=0,l.l&&l.l.sa(p),Bc(l),Pc(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),re(2)):(this.j.info("Failed to ping google.com"),re(1))};function Bc(l){if(l.G=0,l.ka=[],l.l){const p=gc(l.h);(p.length!=0||l.i.length!=0)&&(I(l.ka,p),I(l.ka,l.i),l.h.i.length=0,v(l.i),l.i.length=0),l.l.ra()}}function Fc(l,p,m){var w=m instanceof bn?Ve(m):new bn(m);if(w.g!="")p&&(w.g=p+"."+w.g),Ui(w,w.s);else{var x=a.location;w=x.protocol,p=p?p+"."+x.hostname:x.hostname,x=+x.port;var L=new bn(null);w&&Fi(L,w),p&&(L.g=p),x&&Ui(L,x),m&&(L.l=m),w=L}return m=l.D,p=l.ya,m&&p&&mt(w,m,p),mt(w,"VER",l.la),Hr(l,w),w}function Uc(l,p,m){if(p&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=l.Ca&&!l.pa?new Et(new Br({eb:m})):new Et(l.pa),p.Ha(l.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function jc(){}n=jc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function qi(){}qi.prototype.g=function(l,p){return new ge(l,p)};function ge(l,p){Kt.call(this),this.g=new Oc(p),this.l=l,this.h=p&&p.messageUrlParams||null,l=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(l?l["X-WebChannel-Content-Type"]=p.messageContentType:l={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(l?l["X-WebChannel-Client-Profile"]=p.va:l={"X-WebChannel-Client-Profile":p.va}),this.g.S=l,(l=p&&p.Sb)&&!N(l)&&(this.g.m=l),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!N(p)&&(this.g.D=p,l=this.h,l!==null&&p in l&&(l=this.h,p in l&&delete l[p])),this.j=new Zn(this)}_(ge,Kt),ge.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ge.prototype.close=function(){Vs(this.g)},ge.prototype.o=function(l){var p=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=Cs(l),l=m);p.i.push(new K1(p.Ya++,l)),p.G==3&&zi(p)},ge.prototype.N=function(){this.g.l=null,delete this.j,Vs(this.g),delete this.g,ge.aa.N.call(this)};function Hc(l){bs.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var p=l.__sm__;if(p){t:{for(const m in p){l=m;break t}l=void 0}(this.i=l)&&(l=this.i,p=p!==null&&l in p?p[l]:void 0),this.data=p}else this.data=l}_(Hc,bs);function Gc(){Rs.call(this),this.status=1}_(Gc,Rs);function Zn(l){this.g=l}_(Zn,jc),Zn.prototype.ua=function(){ne(this.g,"a")},Zn.prototype.ta=function(l){ne(this.g,new Hc(l))},Zn.prototype.sa=function(l){ne(this.g,new Gc)},Zn.prototype.ra=function(){ne(this.g,"b")},qi.prototype.createWebChannel=qi.prototype.g,ge.prototype.send=ge.prototype.o,ge.prototype.open=ge.prototype.m,ge.prototype.close=ge.prototype.close,Od=function(){return new qi},Nd=function(){return ki()},Rd=Cn,ma={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Li.NO_ERROR=0,Li.TIMEOUT=8,Li.HTTP_ERROR=6,mo=Li,oc.COMPLETE="complete",bd=oc,tc.EventType=Or,Or.OPEN="a",Or.CLOSE="b",Or.ERROR="c",Or.MESSAGE="d",Kt.prototype.listen=Kt.prototype.K,$r=tc,Sd=Br,Et.prototype.listenOnce=Et.prototype.L,Et.prototype.getLastError=Et.prototype.Ka,Et.prototype.getLastErrorCode=Et.prototype.Ba,Et.prototype.getStatus=Et.prototype.Z,Et.prototype.getResponseJson=Et.prototype.Oa,Et.prototype.getResponseText=Et.prototype.oa,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Ha,Cd=Et}).apply(typeof Qi<"u"?Qi:typeof self<"u"?self:typeof window<"u"?window:{});const wl="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Jt.UNAUTHENTICATED=new Jt(null),Jt.GOOGLE_CREDENTIALS=new Jt("google-credentials-uid"),Jt.FIRST_PARTY=new Jt("first-party-uid"),Jt.MOCK_USER=new Jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ir="10.13.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn=new Ua("@firebase/firestore");function Gr(){return Gn.logLevel}function z(n,...t){if(Gn.logLevel<=rt.DEBUG){const e=t.map(eu);Gn.debug(`Firestore (${Ir}): ${n}`,...e)}}function $e(n,...t){if(Gn.logLevel<=rt.ERROR){const e=t.map(eu);Gn.error(`Firestore (${Ir}): ${n}`,...e)}}function dr(n,...t){if(Gn.logLevel<=rt.WARN){const e=t.map(eu);Gn.warn(`Firestore (${Ir}): ${n}`,...e)}}function eu(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(n="Unexpected state"){const t=`FIRESTORE (${Ir}) INTERNAL ASSERTION FAILED: `+n;throw $e(t),new Error(t)}function gt(n,t){n||J()}function et(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends Le{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class nm{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Jt.UNAUTHENTICATED))}shutdown(){}}class rm{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class im{constructor(t){this.t=t,this.currentUser=Jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let r=this.i;const i=u=>this.i!==r?(r=this.i,e(u)):Promise.resolve();let o=new We;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new We,t.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const u=o;t.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},a=u=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new We)}},0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(gt(typeof r.accessToken=="string"),new Pd(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return gt(t===null||typeof t=="string"),new Jt(t)}}class om{constructor(t,e,r){this.l=t,this.h=e,this.P=r,this.type="FirstParty",this.user=Jt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class sm{constructor(t,e,r){this.l=t,this.h=e,this.P=r}getToken(){return Promise.resolve(new om(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(Jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class am{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class um{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const r=o=>{o.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.R;return this.R=o.token,z("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>r(o))};const i=o=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(gt(typeof e.token=="string"),this.R=e.token,new am(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const i=cm(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<e&&(r+=t.charAt(i[o]%t.length))}return r}}function ut(n,t){return n<t?-1:n>t?1:0}function fr(n,t,e){return n.length===t.length&&n.every((r,i)=>e(r,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new q(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new q(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new q(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Mt.fromMillis(Date.now())}static fromDate(t){return Mt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new Mt(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new tt(t)}static min(){return new tt(new Mt(0,0))}static max(){return new tt(new Mt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(t,e,r){e===void 0?e=0:e>t.length&&J(),r===void 0?r=t.length-e:r>t.length-e&&J(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return hi.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let i=0;i<r;i++){const o=t.get(i),s=e.get(i);if(o<s)return-1;if(o>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class yt extends hi{construct(t,e,r){return new yt(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new q(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(i=>i.length>0))}return new yt(e)}static emptyPath(){return new yt([])}}const lm=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ht extends hi{construct(t,e,r){return new Ht(t,e,r)}static isValidIdentifier(t){return lm.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ht.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ht(["__name__"])}static fromServerFormat(t){const e=[];let r="",i=0;const o=()=>{if(r.length===0)throw new q(U.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let s=!1;for(;i<t.length;){const a=t[i];if(a==="\\"){if(i+1===t.length)throw new q(U.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new q(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new q(U.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ht(e)}static emptyPath(){return new Ht([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(t){this.path=t}static fromPath(t){return new K(yt.fromString(t))}static fromName(t){return new K(yt.fromString(t).popFirst(5))}static empty(){return new K(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&yt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return yt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new K(new yt(t.slice()))}}function hm(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=tt.fromTimestamp(r===1e9?new Mt(e+1,0):new Mt(e,r));return new wn(i,K.empty(),t)}function dm(n){return new wn(n.readTime,n.key,-1)}class wn{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new wn(tt.min(),K.empty(),-1)}static max(){return new wn(tt.max(),K.empty(),-1)}}function fm(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=K.comparator(n.documentKey,t.documentKey),e!==0?e:ut(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gm{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ei(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==pm)throw n;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&J(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new j((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(e,o).next(r,i)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof j?e:j.resolve(e)}catch(e){return j.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):j.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):j.reject(e)}static resolve(t){return new j((e,r)=>{e(t)})}static reject(t){return new j((e,r)=>{r(t)})}static waitFor(t){return new j((e,r)=>{let i=0,o=0,s=!1;t.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&e()},u=>r(u))}),s=!0,o===i&&e()})}static or(t){let e=j.resolve(!1);for(const r of t)e=e.next(i=>i?j.resolve(i):r());return e}static forEach(t,e){const r=[];return t.forEach((i,o)=>{r.push(e.call(this,i,o))}),this.waitFor(r)}static mapArray(t,e){return new j((r,i)=>{const o=t.length,s=new Array(o);let a=0;for(let u=0;u<o;u++){const c=u;e(t[c]).next(h=>{s[c]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(t,e){return new j((r,i)=>{const o=()=>{t()===!0?e().next(()=>{o()},i):r()};o()})}}function mm(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Ii(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ie(r),this.se=r=>e.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}nu.oe=-1;function Jo(n){return n==null}function xo(n){return n===0&&1/n==-1/0}function _m(n){return typeof n=="number"&&Number.isInteger(n)&&!xo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function $n(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function xd(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(t,e){this.comparator=t,this.root=e||jt.EMPTY}insert(t,e){return new vt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(t){return new vt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,jt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(r===0)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return e+r.left.size;i<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Zi(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Zi(this.root,t,this.comparator,!1)}getReverseIterator(){return new Zi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Zi(this.root,t,this.comparator,!0)}}class Zi{constructor(t,e,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?r(t.key,e):1,e&&i&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class jt{constructor(t,e,r,i,o){this.key=t,this.value=e,this.color=r??jt.RED,this.left=i??jt.EMPTY,this.right=o??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,i,o){return new jt(t??this.key,e??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let i=this;const o=r(t,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(t,e,r),null):o===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return jt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw J();const t=this.left.check();if(t!==this.right.check())throw J();return t+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw J()}get value(){throw J()}get color(){throw J()}get left(){throw J()}get right(){throw J()}copy(t,e,r,i,o){return this}insert(t,e,r){return new jt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(t){this.comparator=t,this.data=new vt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let r;for(r=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new El(this.data.getIterator())}getIteratorFrom(t){return new El(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof Xt)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Xt(this.comparator);return e.data=t,e}}class El{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(t){this.fields=t,t.sort(Ht.comparator)}static empty(){return new _e([])}unionWith(t){let e=new Xt(Ht.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new _e(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return fr(this.fields,t.fields,(e,r)=>e.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Md("Invalid base64 string: "+o):o}}(t);return new qt(e)}static fromUint8Array(t){const e=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(t);return new qt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}qt.EMPTY_BYTE_STRING=new qt("");const ym=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vn(n){if(gt(!!n),typeof n=="string"){let t=0;const e=ym.exec(n);if(gt(!!e),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:bt(n.seconds),nanos:bt(n.nanos)}}function bt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Wn(n){return typeof n=="string"?qt.fromBase64String(n):qt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function iu(n){const t=n.mapValue.fields.__previous_value__;return ru(t)?iu(t):t}function di(n){const t=vn(n.mapValue.fields.__local_write_time__.timestampValue);return new Mt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(t,e,r,i,o,s,a,u,c){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}}class fi{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new fi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof fi&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function zn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ru(n)?4:Em(n)?9007199254740991:vm(n)?10:11:J()}function Me(n,t){if(n===t)return!0;const e=zn(n);if(e!==zn(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return di(n).isEqual(di(t));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=vn(i.timestampValue),a=vn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(i,o){return Wn(i.bytesValue).isEqual(Wn(o.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(i,o){return bt(i.geoPointValue.latitude)===bt(o.geoPointValue.latitude)&&bt(i.geoPointValue.longitude)===bt(o.geoPointValue.longitude)}(n,t);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return bt(i.integerValue)===bt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=bt(i.doubleValue),a=bt(o.doubleValue);return s===a?xo(s)===xo(a):isNaN(s)&&isNaN(a)}return!1}(n,t);case 9:return fr(n.arrayValue.values||[],t.arrayValue.values||[],Me);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(vl(s)!==vl(a))return!1;for(const u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!Me(s[u],a[u])))return!1;return!0}(n,t);default:return J()}}function pi(n,t){return(n.values||[]).find(e=>Me(e,t))!==void 0}function pr(n,t){if(n===t)return 0;const e=zn(n),r=zn(t);if(e!==r)return ut(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return ut(n.booleanValue,t.booleanValue);case 2:return function(o,s){const a=bt(o.integerValue||o.doubleValue),u=bt(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,t);case 3:return Il(n.timestampValue,t.timestampValue);case 4:return Il(di(n),di(t));case 5:return ut(n.stringValue,t.stringValue);case 6:return function(o,s){const a=Wn(o),u=Wn(s);return a.compareTo(u)}(n.bytesValue,t.bytesValue);case 7:return function(o,s){const a=o.split("/"),u=s.split("/");for(let c=0;c<a.length&&c<u.length;c++){const h=ut(a[c],u[c]);if(h!==0)return h}return ut(a.length,u.length)}(n.referenceValue,t.referenceValue);case 8:return function(o,s){const a=ut(bt(o.latitude),bt(s.latitude));return a!==0?a:ut(bt(o.longitude),bt(s.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return Al(n.arrayValue,t.arrayValue);case 10:return function(o,s){var a,u,c,h;const d=o.fields||{},f=s.fields||{},g=(a=d.value)===null||a===void 0?void 0:a.arrayValue,_=(u=f.value)===null||u===void 0?void 0:u.arrayValue,v=ut(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return v!==0?v:Al(g,_)}(n.mapValue,t.mapValue);case 11:return function(o,s){if(o===Ji.mapValue&&s===Ji.mapValue)return 0;if(o===Ji.mapValue)return 1;if(s===Ji.mapValue)return-1;const a=o.fields||{},u=Object.keys(a),c=s.fields||{},h=Object.keys(c);u.sort(),h.sort();for(let d=0;d<u.length&&d<h.length;++d){const f=ut(u[d],h[d]);if(f!==0)return f;const g=pr(a[u[d]],c[h[d]]);if(g!==0)return g}return ut(u.length,h.length)}(n.mapValue,t.mapValue);default:throw J()}}function Il(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return ut(n,t);const e=vn(n),r=vn(t),i=ut(e.seconds,r.seconds);return i!==0?i:ut(e.nanos,r.nanos)}function Al(n,t){const e=n.values||[],r=t.values||[];for(let i=0;i<e.length&&i<r.length;++i){const o=pr(e[i],r[i]);if(o)return o}return ut(e.length,r.length)}function gr(n){return _a(n)}function _a(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const r=vn(e);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return Wn(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return K.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let r="[",i=!0;for(const o of e.values||[])i?i=!1:r+=",",r+=_a(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(e){const r=Object.keys(e.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${_a(e.fields[s])}`;return i+"}"}(n.mapValue):J()}function ya(n){return!!n&&"integerValue"in n}function ou(n){return!!n&&"arrayValue"in n}function Tl(n){return!!n&&"nullValue"in n}function Cl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _o(n){return!!n&&"mapValue"in n}function vm(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="__vector__"}function ni(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return $n(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=ni(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ni(n.arrayValue.values[e]);return t}return Object.assign({},n)}function Em(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(t){this.value=t}static empty(){return new he({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!_o(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ni(e)}setAll(t){let e=Ht.emptyPath(),r={},i=[];t.forEach((s,a)=>{if(!e.isImmediateParentOf(a)){const u=this.getFieldsMap(e);this.applyChanges(u,r,i),r={},i=[],e=a.popLast()}s?r[a.lastSegment()]=ni(s):i.push(a.lastSegment())});const o=this.getFieldsMap(e);this.applyChanges(o,r,i)}delete(t){const e=this.field(t.popLast());_o(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Me(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=e.mapValue.fields[t.get(r)];_o(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,r){$n(e,(i,o)=>t[i]=o);for(const i of r)delete t[i]}clone(){return new he(ni(this.value))}}function kd(n){const t=[];return $n(n.fields,(e,r)=>{const i=new Ht([e]);if(_o(r)){const o=kd(r.mapValue).fields;if(o.length===0)t.push(i);else for(const s of o)t.push(i.child(s))}else t.push(i)}),new _e(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(t,e,r,i,o,s,a){this.key=t,this.documentType=e,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(t){return new te(t,0,tt.min(),tt.min(),tt.min(),he.empty(),0)}static newFoundDocument(t,e,r,i){return new te(t,1,e,tt.min(),r,i,0)}static newNoDocument(t,e){return new te(t,2,e,tt.min(),tt.min(),he.empty(),0)}static newUnknownDocument(t,e){return new te(t,3,e,tt.min(),tt.min(),he.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=he.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=he.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof te&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new te(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(t,e){this.position=t,this.inclusive=e}}function Sl(n,t,e){let r=0;for(let i=0;i<n.position.length;i++){const o=t[i],s=n.position[i];if(o.field.isKeyField()?r=K.comparator(K.fromName(s.referenceValue),e.key):r=pr(s,e.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function bl(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Me(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(t,e="asc"){this.field=t,this.dir=e}}function Im(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{}class Dt extends Ld{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,r):new Tm(t,e,r):e==="array-contains"?new bm(t,r):e==="in"?new Rm(t,r):e==="not-in"?new Nm(t,r):e==="array-contains-any"?new Om(t,r):new Dt(t,e,r)}static createKeyFieldInFilter(t,e,r){return e==="in"?new Cm(t,r):new Sm(t,r)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(pr(e,this.value)):e!==null&&zn(this.value)===zn(e)&&this.matchesComparison(pr(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return J()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ke extends Ld{constructor(t,e){super(),this.filters=t,this.op=e,this.ae=null}static create(t,e){return new ke(t,e)}matches(t){return Vd(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Vd(n){return n.op==="and"}function Bd(n){return Am(n)&&Vd(n)}function Am(n){for(const t of n.filters)if(t instanceof ke)return!1;return!0}function wa(n){if(n instanceof Dt)return n.field.canonicalString()+n.op.toString()+gr(n.value);if(Bd(n))return n.filters.map(t=>wa(t)).join(",");{const t=n.filters.map(e=>wa(e)).join(",");return`${n.op}(${t})`}}function Fd(n,t){return n instanceof Dt?function(r,i){return i instanceof Dt&&r.op===i.op&&r.field.isEqual(i.field)&&Me(r.value,i.value)}(n,t):n instanceof ke?function(r,i){return i instanceof ke&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&Fd(s,i.filters[a]),!0):!1}(n,t):void J()}function Ud(n){return n instanceof Dt?function(e){return`${e.field.canonicalString()} ${e.op} ${gr(e.value)}`}(n):n instanceof ke?function(e){return e.op.toString()+" {"+e.getFilters().map(Ud).join(" ,")+"}"}(n):"Filter"}class Tm extends Dt{constructor(t,e,r){super(t,e,r),this.key=K.fromName(r.referenceValue)}matches(t){const e=K.comparator(t.key,this.key);return this.matchesComparison(e)}}class Cm extends Dt{constructor(t,e){super(t,"in",e),this.keys=jd("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Sm extends Dt{constructor(t,e){super(t,"not-in",e),this.keys=jd("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function jd(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(r=>K.fromName(r.referenceValue))}class bm extends Dt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ou(e)&&pi(e.arrayValue,this.value)}}class Rm extends Dt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&pi(this.value.arrayValue,e)}}class Nm extends Dt{constructor(t,e){super(t,"not-in",e)}matches(t){if(pi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&!pi(this.value.arrayValue,e)}}class Om extends Dt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ou(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>pi(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(t,e=null,r=[],i=[],o=null,s=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}}function Rl(n,t=null,e=[],r=[],i=null,o=null,s=null){return new Pm(n,t,e,r,i,o,s)}function su(n){const t=et(n);if(t.ue===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>wa(r)).join(","),e+="|ob:",e+=t.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Jo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>gr(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>gr(r)).join(",")),t.ue=e}return t.ue}function au(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!Im(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Fd(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!bl(n.startAt,t.startAt)&&bl(n.endAt,t.endAt)}function va(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(t,e=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Dm(n,t,e,r,i,o,s,a){return new ts(n,t,e,r,i,o,s,a)}function uu(n){return new ts(n)}function Nl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function xm(n){return n.collectionGroup!==null}function ri(n){const t=et(n);if(t.ce===null){t.ce=[];const e=new Set;for(const o of t.explicitOrderBy)t.ce.push(o),e.add(o.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Xt(Ht.comparator);return s.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(o=>{e.has(o.canonicalString())||o.isKeyField()||t.ce.push(new ko(o,r))}),e.has(Ht.keyField().canonicalString())||t.ce.push(new ko(Ht.keyField(),r))}return t.ce}function Oe(n){const t=et(n);return t.le||(t.le=Mm(t,ri(n))),t.le}function Mm(n,t){if(n.limitType==="F")return Rl(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new ko(i.field,o)});const e=n.endAt?new Mo(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Mo(n.startAt.position,n.startAt.inclusive):null;return Rl(n.path,n.collectionGroup,t,n.filters,n.limit,e,r)}}function Ea(n,t,e){return new ts(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function es(n,t){return au(Oe(n),Oe(t))&&n.limitType===t.limitType}function Hd(n){return`${su(Oe(n))}|lt:${n.limitType}`}function tr(n){return`Query(target=${function(e){let r=e.path.canonicalString();return e.collectionGroup!==null&&(r+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(r+=`, filters: [${e.filters.map(i=>Ud(i)).join(", ")}]`),Jo(e.limit)||(r+=", limit: "+e.limit),e.orderBy.length>0&&(r+=`, orderBy: [${e.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),e.startAt&&(r+=", startAt: ",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(i=>gr(i)).join(",")),e.endAt&&(r+=", endAt: ",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(i=>gr(i)).join(",")),`Target(${r})`}(Oe(n))}; limitType=${n.limitType})`}function ns(n,t){return t.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):K.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,t)&&function(r,i){for(const o of ri(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,t)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(n,t)&&function(r,i){return!(r.startAt&&!function(s,a,u){const c=Sl(s,a,u);return s.inclusive?c<=0:c<0}(r.startAt,ri(r),i)||r.endAt&&!function(s,a,u){const c=Sl(s,a,u);return s.inclusive?c>=0:c>0}(r.endAt,ri(r),i))}(n,t)}function km(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Gd(n){return(t,e)=>{let r=!1;for(const i of ri(n)){const o=Lm(i,t,e);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Lm(n,t,e){const r=n.field.isKeyField()?K.comparator(t.key,e.key):function(o,s,a){const u=s.data.field(o),c=a.data.field(o);return u!==null&&c!==null?pr(u,c):J()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return J()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,e]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return void(i[o]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[e]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){$n(this.inner,(e,r)=>{for(const[i,o]of r)t(i,o)})}isEmpty(){return xd(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=new vt(K.comparator);function Ke(){return Vm}const Wd=new vt(K.comparator);function Kr(...n){let t=Wd;for(const e of n)t=t.insert(e.key,e);return t}function zd(n){let t=Wd;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function Ln(){return ii()}function Xd(){return ii()}function ii(){return new Ar(n=>n.toString(),(n,t)=>n.isEqual(t))}const Bm=new vt(K.comparator),Fm=new Xt(K.comparator);function nt(...n){let t=Fm;for(const e of n)t=t.add(e);return t}const Um=new Xt(ut);function jm(){return Um}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xo(t)?"-0":t}}function qd(n){return{integerValue:""+n}}function Hm(n,t){return _m(t)?qd(t):cu(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(){this._=void 0}}function Gm(n,t,e){return n instanceof Lo?function(i,o){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&ru(o)&&(o=iu(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(e,t):n instanceof gi?Kd(n,t):n instanceof mi?Yd(n,t):function(i,o){const s=$d(i,o),a=Ol(s)+Ol(i.Pe);return ya(s)&&ya(i.Pe)?qd(a):cu(i.serializer,a)}(n,t)}function Wm(n,t,e){return n instanceof gi?Kd(n,t):n instanceof mi?Yd(n,t):e}function $d(n,t){return n instanceof Vo?function(r){return ya(r)||function(o){return!!o&&"doubleValue"in o}(r)}(t)?t:{integerValue:0}:null}class Lo extends rs{}class gi extends rs{constructor(t){super(),this.elements=t}}function Kd(n,t){const e=Qd(t);for(const r of n.elements)e.some(i=>Me(i,r))||e.push(r);return{arrayValue:{values:e}}}class mi extends rs{constructor(t){super(),this.elements=t}}function Yd(n,t){let e=Qd(t);for(const r of n.elements)e=e.filter(i=>!Me(i,r));return{arrayValue:{values:e}}}class Vo extends rs{constructor(t,e){super(),this.serializer=t,this.Pe=e}}function Ol(n){return bt(n.integerValue||n.doubleValue)}function Qd(n){return ou(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function zm(n,t){return n.field.isEqual(t.field)&&function(r,i){return r instanceof gi&&i instanceof gi||r instanceof mi&&i instanceof mi?fr(r.elements,i.elements,Me):r instanceof Vo&&i instanceof Vo?Me(r.Pe,i.Pe):r instanceof Lo&&i instanceof Lo}(n.transform,t.transform)}class Xm{constructor(t,e){this.version=t,this.transformResults=e}}class Pe{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Pe}static exists(t){return new Pe(void 0,t)}static updateTime(t){return new Pe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function yo(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class is{}function Zd(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new tf(n.key,Pe.none()):new Ai(n.key,n.data,Pe.none());{const e=n.data,r=he.empty();let i=new Xt(Ht.comparator);for(let o of t.fields)if(!i.has(o)){let s=e.field(o);s===null&&o.length>1&&(o=o.popLast(),s=e.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new In(n.key,r,new _e(i.toArray()),Pe.none())}}function qm(n,t,e){n instanceof Ai?function(i,o,s){const a=i.value.clone(),u=Dl(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,t,e):n instanceof In?function(i,o,s){if(!yo(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=Dl(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(Jd(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,t,e):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,t,e)}function oi(n,t,e,r){return n instanceof Ai?function(o,s,a,u){if(!yo(o.precondition,s))return a;const c=o.value.clone(),h=xl(o.fieldTransforms,u,s);return c.setAll(h),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(n,t,e,r):n instanceof In?function(o,s,a,u){if(!yo(o.precondition,s))return a;const c=xl(o.fieldTransforms,u,s),h=s.data;return h.setAll(Jd(o)),h.setAll(c),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(d=>d.field))}(n,t,e,r):function(o,s,a){return yo(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,t,e)}function $m(n,t){let e=null;for(const r of n.fieldTransforms){const i=t.data.field(r.field),o=$d(r.transform,i||null);o!=null&&(e===null&&(e=he.empty()),e.set(r.field,o))}return e||null}function Pl(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&fr(r,i,(o,s)=>zm(o,s))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Ai extends is{constructor(t,e,r,i=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class In extends is{constructor(t,e,r,i,o=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Jd(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function Dl(n,t,e){const r=new Map;gt(n.length===e.length);for(let i=0;i<e.length;i++){const o=n[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,Wm(s,a,e[i]))}return r}function xl(n,t,e){const r=new Map;for(const i of n){const o=i.transform,s=e.data.field(i.field);r.set(i.field,Gm(o,s,t))}return r}class tf extends is{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Km extends is{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(t,e,r,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(t.key)&&qm(o,t,r[i])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=oi(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=oi(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=Xd();return this.mutations.forEach(i=>{const o=t.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=e.has(i.key)?null:a;const u=Zd(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(tt.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),nt())}isEqual(t){return this.batchId===t.batchId&&fr(this.mutations,t.mutations,(e,r)=>Pl(e,r))&&fr(this.baseMutations,t.baseMutations,(e,r)=>Pl(e,r))}}class lu{constructor(t,e,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=i}static from(t,e,r){gt(t.mutations.length===r.length);let i=function(){return Bm}();const o=t.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new lu(t,e,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,it;function Jm(n){switch(n){default:return J();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function ef(n){if(n===void 0)return $e("GRPC error has no .code"),U.UNKNOWN;switch(n){case Rt.OK:return U.OK;case Rt.CANCELLED:return U.CANCELLED;case Rt.UNKNOWN:return U.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return U.INTERNAL;case Rt.UNAVAILABLE:return U.UNAVAILABLE;case Rt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Rt.NOT_FOUND:return U.NOT_FOUND;case Rt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Rt.ABORTED:return U.ABORTED;case Rt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Rt.DATA_LOSS:return U.DATA_LOSS;default:return J()}}(it=Rt||(Rt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Fn([4294967295,4294967295],0);function Ml(n){const t=t_().encode(n),e=new Td;return e.update(t),new Uint8Array(e.digest())}function kl(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Fn([e,r],0),new Fn([i,o],0)]}class hu{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new Yr(`Invalid padding: ${e}`);if(r<0)throw new Yr(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Yr(`Invalid hash count: ${r}`);if(t.length===0&&e!==0)throw new Yr(`Invalid padding when bitmap length is 0: ${e}`);this.Ie=8*t.length-e,this.Te=Fn.fromNumber(this.Ie)}Ee(t,e,r){let i=t.add(e.multiply(Fn.fromNumber(r)));return i.compare(e_)===1&&(i=new Fn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const e=Ml(t),[r,i]=kl(e);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(t,e,r){const i=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),s=new hu(o,i,e);return r.forEach(a=>s.insert(a)),s}insert(t){if(this.Ie===0)return;const e=Ml(t),[r,i]=kl(e);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);this.Ae(s)}}Ae(t){const e=Math.floor(t/8),r=t%8;this.bitmap[e]|=1<<r}}class Yr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(t,e,r,i,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const i=new Map;return i.set(t,Ti.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new os(tt.min(),i,new vt(ut),Ke(),nt())}}class Ti{constructor(t,e,r,i,o){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Ti(r,e,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(t,e,r,i){this.Re=t,this.removedTargetIds=e,this.key=r,this.Ve=i}}class nf{constructor(t,e){this.targetId=t,this.me=e}}class rf{constructor(t,e,r=qt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=i}}class Ll{constructor(){this.fe=0,this.ge=Bl(),this.pe=qt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=nt(),e=nt(),r=nt();return this.ge.forEach((i,o)=>{switch(o){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:r=r.add(i);break;default:J()}}),new Ti(this.pe,this.ye,t,e,r)}Ce(){this.we=!1,this.ge=Bl()}Fe(t,e){this.we=!0,this.ge=this.ge.insert(t,e)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,gt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class n_{constructor(t){this.Le=t,this.Be=new Map,this.ke=Ke(),this.qe=Vl(),this.Qe=new vt(ut)}Ke(t){for(const e of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(e,t.Ve):this.Ue(e,t.key,t.Ve);for(const e of t.removedTargetIds)this.Ue(e,t.key,t.Ve)}We(t){this.forEachTarget(t,e=>{const r=this.Ge(e);switch(t.state){case 0:this.ze(e)&&r.De(t.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(t.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(e);break;case 3:this.ze(e)&&(r.Ne(),r.De(t.resumeToken));break;case 4:this.ze(e)&&(this.je(e),r.De(t.resumeToken));break;default:J()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Be.forEach((r,i)=>{this.ze(i)&&e(i)})}He(t){const e=t.targetId,r=t.me.count,i=this.Je(e);if(i){const o=i.target;if(va(o))if(r===0){const s=new K(o.path);this.Ue(e,s,te.newNoDocument(s,tt.min()))}else gt(r===1);else{const s=this.Ye(e);if(s!==r){const a=this.Ze(t),u=a?this.Xe(a,t,s):1;if(u!==0){this.je(e);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(e,c)}}}}}Ze(t){const e=t.me.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=e;let s,a;try{s=Wn(r).toUint8Array()}catch(u){if(u instanceof Md)return dr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new hu(s,i,o)}catch(u){return dr(u instanceof Yr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(t,e,r){return e.me.count===r-this.nt(t,e.targetId)?0:2}nt(t,e){const r=this.Le.getRemoteKeysForTarget(e);let i=0;return r.forEach(o=>{const s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;t.mightContain(a)||(this.Ue(e,o,null),i++)}),i}rt(t){const e=new Map;this.Be.forEach((o,s)=>{const a=this.Je(s);if(a){if(o.current&&va(a.target)){const u=new K(a.target.path);this.ke.get(u)!==null||this.it(s,u)||this.Ue(s,u,te.newNoDocument(u,t))}o.be&&(e.set(s,o.ve()),o.Ce())}});let r=nt();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(t));const i=new os(t,e,this.Qe,this.ke,r);return this.ke=Ke(),this.qe=Vl(),this.Qe=new vt(ut),i}$e(t,e){if(!this.ze(t))return;const r=this.it(t,e.key)?2:0;this.Ge(t).Fe(e.key,r),this.ke=this.ke.insert(e.key,e),this.qe=this.qe.insert(e.key,this.st(e.key).add(t))}Ue(t,e,r){if(!this.ze(t))return;const i=this.Ge(t);this.it(t,e)?i.Fe(e,1):i.Me(e),this.qe=this.qe.insert(e,this.st(e).delete(t)),r&&(this.ke=this.ke.insert(e,r))}removeTarget(t){this.Be.delete(t)}Ye(t){const e=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let e=this.Be.get(t);return e||(e=new Ll,this.Be.set(t,e)),e}st(t){let e=this.qe.get(t);return e||(e=new Xt(ut),this.qe=this.qe.insert(t,e)),e}ze(t){const e=this.Je(t)!==null;return e||z("WatchChangeAggregator","Detected inactive target",t),e}Je(t){const e=this.Be.get(t);return e&&e.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new Ll),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.Ue(t,e,null)})}it(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function Vl(){return new vt(K.comparator)}function Bl(){return new vt(K.comparator)}const r_={asc:"ASCENDING",desc:"DESCENDING"},i_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},o_={and:"AND",or:"OR"};class s_{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Ia(n,t){return n.useProto3Json||Jo(t)?t:{value:t}}function Bo(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function of(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function a_(n,t){return Bo(n,t.toTimestamp())}function De(n){return gt(!!n),tt.fromTimestamp(function(e){const r=vn(e);return new Mt(r.seconds,r.nanos)}(n))}function du(n,t){return Aa(n,t).canonicalString()}function Aa(n,t){const e=function(i){return new yt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return t===void 0?e:e.child(t)}function sf(n){const t=yt.fromString(n);return gt(hf(t)),t}function Ta(n,t){return du(n.databaseId,t.path)}function $s(n,t){const e=sf(t);if(e.get(1)!==n.databaseId.projectId)throw new q(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new q(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new K(uf(e))}function af(n,t){return du(n.databaseId,t)}function u_(n){const t=sf(n);return t.length===4?yt.emptyPath():uf(t)}function Ca(n){return new yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function uf(n){return gt(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Fl(n,t,e){return{name:Ta(n,t),fields:e.value.mapValue.fields}}function c_(n,t){let e;if("targetChange"in t){t.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:J()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(c,h){return c.useProto3Json?(gt(h===void 0||typeof h=="string"),qt.fromBase64String(h||"")):(gt(h===void 0||h instanceof Buffer||h instanceof Uint8Array),qt.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(c){const h=c.code===void 0?U.UNKNOWN:ef(c.code);return new q(h,c.message||"")}(s);e=new rf(r,i,o,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=$s(n,r.document.name),o=De(r.document.updateTime),s=r.document.createTime?De(r.document.createTime):tt.min(),a=new he({mapValue:{fields:r.document.fields}}),u=te.newFoundDocument(i,o,s,a),c=r.targetIds||[],h=r.removedTargetIds||[];e=new wo(c,h,u.key,u)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=$s(n,r.document),o=r.readTime?De(r.readTime):tt.min(),s=te.newNoDocument(i,o),a=r.removedTargetIds||[];e=new wo([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=$s(n,r.document),o=r.removedTargetIds||[];e=new wo([],o,i,null)}else{if(!("filter"in t))return J();{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new Zm(i,o),a=r.targetId;e=new nf(a,s)}}return e}function l_(n,t){let e;if(t instanceof Ai)e={update:Fl(n,t.key,t.value)};else if(t instanceof tf)e={delete:Ta(n,t.key)};else if(t instanceof In)e={update:Fl(n,t.key,t.data),updateMask:w_(t.fieldMask)};else{if(!(t instanceof Km))return J();e={verify:Ta(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(o,s){const a=s.transform;if(a instanceof Lo)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof gi)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof mi)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Vo)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw J()}(0,r))),t.precondition.isNone||(e.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:a_(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:J()}(n,t.precondition)),e}function h_(n,t){return n&&n.length>0?(gt(t!==void 0),n.map(e=>function(i,o){let s=i.updateTime?De(i.updateTime):De(o);return s.isEqual(tt.min())&&(s=De(o)),new Xm(s,i.transformResults||[])}(e,t))):[]}function d_(n,t){return{documents:[af(n,t.path)]}}function f_(n,t){const e={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),e.structuredQuery.from=[{collectionId:r.lastSegment()}]),e.parent=af(n,i);const o=function(c){if(c.length!==0)return lf(ke.create(c,"and"))}(t.filters);o&&(e.structuredQuery.where=o);const s=function(c){if(c.length!==0)return c.map(h=>function(f){return{field:er(f.field),direction:m_(f.dir)}}(h))}(t.orderBy);s&&(e.structuredQuery.orderBy=s);const a=Ia(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{_t:e,parent:i}}function p_(n){let t=u_(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let i=null;if(r>0){gt(r===1);const h=e.from[0];h.allDescendants?i=h.collectionId:t=t.child(h.collectionId)}let o=[];e.where&&(o=function(d){const f=cf(d);return f instanceof ke&&Bd(f)?f.getFilters():[f]}(e.where));let s=[];e.orderBy&&(s=function(d){return d.map(f=>function(_){return new ko(nr(_.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(e.orderBy));let a=null;e.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Jo(f)?null:f}(e.limit));let u=null;e.startAt&&(u=function(d){const f=!!d.before,g=d.values||[];return new Mo(g,f)}(e.startAt));let c=null;return e.endAt&&(c=function(d){const f=!d.before,g=d.values||[];return new Mo(g,f)}(e.endAt)),Dm(t,i,s,o,a,"F",u,c)}function g_(n,t){const e=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J()}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function cf(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const r=nr(e.unaryFilter.field);return Dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=nr(e.unaryFilter.field);return Dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=nr(e.unaryFilter.field);return Dt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=nr(e.unaryFilter.field);return Dt.create(s,"!=",{nullValue:"NULL_VALUE"});default:return J()}}(n):n.fieldFilter!==void 0?function(e){return Dt.create(nr(e.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return J()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return ke.create(e.compositeFilter.filters.map(r=>cf(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return J()}}(e.compositeFilter.op))}(n):J()}function m_(n){return r_[n]}function __(n){return i_[n]}function y_(n){return o_[n]}function er(n){return{fieldPath:n.canonicalString()}}function nr(n){return Ht.fromServerFormat(n.fieldPath)}function lf(n){return n instanceof Dt?function(e){if(e.op==="=="){if(Cl(e.value))return{unaryFilter:{field:er(e.field),op:"IS_NAN"}};if(Tl(e.value))return{unaryFilter:{field:er(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Cl(e.value))return{unaryFilter:{field:er(e.field),op:"IS_NOT_NAN"}};if(Tl(e.value))return{unaryFilter:{field:er(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:er(e.field),op:__(e.op),value:e.value}}}(n):n instanceof ke?function(e){const r=e.getFilters().map(i=>lf(i));return r.length===1?r[0]:{compositeFilter:{op:y_(e.op),filters:r}}}(n):J()}function w_(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function hf(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(t,e,r,i,o=tt.min(),s=tt.min(),a=qt.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(t){return new ln(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(t){this.ct=t}}function E_(n){const t=p_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ea(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(){this.un=new A_}addToCollectionParentIndex(t,e){return this.un.add(e),j.resolve()}getCollectionParents(t,e){return j.resolve(this.un.getEntries(e))}addFieldIndex(t,e){return j.resolve()}deleteFieldIndex(t,e){return j.resolve()}deleteAllFieldIndexes(t){return j.resolve()}createTargetIndexes(t,e){return j.resolve()}getDocumentsMatchingTarget(t,e){return j.resolve(null)}getIndexType(t,e){return j.resolve(0)}getFieldIndexes(t,e){return j.resolve([])}getNextCollectionGroupToUpdate(t){return j.resolve(null)}getMinOffset(t,e){return j.resolve(wn.min())}getMinOffsetFromCollectionGroup(t,e){return j.resolve(wn.min())}updateCollectionGroup(t,e,r){return j.resolve()}updateIndexEntries(t,e){return j.resolve()}}class A_{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e]||new Xt(yt.comparator),o=!i.has(r);return this.index[e]=i.add(r),o}has(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e];return i&&i.has(r)}getEntries(t){return(this.index[t]||new Xt(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new mr(0)}static kn(){return new mr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(){this.changes=new Ar(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,te.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return r!==void 0?j.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(t,e,r,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(i=>(r=i,this.remoteDocumentCache.getEntry(t,e))).next(i=>(r!==null&&oi(r.mutation,i,_e.empty(),Mt.now()),i))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,nt()).next(()=>r))}getLocalViewOfDocuments(t,e,r=nt()){const i=Ln();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,r).next(o=>{let s=Kr();return o.forEach((a,u)=>{s=s.insert(a,u.overlayedDocument)}),s}))}getOverlayedDocuments(t,e){const r=Ln();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,nt()))}populateOverlays(t,e,r){const i=[];return r.forEach(o=>{e.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(t,i).next(o=>{o.forEach((s,a)=>{e.set(s,a)})})}computeViews(t,e,r,i){let o=Ke();const s=ii(),a=function(){return ii()}();return e.forEach((u,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof In)?o=o.insert(c.key,c):h!==void 0?(s.set(c.key,h.mutation.getFieldMask()),oi(h.mutation,c,h.mutation.getFieldMask(),Mt.now())):s.set(c.key,_e.empty())}),this.recalculateAndSaveOverlays(t,o).next(u=>(u.forEach((c,h)=>s.set(c,h)),e.forEach((c,h)=>{var d;return a.set(c,new C_(h,(d=s.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(t,e){const r=ii();let i=new vt((s,a)=>s-a),o=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(s=>{for(const a of s)a.keys().forEach(u=>{const c=e.get(u);if(c===null)return;let h=r.get(u)||_e.empty();h=a.applyToLocalView(c,h),r.set(u,h);const d=(i.get(a.batchId)||nt()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,h=u.value,d=Xd();h.forEach(f=>{if(!o.has(f)){const g=Zd(e.get(f),r.get(f));g!==null&&d.set(f,g),o=o.add(f)}}),s.push(this.documentOverlayCache.saveOverlays(t,c,d))}return j.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r,i){return function(s){return K.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):xm(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r,i):this.getDocumentsMatchingCollectionQuery(t,e,r,i)}getNextDocuments(t,e,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,i-o.size):j.resolve(Ln());let a=-1,u=o;return s.next(c=>j.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),o.get(h)?j.resolve():this.remoteDocumentCache.getEntry(t,h).next(f=>{u=u.insert(h,f)}))).next(()=>this.populateOverlays(t,c,o)).next(()=>this.computeViews(t,u,c,nt())).next(h=>({batchId:a,changes:zd(h)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new K(e)).next(r=>{let i=Kr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(t,e,r,i){const o=e.collectionGroup;let s=Kr();return this.indexManager.getCollectionParents(t,o).next(a=>j.forEach(a,u=>{const c=function(d,f){return new ts(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e,u.child(o));return this.getDocumentsMatchingCollectionQuery(t,c,r,i).next(h=>{h.forEach((d,f)=>{s=s.insert(d,f)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(t,e,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,o,i))).next(s=>{o.forEach((u,c)=>{const h=c.getKey();s.get(h)===null&&(s=s.insert(h,te.newInvalidDocument(h)))});let a=Kr();return s.forEach((u,c)=>{const h=o.get(u);h!==void 0&&oi(h.mutation,c,_e.empty(),Mt.now()),ns(e,c)&&(a=a.insert(u,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,e){return j.resolve(this.hr.get(e))}saveBundleMetadata(t,e){return this.hr.set(e.id,function(i){return{id:i.id,version:i.version,createTime:De(i.createTime)}}(e)),j.resolve()}getNamedQuery(t,e){return j.resolve(this.Pr.get(e))}saveNamedQuery(t,e){return this.Pr.set(e.name,function(i){return{name:i.name,query:E_(i.bundledQuery),readTime:De(i.readTime)}}(e)),j.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.overlays=new vt(K.comparator),this.Ir=new Map}getOverlay(t,e){return j.resolve(this.overlays.get(e))}getOverlays(t,e){const r=Ln();return j.forEach(e,i=>this.getOverlay(t,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((i,o)=>{this.ht(t,e,o)}),j.resolve()}removeOverlaysForBatchId(t,e,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),j.resolve()}getOverlaysForCollection(t,e,r){const i=Ln(),o=e.length+1,s=new K(e.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!e.isPrefixOf(c.path))break;c.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return j.resolve(i)}getOverlaysForCollectionGroup(t,e,r,i){let o=new vt((c,h)=>c-h);const s=this.overlays.getIterator();for(;s.hasNext();){const c=s.getNext().value;if(c.getKey().getCollectionGroup()===e&&c.largestBatchId>r){let h=o.get(c.largestBatchId);h===null&&(h=Ln(),o=o.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Ln(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return j.resolve(a)}ht(t,e,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Qm(e,r));let o=this.Ir.get(e);o===void 0&&(o=nt(),this.Ir.set(e,o)),this.Ir.set(e,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.sessionToken=qt.EMPTY_BYTE_STRING}getSessionToken(t){return j.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,j.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(){this.Tr=new Xt(Bt.Er),this.dr=new Xt(Bt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,e){const r=new Bt(t,e);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.Vr(new Bt(t,e))}mr(t,e){t.forEach(r=>this.removeReference(r,e))}gr(t){const e=new K(new yt([])),r=new Bt(e,t),i=new Bt(e,t+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const e=new K(new yt([])),r=new Bt(e,t),i=new Bt(e,t+1);let o=nt();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(t){const e=new Bt(t,0),r=this.Tr.firstAfterOrEqual(e);return r!==null&&t.isEqual(r.key)}}class Bt{constructor(t,e){this.key=t,this.wr=e}static Er(t,e){return K.comparator(t.key,e.key)||ut(t.wr,e.wr)}static Ar(t,e){return ut(t.wr,e.wr)||K.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Sr=1,this.br=new Xt(Bt.Er)}checkEmpty(t){return j.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Ym(o,e,r,i);this.mutationQueue.push(s);for(const a of i)this.br=this.br.add(new Bt(a.key,o)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return j.resolve(s)}lookupMutationBatch(t,e){return j.resolve(this.Dr(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,i=this.vr(r),o=i<0?0:i;return j.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return j.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return j.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new Bt(e,0),i=new Bt(e,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{const a=this.Dr(s.wr);o.push(a)}),j.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new Xt(ut);return e.forEach(i=>{const o=new Bt(i,0),s=new Bt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),j.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,i=r.length+1;let o=r;K.isDocumentKey(o)||(o=o.child(""));const s=new Bt(new K(o),0);let a=new Xt(ut);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.wr)),!0)},s),j.resolve(this.Cr(a))}Cr(t){const e=[];return t.forEach(r=>{const i=this.Dr(r);i!==null&&e.push(i)}),e}removeMutationBatch(t,e){gt(this.Fr(e.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return j.forEach(e.mutations,i=>{const o=new Bt(i.key,e.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.br=r})}On(t){}containsKey(t,e){const r=new Bt(e,0),i=this.br.firstAfterOrEqual(r);return j.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,j.resolve()}Fr(t,e){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const e=this.vr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(t){this.Mr=t,this.docs=function(){return new vt(K.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return j.resolve(r?r.document.mutableCopy():te.newInvalidDocument(e))}getEntries(t,e){let r=Ke();return e.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():te.newInvalidDocument(i))}),j.resolve(r)}getDocumentsMatchingQuery(t,e,r,i){let o=Ke();const s=e.path,a=new K(s.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:h}}=u.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||fm(dm(h),r)<=0||(i.has(h.key)||ns(e,h))&&(o=o.insert(h.key,h.mutableCopy()))}return j.resolve(o)}getAllFromCollectionGroup(t,e,r,i){J()}Or(t,e){return j.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new D_(this)}getSize(t){return j.resolve(this.size)}}class D_ extends T_{constructor(t){super(),this.cr=t}applyChanges(t){const e=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?e.push(this.cr.addEntry(t,i)):this.cr.removeEntry(r)}),j.waitFor(e)}getFromCache(t,e){return this.cr.getEntry(t,e)}getAllFromCache(t,e){return this.cr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(t){this.persistence=t,this.Nr=new Ar(e=>su(e),au),this.lastRemoteSnapshotVersion=tt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new fu,this.targetCount=0,this.kr=mr.Bn()}forEachTarget(t,e){return this.Nr.forEach((r,i)=>e(i)),j.resolve()}getLastRemoteSnapshotVersion(t){return j.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return j.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),j.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.Lr&&(this.Lr=e),j.resolve()}Kn(t){this.Nr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.kr=new mr(e),this.highestTargetId=e),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,e){return this.Kn(e),this.targetCount+=1,j.resolve()}updateTargetData(t,e){return this.Kn(e),j.resolve()}removeTargetData(t,e){return this.Nr.delete(e.target),this.Br.gr(e.targetId),this.targetCount-=1,j.resolve()}removeTargets(t,e,r){let i=0;const o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=e&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),j.waitFor(o).next(()=>i)}getTargetCount(t){return j.resolve(this.targetCount)}getTargetData(t,e){const r=this.Nr.get(e)||null;return j.resolve(r)}addMatchingKeys(t,e,r){return this.Br.Rr(e,r),j.resolve()}removeMatchingKeys(t,e,r){this.Br.mr(e,r);const i=this.persistence.referenceDelegate,o=[];return i&&e.forEach(s=>{o.push(i.markPotentiallyOrphaned(t,s))}),j.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this.Br.gr(e),j.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Br.yr(e);return j.resolve(r)}containsKey(t,e){return j.resolve(this.Br.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(t,e){this.qr={},this.overlays={},this.Qr=new nu(0),this.Kr=!1,this.Kr=!0,this.$r=new N_,this.referenceDelegate=t(this),this.Ur=new x_(this),this.indexManager=new I_,this.remoteDocumentCache=function(i){return new P_(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new v_(e),this.Gr=new b_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new R_,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.qr[t.toKey()];return r||(r=new O_(e,this.referenceDelegate),this.qr[t.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,e,r){z("MemoryPersistence","Starting transaction:",t);const i=new k_(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(t,e){return j.or(Object.values(this.qr).map(r=>()=>r.containsKey(t,e)))}}class k_ extends gm{constructor(t){super(),this.currentSequenceNumber=t}}class pu{constructor(t){this.persistence=t,this.Jr=new fu,this.Yr=null}static Zr(t){return new pu(t)}get Xr(){if(this.Yr)return this.Yr;throw J()}addReference(t,e,r){return this.Jr.addReference(r,e),this.Xr.delete(r.toString()),j.resolve()}removeReference(t,e,r){return this.Jr.removeReference(r,e),this.Xr.add(r.toString()),j.resolve()}markPotentiallyOrphaned(t,e){return this.Xr.add(e.toString()),j.resolve()}removeTarget(t,e){this.Jr.gr(e.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(t,e))}zr(){this.Yr=new Set}jr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return j.forEach(this.Xr,r=>{const i=K.fromPath(r);return this.ei(t,i).next(o=>{o||e.removeEntry(i,tt.min())})}).next(()=>(this.Yr=null,e.apply(t)))}updateLimboDocument(t,e){return this.ei(t,e).next(r=>{r?this.Xr.delete(e.toString()):this.Xr.add(e.toString())})}Wr(t){return 0}ei(t,e){return j.or([()=>j.resolve(this.Jr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Hr(t,e)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(t,e,r,i){this.targetId=t,this.fromCache=e,this.$i=r,this.Ui=i}static Wi(t,e){let r=nt(),i=nt();for(const o of e.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new gu(t,e.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Up()?8:mm(ee())>0?6:4}()}initialize(t,e){this.Ji=t,this.indexManager=e,this.Gi=!0}getDocumentsMatchingQuery(t,e,r,i){const o={result:null};return this.Yi(t,e).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(t,e,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new L_;return this.Xi(t,e,s).next(a=>{if(o.result=a,this.zi)return this.es(t,e,s,a.size)})}).next(()=>o.result)}es(t,e,r,i){return r.documentReadCount<this.ji?(Gr()<=rt.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",tr(e),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),j.resolve()):(Gr()<=rt.DEBUG&&z("QueryEngine","Query:",tr(e),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Gr()<=rt.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",tr(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Oe(e))):j.resolve())}Yi(t,e){if(Nl(e))return j.resolve(null);let r=Oe(e);return this.indexManager.getIndexType(t,r).next(i=>i===0?null:(e.limit!==null&&i===1&&(e=Ea(e,null,"F"),r=Oe(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(o=>{const s=nt(...o);return this.Ji.getDocuments(t,s).next(a=>this.indexManager.getMinOffset(t,r).next(u=>{const c=this.ts(e,a);return this.ns(e,c,s,u.readTime)?this.Yi(t,Ea(e,null,"F")):this.rs(t,c,e,u)}))})))}Zi(t,e,r,i){return Nl(e)||i.isEqual(tt.min())?j.resolve(null):this.Ji.getDocuments(t,r).next(o=>{const s=this.ts(e,o);return this.ns(e,s,r,i)?j.resolve(null):(Gr()<=rt.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tr(e)),this.rs(t,s,e,hm(i,-1)).next(a=>a))})}ts(t,e){let r=new Xt(Gd(t));return e.forEach((i,o)=>{ns(t,o)&&(r=r.add(o))}),r}ns(t,e,r,i){if(t.limit===null)return!1;if(r.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(t,e,r){return Gr()<=rt.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",tr(e)),this.Ji.getDocumentsMatchingQuery(t,e,wn.min(),r)}rs(t,e,r,i){return this.Ji.getDocumentsMatchingQuery(t,r,i).next(o=>(e.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(t,e,r,i){this.persistence=t,this.ss=e,this.serializer=i,this.os=new vt(ut),this._s=new Ar(o=>su(o),au),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(r)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new S_(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.os))}}function F_(n,t,e,r){return new B_(n,t,e,r)}async function df(n,t){const e=et(n);return await e.persistence.runTransaction("Handle user change","readonly",r=>{let i;return e.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,e.ls(t),e.mutationQueue.getAllMutationBatches(r))).next(o=>{const s=[],a=[];let u=nt();for(const c of i){s.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}for(const c of o){a.push(c.batchId);for(const h of c.mutations)u=u.add(h.key)}return e.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:s,addedBatchIds:a}))})})}function U_(n,t){const e=et(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=t.batch.keys(),o=e.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,c,h){const d=c.batch,f=d.keys();let g=j.resolve();return f.forEach(_=>{g=g.next(()=>h.getEntry(u,_)).next(v=>{const I=c.docVersions.get(_);gt(I!==null),v.version.compareTo(I)<0&&(d.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),h.addEntry(v)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(e,r,t,o).next(()=>o.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=nt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(t))).next(()=>e.localDocuments.getDocuments(r,i))})}function ff(n){const t=et(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function j_(n,t){const e=et(n),r=t.snapshotVersion;let i=e.os;return e.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=e.cs.newChangeBuffer({trackRemovals:!0});i=e.os;const a=[];t.targetChanges.forEach((h,d)=>{const f=i.get(d);if(!f)return;a.push(e.Ur.removeMatchingKeys(o,h.removedDocuments,d).next(()=>e.Ur.addMatchingKeys(o,h.addedDocuments,d)));let g=f.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(qt.EMPTY_BYTE_STRING,tt.min()).withLastLimboFreeSnapshotVersion(tt.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),i=i.insert(d,g),function(v,I,T){return v.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(f,g,h)&&a.push(e.Ur.updateTargetData(o,g))});let u=Ke(),c=nt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(H_(o,s,t.documentUpdates).next(h=>{u=h.Ps,c=h.Is})),!r.isEqual(tt.min())){const h=e.Ur.getLastRemoteSnapshotVersion(o).next(d=>e.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return j.waitFor(a).next(()=>s.apply(o)).next(()=>e.localDocuments.getLocalViewOfDocuments(o,u,c)).next(()=>u)}).then(o=>(e.os=i,o))}function H_(n,t,e){let r=nt(),i=nt();return e.forEach(o=>r=r.add(o)),t.getEntries(n,r).next(o=>{let s=Ke();return e.forEach((a,u)=>{const c=o.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(tt.min())?(t.removeEntry(a,u.readTime),s=s.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(u),s=s.insert(a,u)):z("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{Ps:s,Is:i}})}function G_(n,t){const e=et(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function W_(n,t){const e=et(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return e.Ur.getTargetData(r,t).next(o=>o?(i=o,j.resolve(i)):e.Ur.allocateTargetId(r).next(s=>(i=new ln(t,s,"TargetPurposeListen",r.currentSequenceNumber),e.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=e.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.os=e.os.insert(r.targetId,r),e._s.set(t,r.targetId)),r})}async function Sa(n,t,e){const r=et(n),i=r.os.get(t),o=e?"readwrite":"readwrite-primary";try{e||await r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Ii(s))throw s;z("LocalStore",`Failed to update sequence numbers for target ${t}: ${s}`)}r.os=r.os.remove(t),r._s.delete(i.target)}function Ul(n,t,e){const r=et(n);let i=tt.min(),o=nt();return r.persistence.runTransaction("Execute query","readwrite",s=>function(u,c,h){const d=et(u),f=d._s.get(h);return f!==void 0?j.resolve(d.os.get(f)):d.Ur.getTargetData(c,h)}(r,s,Oe(t)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(u=>{o=u})}).next(()=>r.ss.getDocumentsMatchingQuery(s,t,e?i:tt.min(),e?o:nt())).next(a=>(z_(r,km(t),a),{documents:a,Ts:o})))}function z_(n,t,e){let r=n.us.get(t)||tt.min();e.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(t,r)}class jl{constructor(){this.activeTargetIds=jm()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class X_{constructor(){this.so=new jl,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t,e=!0){return e&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,e,r){this.oo[t]=e}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new jl,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let to=null;function Ks(){return to===null?to=function(){return 268435456+Math.round(2147483648*Math.random())}():to++,"0x"+to.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class Y_ extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+e.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(e,r,i,o,s){const a=Ks(),u=this.xo(e,r.toUriEncodedString());z("RestConnection",`Sending RPC '${e}' ${a}:`,u,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,o,s),this.No(e,u,c,i).then(h=>(z("RestConnection",`Received RPC '${e}' ${a}: `,h),h),h=>{throw dr("RestConnection",`RPC '${e}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}Lo(e,r,i,o,s,a){return this.Mo(e,r,i,o,s)}Oo(e,r,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ir}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>e[s]=o),i&&i.headers.forEach((o,s)=>e[s]=o)}xo(e,r){const i=$_[e];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,e,r,i){const o=Ks();return new Promise((s,a)=>{const u=new Cd;u.setWithCredentials(!0),u.listenOnce(bd.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case mo.NO_ERROR:const h=u.getResponseJson();z(Zt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(h)),s(h);break;case mo.TIMEOUT:z(Zt,`RPC '${t}' ${o} timed out`),a(new q(U.DEADLINE_EXCEEDED,"Request time out"));break;case mo.HTTP_ERROR:const d=u.getStatus();if(z(Zt,`RPC '${t}' ${o} failed with status:`,d,"response text:",u.getResponseText()),d>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const g=f==null?void 0:f.error;if(g&&g.status&&g.message){const _=function(I){const T=I.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(T)>=0?T:U.UNKNOWN}(g.status);a(new q(_,g.message))}else a(new q(U.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new q(U.UNAVAILABLE,"Connection failed."));break;default:J()}}finally{z(Zt,`RPC '${t}' ${o} completed.`)}});const c=JSON.stringify(i);z(Zt,`RPC '${t}' ${o} sending request:`,i),u.send(e,"POST",c,r,15)})}Bo(t,e,r){const i=Ks(),o=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Od(),a=Nd(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new Sd({})),this.Oo(u.initMessageHeaders,e,r),u.encodeInitMessageHeaders=!0;const h=o.join("");z(Zt,`Creating RPC '${t}' stream ${i}: ${h}`,u);const d=s.createWebChannel(h,u);let f=!1,g=!1;const _=new K_({Io:I=>{g?z(Zt,`Not sending because RPC '${t}' stream ${i} is closed:`,I):(f||(z(Zt,`Opening RPC '${t}' stream ${i} transport.`),d.open(),f=!0),z(Zt,`RPC '${t}' stream ${i} sending:`,I),d.send(I))},To:()=>d.close()}),v=(I,T,N)=>{I.listen(T,k=>{try{N(k)}catch(P){setTimeout(()=>{throw P},0)}})};return v(d,$r.EventType.OPEN,()=>{g||(z(Zt,`RPC '${t}' stream ${i} transport opened.`),_.yo())}),v(d,$r.EventType.CLOSE,()=>{g||(g=!0,z(Zt,`RPC '${t}' stream ${i} transport closed`),_.So())}),v(d,$r.EventType.ERROR,I=>{g||(g=!0,dr(Zt,`RPC '${t}' stream ${i} transport errored:`,I),_.So(new q(U.UNAVAILABLE,"The operation could not be completed")))}),v(d,$r.EventType.MESSAGE,I=>{var T;if(!g){const N=I.data[0];gt(!!N);const k=N,P=k.error||((T=k[0])===null||T===void 0?void 0:T.error);if(P){z(Zt,`RPC '${t}' stream ${i} received error:`,P);const B=P.status;let F=function(C){const R=Rt[C];if(R!==void 0)return ef(R)}(B),S=P.message;F===void 0&&(F=U.INTERNAL,S="Unknown error status: "+B+" with message "+P.message),g=!0,_.So(new q(F,S)),d.close()}else z(Zt,`RPC '${t}' stream ${i} received:`,N),_.bo(N)}}),v(a,Rd.STAT_EVENT,I=>{I.stat===ma.PROXY?z(Zt,`RPC '${t}' stream ${i} detected buffering proxy`):I.stat===ma.NOPROXY&&z(Zt,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.wo()},0),_}}function Ys(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(n){return new s_(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(t,e,r=1e3,i=1.5,o=6e4){this.ui=t,this.timerId=e,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const e=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,e-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(t,e,r,i,o,s,a,u){this.ui=t,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new pf(t,e)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,e){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():e&&e.code===U.RESOURCE_EXHAUSTED?($e(e.toString()),$e("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):e&&e.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(e)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),e=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===e&&this.P_(r,i)},r=>{t(()=>{const i=new q(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(t,e){const r=this.h_(this.Yo);this.stream=this.T_(t,e),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return z("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return e=>{this.ui.enqueueAndForget(()=>this.Yo===t?e():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Q_ extends gf{constructor(t,e,r,i,o,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,i,s),this.serializer=o}T_(t,e){return this.connection.Bo("Listen",t,e)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const e=c_(this.serializer,t),r=function(o){if(!("targetChange"in o))return tt.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?tt.min():s.readTime?De(s.readTime):tt.min()}(t);return this.listener.d_(e,r)}A_(t){const e={};e.database=Ca(this.serializer),e.addTarget=function(o,s){let a;const u=s.target;if(a=va(u)?{documents:d_(o,u)}:{query:f_(o,u)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=of(o,s.resumeToken);const c=Ia(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(tt.min())>0){a.readTime=Bo(o,s.snapshotVersion.toTimestamp());const c=Ia(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const r=g_(this.serializer,t);r&&(e.labels=r),this.a_(e)}R_(t){const e={};e.database=Ca(this.serializer),e.removeTarget=t,this.a_(e)}}class Z_ extends gf{constructor(t,e,r,i,o,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,e){return this.connection.Bo("Write",t,e)}E_(t){return gt(!!t.streamToken),this.lastStreamToken=t.streamToken,gt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){gt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const e=h_(t.writeResults,t.commitTime),r=De(t.commitTime);return this.listener.g_(r,e)}p_(){const t={};t.database=Ca(this.serializer),this.a_(t)}m_(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>l_(this.serializer,r))};this.a_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_ extends class{}{constructor(t,e,r,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new q(U.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,e,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(t,Aa(e,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(U.UNKNOWN,o.toString())})}Lo(t,e,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(t,Aa(e,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(U.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class ty{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?($e(e),this.D_=!1):z("OnlineStateTracker",e)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(t,e,r,i,o){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(async()=>{Kn(this)&&(z("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=et(u);c.L_.add(4),await Ci(c),c.q_.set("Unknown"),c.L_.delete(4),await as(c)}(this))})}),this.q_=new ty(r,i)}}async function as(n){if(Kn(n))for(const t of n.B_)await t(!0)}async function Ci(n){for(const t of n.B_)await t(!1)}function mf(n,t){const e=et(n);e.N_.has(t.targetId)||(e.N_.set(t.targetId,t),wu(e)?yu(e):Tr(e).r_()&&_u(e,t))}function mu(n,t){const e=et(n),r=Tr(e);e.N_.delete(t),r.r_()&&_f(e,t),e.N_.size===0&&(r.r_()?r.o_():Kn(e)&&e.q_.set("Unknown"))}function _u(n,t){if(n.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(tt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Tr(n).A_(t)}function _f(n,t){n.Q_.xe(t),Tr(n).R_(t)}function yu(n){n.Q_=new n_({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>n.N_.get(t)||null,tt:()=>n.datastore.serializer.databaseId}),Tr(n).start(),n.q_.v_()}function wu(n){return Kn(n)&&!Tr(n).n_()&&n.N_.size>0}function Kn(n){return et(n).L_.size===0}function yf(n){n.Q_=void 0}async function ny(n){n.q_.set("Online")}async function ry(n){n.N_.forEach((t,e)=>{_u(n,t)})}async function iy(n,t){yf(n),wu(n)?(n.q_.M_(t),yu(n)):n.q_.set("Unknown")}async function oy(n,t,e){if(n.q_.set("Online"),t instanceof rf&&t.state===2&&t.cause)try{await async function(i,o){const s=o.cause;for(const a of o.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))}(n,t)}catch(r){z("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Fo(n,r)}else if(t instanceof wo?n.Q_.Ke(t):t instanceof nf?n.Q_.He(t):n.Q_.We(t),!e.isEqual(tt.min()))try{const r=await ff(n.localStore);e.compareTo(r)>=0&&await function(o,s){const a=o.Q_.rt(s);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const h=o.N_.get(c);h&&o.N_.set(c,h.withResumeToken(u.resumeToken,s))}}),a.targetMismatches.forEach((u,c)=>{const h=o.N_.get(u);if(!h)return;o.N_.set(u,h.withResumeToken(qt.EMPTY_BYTE_STRING,h.snapshotVersion)),_f(o,u);const d=new ln(h.target,u,c,h.sequenceNumber);_u(o,d)}),o.remoteSyncer.applyRemoteEvent(a)}(n,e)}catch(r){z("RemoteStore","Failed to raise snapshot:",r),await Fo(n,r)}}async function Fo(n,t,e){if(!Ii(t))throw t;n.L_.add(1),await Ci(n),n.q_.set("Offline"),e||(e=()=>ff(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{z("RemoteStore","Retrying IndexedDB access"),await e(),n.L_.delete(1),await as(n)})}function wf(n,t){return t().catch(e=>Fo(n,e,t))}async function us(n){const t=et(n),e=En(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;sy(t);)try{const i=await G_(t.localStore,r);if(i===null){t.O_.length===0&&e.o_();break}r=i.batchId,ay(t,i)}catch(i){await Fo(t,i)}vf(t)&&Ef(t)}function sy(n){return Kn(n)&&n.O_.length<10}function ay(n,t){n.O_.push(t);const e=En(n);e.r_()&&e.V_&&e.m_(t.mutations)}function vf(n){return Kn(n)&&!En(n).n_()&&n.O_.length>0}function Ef(n){En(n).start()}async function uy(n){En(n).p_()}async function cy(n){const t=En(n);for(const e of n.O_)t.m_(e.mutations)}async function ly(n,t,e){const r=n.O_.shift(),i=lu.from(r,t,e);await wf(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await us(n)}async function hy(n,t){t&&En(n).V_&&await async function(r,i){if(function(s){return Jm(s)&&s!==U.ABORTED}(i.code)){const o=r.O_.shift();En(r).s_(),await wf(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await us(r)}}(n,t),vf(n)&&Ef(n)}async function Gl(n,t){const e=et(n);e.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");const r=Kn(e);e.L_.add(3),await Ci(e),r&&e.q_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.L_.delete(3),await as(e)}async function dy(n,t){const e=et(n);t?(e.L_.delete(2),await as(e)):t||(e.L_.add(2),await Ci(e),e.q_.set("Unknown"))}function Tr(n){return n.K_||(n.K_=function(e,r,i){const o=et(e);return o.w_(),new Q_(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:ny.bind(null,n),Ro:ry.bind(null,n),mo:iy.bind(null,n),d_:oy.bind(null,n)}),n.B_.push(async t=>{t?(n.K_.s_(),wu(n)?yu(n):n.q_.set("Unknown")):(await n.K_.stop(),yf(n))})),n.K_}function En(n){return n.U_||(n.U_=function(e,r,i){const o=et(e);return o.w_(),new Z_(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:uy.bind(null,n),mo:hy.bind(null,n),f_:cy.bind(null,n),g_:ly.bind(null,n)}),n.B_.push(async t=>{t?(n.U_.s_(),await us(n)):(await n.U_.stop(),n.O_.length>0&&(z("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(t,e,r,i,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,r,i,o){const s=Date.now()+r,a=new vu(t,e,s,i,o);return a.start(r),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(U.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Eu(n,t){if($e("AsyncQueue",`${t}: ${n}`),Ii(n))return new q(U.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(t){this.comparator=t?(e,r)=>t(e,r)||K.comparator(e.key,r.key):(e,r)=>K.comparator(e.key,r.key),this.keyedMap=Kr(),this.sortedSet=new vt(this.comparator)}static emptySet(t){return new lr(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof lr)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const r=new lr;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(){this.W_=new vt(K.comparator)}track(t){const e=t.doc.key,r=this.W_.get(e);r?t.type!==0&&r.type===3?this.W_=this.W_.insert(e,t):t.type===3&&r.type!==1?this.W_=this.W_.insert(e,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.W_=this.W_.insert(e,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.W_=this.W_.remove(e):t.type===1&&r.type===2?this.W_=this.W_.insert(e,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):J():this.W_=this.W_.insert(e,t)}G_(){const t=[];return this.W_.inorderTraversal((e,r)=>{t.push(r)}),t}}class _r{constructor(t,e,r,i,o,s,a,u,c){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(t,e,r,i,o){const s=[];return e.forEach(a=>{s.push({type:0,doc:a})}),new _r(t,e,lr.emptySet(e),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&es(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==r[i].type||!e[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class py{constructor(){this.queries=zl(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(e,r){const i=et(e),o=i.queries;i.queries=zl(),o.forEach((s,a)=>{for(const u of a.j_)u.onError(r)})})(this,new q(U.ABORTED,"Firestore shutting down"))}}function zl(){return new Ar(n=>Hd(n),es)}async function If(n,t){const e=et(n);let r=3;const i=t.query;let o=e.queries.get(i);o?!o.H_()&&t.J_()&&(r=2):(o=new fy,r=t.J_()?0:1);try{switch(r){case 0:o.z_=await e.onListen(i,!0);break;case 1:o.z_=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(s){const a=Eu(s,`Initialization of query '${tr(t.query)}' failed`);return void t.onError(a)}e.queries.set(i,o),o.j_.push(t),t.Z_(e.onlineState),o.z_&&t.X_(o.z_)&&Iu(e)}async function Af(n,t){const e=et(n),r=t.query;let i=3;const o=e.queries.get(r);if(o){const s=o.j_.indexOf(t);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=t.J_()?0:1:!o.H_()&&t.J_()&&(i=2))}switch(i){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function gy(n,t){const e=et(n);let r=!1;for(const i of t){const o=i.query,s=e.queries.get(o);if(s){for(const a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&Iu(e)}function my(n,t,e){const r=et(n),i=r.queries.get(t);if(i)for(const o of i.j_)o.onError(e);r.queries.delete(t)}function Iu(n){n.Y_.forEach(t=>{t.next()})}var ba,Xl;(Xl=ba||(ba={})).ea="default",Xl.Cache="cache";class Tf{constructor(t,e,r){this.query=t,this.ta=e,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new _r(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.na?this.ia(t)&&(this.ta.next(t),e=!0):this.sa(t,this.onlineState)&&(this.oa(t),e=!0),this.ra=t,e}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let e=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),e=!0),e}sa(t,e){if(!t.fromCache||!this.J_())return!0;const r=e!=="Offline";return(!this.options._a||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const e=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}oa(t){t=_r.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==ba.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(t){this.key=t}}class Sf{constructor(t){this.key=t}}class _y{constructor(t,e){this.query=t,this.Ta=e,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=nt(),this.mutatedKeys=nt(),this.Aa=Gd(t),this.Ra=new lr(this.Aa)}get Va(){return this.Ta}ma(t,e){const r=e?e.fa:new Wl,i=e?e.Ra:this.Ra;let o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((h,d)=>{const f=i.get(h),g=ns(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),v=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let I=!1;f&&g?f.data.isEqual(g.data)?_!==v&&(r.track({type:3,doc:g}),I=!0):this.ga(f,g)||(r.track({type:2,doc:g}),I=!0,(u&&this.Aa(g,u)>0||c&&this.Aa(g,c)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),I=!0):f&&!g&&(r.track({type:1,doc:f}),I=!0,(u||c)&&(a=!0)),I&&(g?(s=s.add(g),o=v?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r,i){const o=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const s=t.fa.G_();s.sort((h,d)=>function(g,_){const v=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J()}};return v(g)-v(_)}(h.type,d.type)||this.Aa(h.doc,d.doc)),this.pa(r),i=i!=null&&i;const a=e&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,c=u!==this.Ea;return this.Ea=u,s.length!==0||c?{snapshot:new _r(this.query,t.Ra,o,s,t.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Wl,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=nt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const e=[];return t.forEach(r=>{this.da.has(r)||e.push(new Sf(r))}),this.da.forEach(r=>{t.has(r)||e.push(new Cf(r))}),e}ba(t){this.Ta=t.Ts,this.da=nt();const e=this.ma(t.documents);return this.applyChanges(e,!0)}Da(){return _r.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class yy{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class wy{constructor(t){this.key=t,this.va=!1}}class vy{constructor(t,e,r,i,o,s){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Ar(a=>Hd(a),es),this.Ma=new Map,this.xa=new Set,this.Oa=new vt(K.comparator),this.Na=new Map,this.La=new fu,this.Ba={},this.ka=new Map,this.qa=mr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Ey(n,t,e=!0){const r=Df(n);let i;const o=r.Fa.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await bf(r,t,e,!0),i}async function Iy(n,t){const e=Df(n);await bf(e,t,!0,!1)}async function bf(n,t,e,r){const i=await W_(n.localStore,Oe(t)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,e);let a;return r&&(a=await Ay(n,t,o,s==="current",i.resumeToken)),n.isPrimaryClient&&e&&mf(n.remoteStore,i),a}async function Ay(n,t,e,r,i){n.Ka=(d,f,g)=>async function(v,I,T,N){let k=I.view.ma(T);k.ns&&(k=await Ul(v.localStore,I.query,!1).then(({documents:S})=>I.view.ma(S,k)));const P=N&&N.targetChanges.get(I.targetId),B=N&&N.targetMismatches.get(I.targetId)!=null,F=I.view.applyChanges(k,v.isPrimaryClient,P,B);return $l(v,I.targetId,F.wa),F.snapshot}(n,d,f,g);const o=await Ul(n.localStore,t,!0),s=new _y(t,o.Ts),a=s.ma(o.documents),u=Ti.createSynthesizedTargetChangeForCurrentChange(e,r&&n.onlineState!=="Offline",i),c=s.applyChanges(a,n.isPrimaryClient,u);$l(n,e,c.wa);const h=new yy(t,e,s);return n.Fa.set(t,h),n.Ma.has(e)?n.Ma.get(e).push(t):n.Ma.set(e,[t]),c.snapshot}async function Ty(n,t,e){const r=et(n),i=r.Fa.get(t),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!es(s,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Sa(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),e&&mu(r.remoteStore,i.targetId),Ra(r,i.targetId)}).catch(Ei)):(Ra(r,i.targetId),await Sa(r.localStore,i.targetId,!0))}async function Cy(n,t){const e=et(n),r=e.Fa.get(t),i=e.Ma.get(r.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),mu(e.remoteStore,r.targetId))}async function Sy(n,t,e){const r=xy(n);try{const i=await function(s,a){const u=et(s),c=Mt.now(),h=a.reduce((g,_)=>g.add(_.key),nt());let d,f;return u.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=Ke(),v=nt();return u.cs.getEntries(g,h).next(I=>{_=I,_.forEach((T,N)=>{N.isValidDocument()||(v=v.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(g,_)).next(I=>{d=I;const T=[];for(const N of a){const k=$m(N,d.get(N.key).overlayedDocument);k!=null&&T.push(new In(N.key,k,kd(k.value.mapValue),Pe.exists(!0)))}return u.mutationQueue.addMutationBatch(g,c,T,a)}).next(I=>{f=I;const T=I.applyToLocalDocumentSet(d,v);return u.documentOverlayCache.saveOverlays(g,I.batchId,T)})}).then(()=>({batchId:f.batchId,changes:zd(d)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,u){let c=s.Ba[s.currentUser.toKey()];c||(c=new vt(ut)),c=c.insert(a,u),s.Ba[s.currentUser.toKey()]=c}(r,i.batchId,e),await Si(r,i.changes),await us(r.remoteStore)}catch(i){const o=Eu(i,"Failed to persist write");e.reject(o)}}async function Rf(n,t){const e=et(n);try{const r=await j_(e.localStore,t);t.targetChanges.forEach((i,o)=>{const s=e.Na.get(o);s&&(gt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?gt(s.va):i.removedDocuments.size>0&&(gt(s.va),s.va=!1))}),await Si(e,r,t)}catch(r){await Ei(r)}}function ql(n,t,e){const r=et(n);if(r.isPrimaryClient&&e===0||!r.isPrimaryClient&&e===1){const i=[];r.Fa.forEach((o,s)=>{const a=s.view.Z_(t);a.snapshot&&i.push(a.snapshot)}),function(s,a){const u=et(s);u.onlineState=a;let c=!1;u.queries.forEach((h,d)=>{for(const f of d.j_)f.Z_(a)&&(c=!0)}),c&&Iu(u)}(r.eventManager,t),i.length&&r.Ca.d_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function by(n,t,e){const r=et(n);r.sharedClientState.updateQueryState(t,"rejected",e);const i=r.Na.get(t),o=i&&i.key;if(o){let s=new vt(K.comparator);s=s.insert(o,te.newNoDocument(o,tt.min()));const a=nt().add(o),u=new os(tt.min(),new Map,new vt(ut),s,a);await Rf(r,u),r.Oa=r.Oa.remove(o),r.Na.delete(t),Au(r)}else await Sa(r.localStore,t,!1).then(()=>Ra(r,t,e)).catch(Ei)}async function Ry(n,t){const e=et(n),r=t.batch.batchId;try{const i=await U_(e.localStore,t);Of(e,r,null),Nf(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await Si(e,i)}catch(i){await Ei(i)}}async function Ny(n,t,e){const r=et(n);try{const i=await function(s,a){const u=et(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(gt(d!==null),h=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>u.localDocuments.getDocuments(c,h))})}(r.localStore,t);Of(r,t,e),Nf(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),await Si(r,i)}catch(i){await Ei(i)}}function Nf(n,t){(n.ka.get(t)||[]).forEach(e=>{e.resolve()}),n.ka.delete(t)}function Of(n,t,e){const r=et(n);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(t);o&&(e?o.reject(e):o.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function Ra(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.Ma.get(t))n.Fa.delete(r),e&&n.Ca.$a(r,e);n.Ma.delete(t),n.isPrimaryClient&&n.La.gr(t).forEach(r=>{n.La.containsKey(r)||Pf(n,r)})}function Pf(n,t){n.xa.delete(t.path.canonicalString());const e=n.Oa.get(t);e!==null&&(mu(n.remoteStore,e),n.Oa=n.Oa.remove(t),n.Na.delete(e),Au(n))}function $l(n,t,e){for(const r of e)r instanceof Cf?(n.La.addReference(r.key,t),Oy(n,r)):r instanceof Sf?(z("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,t),n.La.containsKey(r.key)||Pf(n,r.key)):J()}function Oy(n,t){const e=t.key,r=e.path.canonicalString();n.Oa.get(e)||n.xa.has(r)||(z("SyncEngine","New document in limbo: "+e),n.xa.add(r),Au(n))}function Au(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const t=n.xa.values().next().value;n.xa.delete(t);const e=new K(yt.fromString(t)),r=n.qa.next();n.Na.set(r,new wy(e)),n.Oa=n.Oa.insert(e,r),mf(n.remoteStore,new ln(Oe(uu(e.path)),r,"TargetPurposeLimboResolution",nu.oe))}}async function Si(n,t,e){const r=et(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,u)=>{s.push(r.Ka(u,t,e).then(c=>{var h;if((c||e)&&r.isPrimaryClient){const d=c?!c.fromCache:(h=e==null?void 0:e.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(c){i.push(c);const d=gu.Wi(u.targetId,c);o.push(d)}}))}),await Promise.all(s),r.Ca.d_(i),await async function(u,c){const h=et(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>j.forEach(c,f=>j.forEach(f.$i,g=>h.persistence.referenceDelegate.addReference(d,f.targetId,g)).next(()=>j.forEach(f.Ui,g=>h.persistence.referenceDelegate.removeReference(d,f.targetId,g)))))}catch(d){if(!Ii(d))throw d;z("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const g=h.os.get(f),_=g.snapshotVersion,v=g.withLastLimboFreeSnapshotVersion(_);h.os=h.os.insert(f,v)}}}(r.localStore,o))}async function Py(n,t){const e=et(n);if(!e.currentUser.isEqual(t)){z("SyncEngine","User change. New user:",t.toKey());const r=await df(e.localStore,t);e.currentUser=t,function(o,s){o.ka.forEach(a=>{a.forEach(u=>{u.reject(new q(U.CANCELLED,s))})}),o.ka.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Si(e,r.hs)}}function Dy(n,t){const e=et(n),r=e.Na.get(t);if(r&&r.va)return nt().add(r.key);{let i=nt();const o=e.Ma.get(t);if(!o)return i;for(const s of o){const a=e.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function Df(n){const t=et(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Rf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dy.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=by.bind(null,t),t.Ca.d_=gy.bind(null,t.eventManager),t.Ca.$a=my.bind(null,t.eventManager),t}function xy(n){const t=et(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ry.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ny.bind(null,t),t}class Kl{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=ss(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return F_(this.persistence,new V_,t.initialUser,this.serializer)}createPersistence(t){return new M_(pu.Zr,this.serializer)}createSharedClientState(t){return new X_}async terminate(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class My{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ql(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Py.bind(null,this.syncEngine),await dy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new py}()}createDatastore(t){const e=ss(t.databaseInfo.databaseId),r=function(o){return new Y_(o)}(t.databaseInfo);return function(o,s,a,u){return new J_(o,s,a,u)}(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return function(r,i,o,s,a){return new ey(r,i,o,s,a)}(this.localStore,this.datastore,t.asyncQueue,e=>ql(this.syncEngine,e,0),function(){return Hl.D()?new Hl:new q_}())}createSyncEngine(t,e){return function(i,o,s,a,u,c,h){const d=new vy(i,o,s,a,u,c);return h&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(i){const o=et(i);z("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await Ci(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(e=this.eventManager)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ga(this.observer.next,t)}error(t){this.observer.error?this.Ga(this.observer.error,t):$e("Uncaught Error in snapshot listener:",t.toString())}za(){this.muted=!0}Ga(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(t,e,r,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=i,this.user=Jt.UNAUTHENTICATED,this.clientId=Dd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async o=>{z("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new q(U.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=Eu(e,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function Qs(n,t){n.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await df(t.localStore,i),r=i)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function Yl(n,t){n.asyncQueue.verifyOperationInProgress();const e=await Vy(n);z("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(r=>Gl(t.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Gl(t.remoteStore,i)),n._onlineComponents=t}function Ly(n){return n.name==="FirebaseError"?n.code===U.FAILED_PRECONDITION||n.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Vy(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qs(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!Ly(e))throw e;dr("Error using user provided cache. Falling back to memory cache: "+e),await Qs(n,new Kl)}}else z("FirestoreClient","Using default OfflineComponentProvider"),await Qs(n,new Kl);return n._offlineComponents}async function Mf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),await Yl(n,n._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),await Yl(n,new My))),n._onlineComponents}function By(n){return Mf(n).then(t=>t.syncEngine)}async function kf(n){const t=await Mf(n),e=t.eventManager;return e.onListen=Ey.bind(null,t.syncEngine),e.onUnlisten=Ty.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=Iy.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=Cy.bind(null,t.syncEngine),e}function Fy(n,t,e={}){const r=new We;return n.asyncQueue.enqueueAndForget(async()=>function(o,s,a,u,c){const h=new xf({next:f=>{s.enqueueAndForget(()=>Af(o,d));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new q(U.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&u&&u.source==="server"?c.reject(new q(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new Tf(uu(a.path),h,{includeMetadataChanges:!0,_a:!0});return If(o,d)}(await kf(n),n.asyncQueue,t,e,r)),r.promise}function Uy(n,t,e={}){const r=new We;return n.asyncQueue.enqueueAndForget(async()=>function(o,s,a,u,c){const h=new xf({next:f=>{s.enqueueAndForget(()=>Af(o,d)),f.fromCache&&u.source==="server"?c.reject(new q(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new Tf(a,h,{includeMetadataChanges:!0,_a:!0});return If(o,d)}(await kf(n),n.asyncQueue,t,e,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(n,t,e){if(!e)throw new q(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function jy(n,t,e,r){if(t===!0&&r===!0)throw new q(U.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function Zl(n){if(!K.isDocumentKey(n))throw new q(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Jl(n){if(K.isDocumentKey(n))throw new q(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Tu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":J()}function Ye(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new q(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Tu(n);throw new q(U.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(t){var e,r;if(t.host===void 0){if(t.ssl!==void 0)throw new q(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new q(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}jy("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lf((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new q(U.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class cs{constructor(t,e,r,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new th({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new q(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new q(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new th(t),t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new nm;switch(r.type){case"firstParty":return new sm(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const r=Ql.get(e);r&&(z("ComponentProvider","Removing Datastore"),Ql.delete(e),r.terminate())}(this),Promise.resolve()}}function Hy(n,t,e,r={}){var i;const o=(n=Ye(n,cs))._getSettings(),s=`${t}:${e}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&dr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=Jt.MOCK_USER;else{a=jh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new q(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Jt(c)}n._authCredentials=new rm(new Pd(a,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new ls(this.firestore,t,this._query)}}class de{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new de(this.firestore,t,this._key)}}class pn extends ls{constructor(t,e,r){super(t,e,uu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new de(this.firestore,null,new K(t))}withConverter(t){return new pn(this.firestore,t,this._path)}}function gn(n,t,...e){if(n=kt(n),Vf("collection","path",t),n instanceof cs){const r=yt.fromString(t,...e);return Jl(r),new pn(n,null,r)}{if(!(n instanceof de||n instanceof pn))throw new q(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(t,...e));return Jl(r),new pn(n.firestore,null,r)}}function mn(n,t,...e){if(n=kt(n),arguments.length===1&&(t=Dd.newId()),Vf("doc","path",t),n instanceof cs){const r=yt.fromString(t,...e);return Zl(r),new de(n,null,new K(r))}{if(!(n instanceof de||n instanceof pn))throw new q(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yt.fromString(t,...e));return Zl(r),new de(n.firestore,n instanceof pn?n.converter:null,new K(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new pf(this,"async_queue_retry"),this.Eu=()=>{const e=Ys();e&&z("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()};const t=Ys();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.du(),this.Au(t)}enterRestrictedMode(t){if(!this.cu){this.cu=!0,this.Iu=t||!1;const e=Ys();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.Eu)}}enqueue(t){if(this.du(),this.cu)return new Promise(()=>{});const e=new We;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.uu.push(t),this.Ru()))}async Ru(){if(this.uu.length!==0){try{await this.uu[0](),this.uu.shift(),this.t_.reset()}catch(t){if(!Ii(t))throw t;z("AsyncQueue","Operation failed with retryable error: "+t)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}}Au(t){const e=this.au.then(()=>(this.Pu=!0,t().catch(r=>{this.hu=r,this.Pu=!1;const i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw $e("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=e,e}enqueueAfterDelay(t,e,r){this.du(),this.Tu.indexOf(t)>-1&&(e=0);const i=vu.createAndSchedule(this,t,e,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&J()}verifyOperationInProgress(){}async mu(){let t;do t=this.au,await t;while(t!==this.au)}fu(t){for(const e of this.lu)if(e.timerId===t)return!0;return!1}gu(t){return this.mu().then(()=>{this.lu.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.lu)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.mu()})}pu(t){this.Tu.push(t)}Vu(t){const e=this.lu.indexOf(t);this.lu.splice(e,1)}}class bi extends cs{constructor(t,e,r,i){super(t,e,r,i),this.type="firestore",this._queue=function(){return new Gy}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Bf(this),this._firestoreClient.terminate()}}function Wy(n,t){const e=typeof n=="object"?n:Ha(),r=typeof n=="string"?n:"(default)",i=Ko(e,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=Bh("firestore");o&&Hy(i,...o)}return i}function Cu(n){return n._firestoreClient||Bf(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Bf(n){var t,e,r;const i=n._freezeSettings(),o=function(a,u,c,h){return new wm(a,u,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Lf(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new ky(n._authCredentials,n._appCheckCredentials,n._queue,o),!((e=i.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new yr(qt.fromBase64String(t))}catch(e){throw new q(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new yr(qt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new q(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ht(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new q(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new q(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=/^__.*__$/;class Xy{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return this.fieldMask!==null?new In(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ai(t,this.data,e,this.fieldTransforms)}}class Ff{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new In(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Uf(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J()}}class Nu{constructor(t,e,r,i,o,s){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(t){return new Nu(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(t){var e;const r=(e=this.path)===null||e===void 0?void 0:e.child(t),i=this.Su({path:r,Du:!1});return i.vu(t),i}Cu(t){var e;const r=(e=this.path)===null||e===void 0?void 0:e.child(t),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(t){return this.Su({path:void 0,Du:!0})}Mu(t){return Uo(t,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}yu(){if(this.path)for(let t=0;t<this.path.length;t++)this.vu(this.path.get(t))}vu(t){if(t.length===0)throw this.Mu("Document fields must not be empty");if(Uf(this.wu)&&zy.test(t))throw this.Mu('Document fields cannot begin and end with "__"')}}class qy{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||ss(t)}Nu(t,e,r,i=!1){return new Nu({wu:t,methodName:e,Ou:r,path:Ht.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jf(n){const t=n._freezeSettings(),e=ss(n._databaseId);return new qy(n._databaseId,!!t.ignoreUndefinedProperties,e)}function $y(n,t,e,r,i,o={}){const s=n.Nu(o.merge||o.mergeFields?2:0,t,e,i);Ou("Data must be an object, but it was:",s,r);const a=Hf(r,s);let u,c;if(o.merge)u=new _e(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const d of o.mergeFields){const f=Na(t,d,e);if(!s.contains(f))throw new q(U.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Wf(h,f)||h.push(f)}u=new _e(h),c=s.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=s.fieldTransforms;return new Xy(new he(a),u,c)}class ds extends Su{_toFieldTransform(t){if(t.wu!==2)throw t.wu===1?t.Mu(`${this._methodName}() can only appear at the top level of your update data`):t.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ds}}function Ky(n,t,e,r){const i=n.Nu(1,t,e);Ou("Data must be an object, but it was:",i,r);const o=[],s=he.empty();$n(r,(u,c)=>{const h=Pu(t,u,e);c=kt(c);const d=i.Cu(h);if(c instanceof ds)o.push(h);else{const f=fs(c,d);f!=null&&(o.push(h),s.set(h,f))}});const a=new _e(o);return new Ff(s,a,i.fieldTransforms)}function Yy(n,t,e,r,i,o){const s=n.Nu(1,t,e),a=[Na(t,r,e)],u=[i];if(o.length%2!=0)throw new q(U.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<o.length;f+=2)a.push(Na(t,o[f])),u.push(o[f+1]);const c=[],h=he.empty();for(let f=a.length-1;f>=0;--f)if(!Wf(c,a[f])){const g=a[f];let _=u[f];_=kt(_);const v=s.Cu(g);if(_ instanceof ds)c.push(g);else{const I=fs(_,v);I!=null&&(c.push(g),h.set(g,I))}}const d=new _e(c);return new Ff(h,d,s.fieldTransforms)}function fs(n,t){if(Gf(n=kt(n)))return Ou("Unsupported field value:",t,n),Hf(n,t);if(n instanceof Su)return function(r,i){if(!Uf(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.Du&&t.wu!==4)throw t.Mu("Nested arrays are not supported");return function(r,i){const o=[];let s=0;for(const a of r){let u=fs(a,i.Fu(s));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),s++}return{arrayValue:{values:o}}}(n,t)}return function(r,i){if((r=kt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Hm(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Mt.fromDate(r);return{timestampValue:Bo(i.serializer,o)}}if(r instanceof Mt){const o=new Mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Bo(i.serializer,o)}}if(r instanceof bu)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yr)return{bytesValue:of(i.serializer,r._byteString)};if(r instanceof de){const o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Mu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:du(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ru)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw a.Mu("VectorValues must only contain numeric values.");return cu(a.serializer,u)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Tu(r)}`)}(n,t)}function Hf(n,t){const e={};return xd(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):$n(n,(r,i)=>{const o=fs(i,t.bu(r));o!=null&&(e[r]=o)}),{mapValue:{fields:e}}}function Gf(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Mt||n instanceof bu||n instanceof yr||n instanceof de||n instanceof Su||n instanceof Ru)}function Ou(n,t,e){if(!Gf(e)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(e)){const r=Tu(e);throw r==="an object"?t.Mu(n+" a custom object"):t.Mu(n+" "+r)}}function Na(n,t,e){if((t=kt(t))instanceof hs)return t._internalPath;if(typeof t=="string")return Pu(n,t);throw Uo("Field path arguments must be of type string or ",n,!1,void 0,e)}const Qy=new RegExp("[~\\*/\\[\\]]");function Pu(n,t,e){if(t.search(Qy)>=0)throw Uo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new hs(...t.split("."))._internalPath}catch{throw Uo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Uo(n,t,e,r,i){const o=r&&!r.isEmpty(),s=i!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(o||s)&&(u+=" (found",o&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new q(U.INVALID_ARGUMENT,a+n+u)}function Wf(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(t,e,r,i,o){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new de(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Zy(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Xf("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class Zy extends zf{data(){return super.data()}}function Xf(n,t){return typeof t=="string"?Pu(n,t):t instanceof hs?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jy(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new q(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tw{convertValue(t,e="none"){switch(zn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Wn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw J()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const r={};return $n(t,(i,o)=>{r[i]=this.convertValue(o,e)}),r}convertVectorValue(t){var e,r,i;const o=(i=(r=(e=t.fields)===null||e===void 0?void 0:e.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>bt(s.doubleValue));return new Ru(o)}convertGeoPoint(t){return new bu(bt(t.latitude),bt(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=iu(t);return r==null?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(di(t));default:return null}}convertTimestamp(t){const e=vn(t);return new Mt(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=yt.fromString(t);gt(hf(r));const i=new fi(r.get(1),r.get(3)),o=new K(r.popFirst(5));return i.isEqual(e)||$e(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class qf extends zf{constructor(t,e,r,i,o,s){super(t,e,r,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new vo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(Xf("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class vo extends qf{data(t={}){return super.data(t)}}class nw{constructor(t,e,r,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Qr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new vo(this._firestore,this._userDataWriter,r.key,r,new Qr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new q(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{const u=new vo(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{const u=new vo(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Qr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:rw(a.type),doc:u,oldIndex:c,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function rw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(n){n=Ye(n,de);const t=Ye(n.firestore,bi);return Fy(Cu(t),n._key).then(e=>iw(t,n,e))}class $f extends tw{constructor(t){super(),this.firestore=t}convertBytes(t){return new yr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new de(this.firestore,null,e)}}function _n(n){n=Ye(n,ls);const t=Ye(n.firestore,bi),e=Cu(t),r=new $f(t);return Jy(n._query),Uy(e,n._query).then(i=>new nw(t,r,n,i))}function jo(n,t,e){n=Ye(n,de);const r=Ye(n.firestore,bi),i=ew(n.converter,t,e);return Yf(r,[$y(jf(r),"setDoc",n._key,i,n.converter!==null,e).toMutation(n._key,Pe.none())])}function Kf(n,t,e,...r){n=Ye(n,de);const i=Ye(n.firestore,bi),o=jf(i);let s;return s=typeof(t=kt(t))=="string"||t instanceof hs?Yy(o,"updateDoc",n._key,t,e,r):Ky(o,"updateDoc",n._key,t),Yf(i,[s.toMutation(n._key,Pe.exists(!0))])}function Yf(n,t){return function(r,i){const o=new We;return r.asyncQueue.enqueueAndForget(async()=>Sy(await By(r),i,o)),o.promise}(Cu(n),t)}function iw(n,t,e){const r=e.docs.get(t._key),i=new $f(n);return new qf(n,i,t._key,r,new Qr(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(i){Ir=i})(qn),Hn(new yn("firestore",(r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),a=new bi(new im(r.getProvider("auth-internal")),new um(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new q(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fi(c.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:e},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Re(wl,"4.7.2",t),Re(wl,"4.7.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="firebasestorage.googleapis.com",Zf="storageBucket",ow=2*60*1e3,sw=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At extends Le{constructor(t,e,r=0){super(Zs(t),`Firebase Storage: ${e} (${Zs(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,At.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Zs(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var It;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(It||(It={}));function Zs(n){return"storage/"+n}function Du(){const n="An unknown error occurred, please check the error payload for server response.";return new At(It.UNKNOWN,n)}function aw(n){return new At(It.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function uw(n){return new At(It.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cw(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new At(It.UNAUTHENTICATED,n)}function lw(){return new At(It.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function hw(n){return new At(It.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function dw(){return new At(It.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function fw(){return new At(It.CANCELED,"User canceled the upload/download.")}function pw(n){return new At(It.INVALID_URL,"Invalid URL '"+n+"'.")}function gw(n){return new At(It.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function mw(){return new At(It.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Zf+"' property when initializing the app?")}function _w(){return new At(It.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function yw(){return new At(It.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ww(n){return new At(It.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Oa(n){return new At(It.INVALID_ARGUMENT,n)}function Jf(){return new At(It.APP_DELETED,"The Firebase app was deleted.")}function vw(n){return new At(It.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ai(n,t){return new At(It.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function Wr(n){throw new At(It.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let r;try{r=ye.makeFromUrl(t,e)}catch{return new ye(t,"")}if(r.path==="")return r;throw gw(t)}static makeFromUrl(t,e){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const s="(/(.*))?$",a=new RegExp("^gs://"+i+s,"i"),u={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",d=e.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",g=new RegExp(`^https?://${d}/${h}/b/${i}/o${f}`,"i"),_={bucket:1,path:3},v=e===Qf?"(?:storage.googleapis.com|storage.cloud.google.com)":e,I="([^?#]*)",T=new RegExp(`^https?://${v}/${i}/${I}`,"i"),k=[{regex:a,indices:u,postModify:o},{regex:g,indices:_,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<k.length;P++){const B=k[P],F=B.regex.exec(t);if(F){const S=F[B.indices.bucket];let A=F[B.indices.path];A||(A=""),r=new ye(S,A),B.postModify(r);break}}if(r==null)throw pw(t);return r}}class Ew{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(n,t,e){let r=1,i=null,o=null,s=!1,a=0;function u(){return a===2}let c=!1;function h(...I){c||(c=!0,t.apply(null,I))}function d(I){i=setTimeout(()=>{i=null,n(g,u())},I)}function f(){o&&clearTimeout(o)}function g(I,...T){if(c){f();return}if(I){f(),h.call(null,I,...T);return}if(u()||s){f(),h.call(null,I,...T);return}r<64&&(r*=2);let k;a===1?(a=2,k=0):k=(r+Math.random())*1e3,d(k)}let _=!1;function v(I){_||(_=!0,f(),!c&&(i!==null?(I||(a=2),clearTimeout(i),d(0)):I||(a=1)))}return d(0),o=setTimeout(()=>{s=!0,v(!0)},e),v}function Aw(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(n){return n!==void 0}function Cw(n){return typeof n=="object"&&!Array.isArray(n)}function xu(n){return typeof n=="string"||n instanceof String}function eh(n){return Mu()&&n instanceof Blob}function Mu(){return typeof Blob<"u"}function nh(n,t,e,r){if(r<t)throw Oa(`Invalid value for '${n}'. Expected ${t} or greater.`);if(r>e)throw Oa(`Invalid value for '${n}'. Expected ${e} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(n,t,e){let r=t;return e==null&&(r=`https://${t}`),`${e}://${r}/v0${n}`}function t1(n){const t=encodeURIComponent;let e="?";for(const r in n)if(n.hasOwnProperty(r)){const i=t(r)+"="+t(n[r]);e=e+i+"&"}return e=e.slice(0,-1),e}var Un;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Un||(Un={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(n,t){const e=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=t.indexOf(n)!==-1;return e||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(t,e,r,i,o,s,a,u,c,h,d,f=!0){this.url_=t,this.method_=e,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=d,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,_)=>{this.resolve_=g,this.reject_=_,this.start_()})}start_(){const t=(r,i)=>{if(i){r(!1,new eo(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const s=a=>{const u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;const a=o.getErrorCode()===Un.NO_ERROR,u=o.getStatus();if(!a||Sw(u,this.additionalRetryCodes_)&&this.retry){const h=o.getErrorCode()===Un.ABORT;r(!1,new eo(!1,null,h));return}const c=this.successCodes_.indexOf(u)!==-1;r(!0,new eo(c,o))})},e=(r,i)=>{const o=this.resolve_,s=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());Tw(u)?o(u):o()}catch(u){s(u)}else if(a!==null){const u=Du();u.serverResponse=a.getErrorText(),this.errorCallback_?s(this.errorCallback_(a,u)):s(u)}else if(i.canceled){const u=this.appDelete_?Jf():fw();s(u)}else{const u=dw();s(u)}};this.canceled_?e(!1,new eo(!1,null,!0)):this.backoffId_=Iw(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Aw(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class eo{constructor(t,e,r){this.wasSuccessCode=t,this.connection=e,this.canceled=!!r}}function Rw(n,t){t!==null&&t.length>0&&(n.Authorization="Firebase "+t)}function Nw(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function Ow(n,t){t&&(n["X-Firebase-GMPID"]=t)}function Pw(n,t){t!==null&&(n["X-Firebase-AppCheck"]=t)}function Dw(n,t,e,r,i,o,s=!0){const a=t1(n.urlParams),u=n.url+a,c=Object.assign({},n.headers);return Ow(c,t),Rw(c,e),Nw(c,o),Pw(c,r),new bw(u,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Mw(...n){const t=xw();if(t!==void 0){const e=new t;for(let r=0;r<n.length;r++)e.append(n[r]);return e.getBlob()}else{if(Mu())return new Blob(n);throw new At(It.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function kw(n,t,e){return n.webkitSlice?n.webkitSlice(t,e):n.mozSlice?n.mozSlice(t,e):n.slice?n.slice(t,e):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(n){if(typeof atob>"u")throw ww("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Js{constructor(t,e){this.data=t,this.contentType=e||null}}function Vw(n,t){switch(n){case Se.RAW:return new Js(e1(t));case Se.BASE64:case Se.BASE64URL:return new Js(n1(n,t));case Se.DATA_URL:return new Js(Fw(t),Uw(t))}throw Du()}function e1(n){const t=[];for(let e=0;e<n.length;e++){let r=n.charCodeAt(e);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(e<n.length-1&&(n.charCodeAt(e+1)&64512)===56320))t.push(239,191,189);else{const o=r,s=n.charCodeAt(++e);r=65536|(o&1023)<<10|s&1023,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(t)}function Bw(n){let t;try{t=decodeURIComponent(n)}catch{throw ai(Se.DATA_URL,"Malformed data URL.")}return e1(t)}function n1(n,t){switch(n){case Se.BASE64:{const i=t.indexOf("-")!==-1,o=t.indexOf("_")!==-1;if(i||o)throw ai(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Se.BASE64URL:{const i=t.indexOf("+")!==-1,o=t.indexOf("/")!==-1;if(i||o)throw ai(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=Lw(t)}catch(i){throw i.message.includes("polyfill")?i:ai(n,"Invalid character found")}const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}class r1{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(e===null)throw ai(Se.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;r!=null&&(this.base64=jw(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}function Fw(n){const t=new r1(n);return t.base64?n1(Se.BASE64,t.rest):Bw(t.rest)}function Uw(n){return new r1(n).contentType}function jw(n,t){return n.length>=t.length?n.substring(n.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(t,e){let r=0,i="";eh(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(eh(this.data_)){const r=this.data_,i=kw(r,t,e);return i===null?null:new cn(i)}else{const r=new Uint8Array(this.data_.buffer,t,e-t);return new cn(r,!0)}}static getBlob(...t){if(Mu()){const e=t.map(r=>r instanceof cn?r.data_:r);return new cn(Mw.apply(null,e))}else{const e=t.map(s=>xu(s)?Vw(Se.RAW,s).data:s.data_);let r=0;e.forEach(s=>{r+=s.byteLength});const i=new Uint8Array(r);let o=0;return e.forEach(s=>{for(let a=0;a<s.length;a++)i[o++]=s[a]}),new cn(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(n){let t;try{t=JSON.parse(n)}catch{return null}return Cw(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(n){if(n.length===0)return null;const t=n.lastIndexOf("/");return t===-1?"":n.slice(0,t)}function Gw(n,t){const e=t.split("/").filter(r=>r.length>0).join("/");return n.length===0?e:n+"/"+e}function o1(n){const t=n.lastIndexOf("/",n.length-2);return t===-1?n:n.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(n,t){return t}class ie{constructor(t,e,r,i){this.server=t,this.local=e||t,this.writable=!!r,this.xform=i||Ww}}let no=null;function zw(n){return!xu(n)||n.length<2?n:o1(n)}function s1(){if(no)return no;const n=[];n.push(new ie("bucket")),n.push(new ie("generation")),n.push(new ie("metageneration")),n.push(new ie("name","fullPath",!0));function t(o,s){return zw(s)}const e=new ie("name");e.xform=t,n.push(e);function r(o,s){return s!==void 0?Number(s):s}const i=new ie("size");return i.xform=r,n.push(i),n.push(new ie("timeCreated")),n.push(new ie("updated")),n.push(new ie("md5Hash",null,!0)),n.push(new ie("cacheControl",null,!0)),n.push(new ie("contentDisposition",null,!0)),n.push(new ie("contentEncoding",null,!0)),n.push(new ie("contentLanguage",null,!0)),n.push(new ie("contentType",null,!0)),n.push(new ie("metadata","customMetadata",!0)),no=n,no}function Xw(n,t){function e(){const r=n.bucket,i=n.fullPath,o=new ye(r,i);return t._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:e})}function qw(n,t,e){const r={};r.type="file";const i=e.length;for(let o=0;o<i;o++){const s=e[o];r[s.local]=s.xform(r,t[s.server])}return Xw(r,n),r}function a1(n,t,e){const r=i1(t);return r===null?null:qw(n,r,e)}function $w(n,t,e,r){const i=i1(t);if(i===null||!xu(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const s=encodeURIComponent;return o.split(",").map(c=>{const h=n.bucket,d=n.fullPath,f="/b/"+s(h)+"/o/"+s(d),g=ku(f,e,r),_=t1({alt:"media",token:c});return g+_})[0]}function Kw(n,t){const e={},r=t.length;for(let i=0;i<r;i++){const o=t[i];o.writable&&(e[o.server]=n[o.local])}return JSON.stringify(e)}class u1{constructor(t,e,r,i){this.url=t,this.method=e,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(n){if(!n)throw Du()}function Yw(n,t){function e(r,i){const o=a1(n,i,t);return c1(o!==null),o}return e}function Qw(n,t){function e(r,i){const o=a1(n,i,t);return c1(o!==null),$w(o,i,n.host,n._protocol)}return e}function l1(n){function t(e,r){let i;return e.getStatus()===401?e.getErrorText().includes("Firebase App Check token is invalid")?i=lw():i=cw():e.getStatus()===402?i=uw(n.bucket):e.getStatus()===403?i=hw(n.path):i=r,i.status=e.getStatus(),i.serverResponse=r.serverResponse,i}return t}function Zw(n){const t=l1(n);function e(r,i){let o=t(r,i);return r.getStatus()===404&&(o=aw(n.path)),o.serverResponse=i.serverResponse,o}return e}function Jw(n,t,e){const r=t.fullServerUrl(),i=ku(r,n.host,n._protocol),o="GET",s=n.maxOperationRetryTime,a=new u1(i,o,Qw(n,e),s);return a.errorHandler=Zw(t),a}function tv(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}function ev(n,t,e){const r=Object.assign({},e);return r.fullPath=n.path,r.size=t.size(),r.contentType||(r.contentType=tv(null,t)),r}function nv(n,t,e,r,i){const o=t.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};function a(){let k="";for(let P=0;P<2;P++)k=k+Math.random().toString().slice(2);return k}const u=a();s["Content-Type"]="multipart/related; boundary="+u;const c=ev(t,r,i),h=Kw(c,e),d="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+u+"--",g=cn.getBlob(d,r,f);if(g===null)throw _w();const _={name:c.fullPath},v=ku(o,n.host,n._protocol),I="POST",T=n.maxUploadRetryTime,N=new u1(v,I,Yw(n,e),T);return N.urlParams=_,N.headers=s,N.body=g.uploadData(),N.errorHandler=l1(t),N}class rv{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Un.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Un.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Un.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,r,i){if(this.sent_)throw Wr("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Wr("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Wr("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Wr("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Wr("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class iv extends rv{initXhr(){this.xhr_.responseType="text"}}function h1(){return new iv}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(t,e){this._service=t,e instanceof ye?this._location=e:this._location=ye.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Xn(t,e)}get root(){const t=new ye(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return o1(this._location.path)}get storage(){return this._service}get parent(){const t=Hw(this._location.path);if(t===null)return null;const e=new ye(this._location.bucket,t);return new Xn(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw vw(t)}}function ov(n,t,e){n._throwIfRoot("uploadBytes");const r=nv(n.storage,n._location,s1(),new cn(t,!0),e);return n.storage.makeRequestWithTokens(r,h1).then(i=>({metadata:i,ref:n}))}function sv(n){n._throwIfRoot("getDownloadURL");const t=Jw(n.storage,n._location,s1());return n.storage.makeRequestWithTokens(t,h1).then(e=>{if(e===null)throw yw();return e})}function av(n,t){const e=Gw(n._location.path,t),r=new ye(n._location.bucket,e);return new Xn(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uv(n){return/^[A-Za-z]+:\/\//.test(n)}function cv(n,t){return new Xn(n,t)}function d1(n,t){if(n instanceof Lu){const e=n;if(e._bucket==null)throw mw();const r=new Xn(e,e._bucket);return t!=null?d1(r,t):r}else return t!==void 0?av(n,t):n}function lv(n,t){if(t&&uv(t)){if(n instanceof Lu)return cv(n,t);throw Oa("To use ref(service, url), the first argument must be a Storage instance.")}else return d1(n,t)}function rh(n,t){const e=t==null?void 0:t[Zf];return e==null?null:ye.makeFromBucketSpec(e,n)}function hv(n,t,e,r={}){n.host=`${t}:${e}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:jh(i,n.app.options.projectId))}class Lu{constructor(t,e,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=Qf,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ow,this._maxUploadRetryTime=sw,this._requests=new Set,i!=null?this._bucket=ye.makeFromBucketSpec(i,this._host):this._bucket=rh(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=ye.makeFromBucketSpec(this._url,t):this._bucket=rh(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){nh("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){nh("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Xn(this,t)}_makeRequest(t,e,r,i,o=!0){if(this._deleted)return new Ew(Jf());{const s=Dw(t,this._appId,r,i,e,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(t,e){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,r,i).getPromise()}}const ih="@firebase/storage",oh="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1="storage";function dv(n,t,e){return n=kt(n),ov(n,t,e)}function fv(n){return n=kt(n),sv(n)}function pv(n,t){return n=kt(n),lv(n,t)}function gv(n=Ha(),t){n=kt(n);const r=Ko(n,f1).getImmediate({identifier:t}),i=Bh("storage");return i&&mv(r,...i),r}function mv(n,t,e,r={}){hv(n,t,e,r)}function _v(n,{instanceIdentifier:t}){const e=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Lu(e,r,i,t,qn)}function yv(){Hn(new yn(f1,_v,"PUBLIC").setMultipleInstances(!0)),Re(ih,oh,""),Re(ih,oh,"esm2017")}yv();const wv={apiKey:"AIzaSyAvl0QM7i4v-gVeBmyZrf-2CwNfMOHghog",authDomain:"shopping-street-c3190.firebaseapp.com",projectId:"shopping-street-c3190",storageBucket:"shopping-street-c3190.appspot.com",messagingSenderId:"778005216985",appId:"1:778005216985:web:e2480364cf962b126f48c8",measurementId:"G-TNRXH4YN9Y"},Vu=Wh(wv),Ri=tm(Vu);new Ce;const ae=Wy(Vu),vv=gv(Vu),Ev=({userId:n,onTabClick:t})=>{const[e,r]=$.useState(""),[i,o]=$.useState([]);$.useEffect(()=>{(async()=>{try{const c=(await _n(gn(ae,"stores"))).docs.map(h=>h.id);o(c),c.length>0&&(r(c[0]),t(c[0]))}catch(u){console.error("Error fetching tabs: ",u)}})()},[]);const s=a=>{console.log("Tab clicked:",a),r(a),t(a)};return y.jsx("div",{children:y.jsx("div",{className:"flex w-full mt-6 border-b-2 border-b-[#513c38] overflow-x-auto",children:y.jsx("div",{className:"flex min-w-max items-end",children:i.map(a=>y.jsx("button",{onClick:()=>s(a),className:`w-fit h-fit flex-none whitespace-nowrap rounded-tr-md rounded-tl-md ${e===a?"bg-[#513c38] text-xl pt-4 pb-2 px-5 text-white":"bg-white border border-[#513c38] text-sm py-2.5 px-4 text-[#513c38] "}`,children:a},a))})})})},Iv=({src:n,alt:t})=>y.jsx("img",{src:n,alt:t,className:"w-full max-h-[182px] object-cover mb-3"}),Pa=({CardBtnText:n})=>y.jsx("div",{className:"mr-2  w-fit bg-[#ebb625] rounded-[13.50px] ",children:y.jsxs("div",{className:"flex items-center px-2 py-1",children:[y.jsx("img",{src:"/public/images/dia.svg",alt:n}),y.jsx("p",{className:"text-sm text-white",children:n})]})}),Av=({activeTab:n})=>{const[t,e]=$.useState(null);if($.useEffect(()=>{(async()=>{try{const s=(await _n(gn(ae,"stores"))).docs.map(a=>({id:a.id,...a.data()}));e(s)}catch(o){console.error("Error fetching data: ",o)}})()},[]),!t)return y.jsx("div",{children:"Loading..."});const r=t.find(i=>i.id===n);return r?y.jsx("div",{className:"mt-10 max-w-xs mx-auto",children:y.jsxs("div",{children:[y.jsx(Iv,{src:r.imageUrl,alt:r.storeName}),y.jsxs("div",{className:"flex items-center",children:[y.jsx("img",{className:"mr-1",src:"/public/images/walk2.svg",alt:r.storeName}),y.jsx("p",{className:"text-sm",children:r.score})]}),y.jsx("h2",{className:"text-xl mb-3",children:r.storeName}),y.jsx("p",{className:"text-sm mb-5 leading-[25px]",children:r.description}),y.jsx("div",{className:"flex items-center mb-14",children:r.tags&&r.tags.map((i,o)=>y.jsx(Pa,{CardBtnText:i},o))})]})}):y.jsx("div",{children:"No data found for the selected tab."})},ta=({user:n,index:t,rankStyle:e,imgStyle:r,nameStyle:i,countStyle:o,iconSrc:s,iconAlt:a="Crown",iconStyle:u="mr-2",h1Margin:c,textColor:h="text-[#513c38]"})=>y.jsxs("li",{className:`flex items-center mb-2 ${e}`,children:[y.jsx("h1",{className:`${h} w-3 text-xl ${c}`,children:t+1}),y.jsx("img",{src:n.photoURL||"/public/images/icon.png",alt:n.name,className:`rounded-full w-12 h-12 mr-4 ${r}`}),y.jsx("p",{className:`${h} mr-12 whitespace-nowrap overflow-hidden overflow-ellipsis ${i}`,children:n.name}),y.jsxs("div",{className:`${h}  flex items-center mr-2 ${o}`,children:[y.jsx("img",{src:s,alt:a,className:u}),y.jsx("p",{className:" text-3xl pr-2",children:n.scanCount||0})]})]}),Tv=()=>{const[n,t]=$.useState([]);$.useEffect(()=>{(async()=>{try{const o=await _n(gn(ae,"users")),s=[];o.forEach(a=>{s.push(a.data())}),t(s)}catch(o){console.error("Error getting documents: ",o)}})()},[]);const e={name:"適当たろうくん",photoURL:"/public/images/icon.png",scanCount:6},r={name:"＼(^o^)／",photoURL:"/public/images/icon.png",scanCount:4};return y.jsxs("div",{className:"mb-40 max-w-xs mx-auto",children:[y.jsxs("div",{className:"bg-gradient-to-l from-[#eca95a] to-[#da390d] shadow-inner shadow-gray-300 px-2 rounded-lg mt-5",children:[y.jsx("div",{className:"pt-2 pb-2",children:y.jsx(lo,{color:"#fbe097",width:41,height:41})}),y.jsx("ul",{id:"dataList",className:"mx-3 pb-5",children:y.jsx(ta,{user:e,textColor:"text-white",index:1,rankStyle:"text-xl",imgStyle:"w-12 h-12",nameStyle:"text-sm w-24",countStyle:"text-3xl",iconSrc:"/public/images/crown.svg",h1Margin:"mr-4"})})]}),y.jsxs("div",{className:"bg-[#FCF7EC] shadow-inner shadow-gray-300 px-2 rounded-lg mt-5",children:[y.jsx("div",{className:"pt-2 pb-2",children:y.jsx(lo,{color:"#f4ae7e",width:24,height:24})}),y.jsx("ul",{id:"dataList",className:"mx-3 pb-5",children:y.jsx(ta,{user:e,index:1,rankStyle:"text-xl",imgStyle:"w-12 h-12",nameStyle:"text-sm w-24",countStyle:"text-3xl",iconSrc:"/public/images/walk2.svg",h1Margin:"mr-4"})})]}),y.jsxs("div",{className:"bg-[#FCF7EC] shadow-inner shadow-gray-300 px-2 rounded-lg mt-5",children:[y.jsx("div",{className:"pt-2 pb-2",children:y.jsx(lo,{color:"#f3c42c",width:24,height:24})}),y.jsx("ul",{id:"dataList",className:"mx-3 pb-5",children:y.jsx(ta,{user:r,index:2,rankStyle:"text-xl",imgStyle:"w-12 h-12",nameStyle:"text-sm w-24",countStyle:"text-3xl",iconSrc:"/public/images/walk2.svg",h1Margin:"mr-4"})})]}),y.jsx("div",{className:"bg-[#FCF7EC] shadow-inner shadow-gray-300 px-2 rounded-lg mt-5",children:[{name:"ユーザー4",scanCount:3}].map((i,o)=>y.jsx("ul",{id:"dataList",className:"mx-3",children:y.jsxs("li",{className:"flex items-center py-3 text-xl",children:[y.jsx("h1",{className:"text-[#513c38] w-3 text-xl mr-4",children:o+4}),y.jsx("img",{src:"/public/images/icon.png",alt:i.name,className:"rounded-full w-12 h-12 mr-4"}),y.jsx("p",{className:"text-[#513c38] mr-12 whitespace-nowrap overflow-hidden overflow-ellipsis text-sm w-24",children:i.name}),y.jsxs("div",{className:"text-[#513c38] flex items-center mr-2 text-3xl",children:[y.jsx("img",{src:"/public/images/walk2.svg",alt:"Walk Icon",className:"mr-2"}),y.jsx("p",{className:"text-3xl pr-2",children:i.scanCount})]})]})},o))}),y.jsx("div",{className:"bg-[#FCF7EC] shadow-inner shadow-gray-300 px-2 rounded-lg mt-5",children:[{name:"ユーザー5",scanCount:2}].map((i,o)=>y.jsx("ul",{id:"dataList",className:"mx-3",children:y.jsxs("li",{className:"flex items-center py-3 text-xl",children:[y.jsx("h1",{className:"text-[#513c38] w-3 text-xl mr-4",children:o+5}),y.jsx("img",{src:"/public/images/icon.png",alt:i.name,className:"rounded-full w-12 h-12 mr-4"}),y.jsx("p",{className:"text-[#513c38] mr-12 whitespace-nowrap overflow-hidden overflow-ellipsis text-sm w-24",children:i.name}),y.jsxs("div",{className:"text-[#513c38] flex items-center mr-2 text-3xl",children:[y.jsx("img",{src:"/public/images/walk2.svg",alt:"Walk Icon",className:"mr-2"}),y.jsx("p",{className:"text-3xl pr-2",children:i.scanCount})]})]})},o))})]})},p1=()=>{const[n,t]=$.useState(""),e=r=>{console.log("現在のアクティブなタブ:",r),t(r)};return y.jsxs("div",{children:[y.jsx(Ev,{onTabClick:e}),y.jsx(Av,{activeTab:n}),y.jsx(Tv,{})]})},g1=()=>{const[n,t]=$.useState("top-1/3");return[n,()=>{t(i=>i==="top-1/3"?"top-2/3":"top-1/3")},()=>{t("top-1/3")}]},Cv=({setMapTitle:n,setMapScore:t,setMapText:e,setMapImage:r,setIsMapInfoVisible:i})=>{const o=$.useRef(null),s=$.useRef([]),[,,a]=g1(),[u,c]=$.useState(null);return $.useEffect(()=>{if(u||(async()=>{try{const d=await _n(gn(ae,"stores")),f={};d.forEach(g=>{const _=g.data();f[_.storeName]={lat:parseFloat(_.lat),lng:parseFloat(_.lng),title:_.storeName,score:_.score||"0",text:_.description,img:_.imageUrl}}),c(f)}catch(d){console.error("Error fetching map data:",d)}})(),!o.current&&u){const f=new H.service.Platform({apikey:"kHhLUgbO973xZhOrEx1VNlHRUXw8vZOGx5vhCX41rjE"}).getOMVService({path:"v2/vectortiles/core/mc"}),g="https://js.api.here.com/v3/3.1/styles/omv/oslo/japan/",_=new H.map.Style(`${g}normal.day.yaml`,g),v=new H.service.omv.Provider(f,_),I=new H.map.layer.TileLayer(v,{max:22}),T=new H.Map(document.getElementById("map"),I,{zoom:12,maxZoom:16,minZoom:10,center:{lat:35.1815,lng:136.8848},pixelRatio:window.devicePixelRatio||1});new H.mapevents.Behavior(new H.mapevents.MapEvents(T)),o.current=T,v.addEventListener("tileloaderror",P=>{console.error("Tile load error:",P)}),Object.values(u).forEach(P=>{if(P.lat&&P.lng){const B=new H.map.Marker({lat:P.lat,lng:P.lng});T.addObject(B),s.current.push(B),B.addEventListener("tap",()=>{const F=B.getGeometry();T.setCenter({lat:F.lat-.01,lng:F.lng},!0),T.setZoom(15,!0,300),n(P.title),t(P.score),e(P.text),r(P.img),i(!0),a()})}else console.error("Invalid coordinates:",P)});const N=P=>{const{latitude:B,longitude:F}=P.coords,S=new H.map.Icon("./images/icon.png",{size:{w:24,h:24}}),A=new H.map.Marker({lat:B,lng:F},{icon:S});T.addObject(A),T.setCenter({lat:B-.01,lng:F})},k=P=>{console.error("Error getting current location:",P)};navigator.geolocation?navigator.geolocation.getCurrentPosition(N,k):console.error("Geolocation is not supported by this browser."),window.addEventListener("resize",()=>T.getViewPort().resize()),T.addEventListener("tap",P=>{const B=P.target;s.current.some(F=>F===B)||i(!1)})}},[u,n,t,e,r,i,a]),y.jsx("div",{id:"map",style:{height:"100vh",width:"100vw"}})},Sv=({title:n,score:t,text:e,img:r})=>{const[i,o]=g1();return y.jsx("div",{className:`z-50 fixed ${i} left-0 bg-white w-full h-full rounded-tl-[15px] rounded-tr-[15px] shadow transition-all duration-500`,onClick:o,style:{display:i==="hidden"?"none":"block"},children:y.jsxs("div",{className:"max-w-xs mx-auto text-[#513c38]",children:[y.jsx("h1",{className:"mt-6 text-2xl ",children:n}),y.jsxs("div",{className:"flex items-center mt-1",children:[y.jsx("img",{className:"mr-1",src:"/public/images/walk2.svg",alt:"記録"}),y.jsx("p",{children:t})]}),y.jsx("img",{className:"mt-6",src:r,alt:n}),y.jsx("p",{className:"mt-4 leading-[25px]",children:e})]})})},bv=()=>{const[n,t]=$.useState(""),[e,r]=$.useState(""),[i,o]=$.useState(""),[s,a]=$.useState(""),[u,c]=$.useState(!1);return y.jsxs("div",{className:"overflow-hidden h-5/6 relative",children:[y.jsx(Cv,{setMapTitle:t,setMapScore:r,setMapText:o,setMapImage:a,setIsMapInfoVisible:c}),u&&y.jsx(Sv,{title:n,score:e,text:i,img:s})]})},zr=({onClick:n,ItemSrc:t,ItemAlt:e})=>y.jsxs("div",{className:"flex items-center mb-9",onClick:n,children:[y.jsx("img",{className:"mr-3",src:t,alt:e}),y.jsx("p",{className:"text-base",children:e})]}),m1=({setCurrentPage:n})=>{const[t,e]=$.useState(""),[r,i]=$.useState(null),[o,s]=$.useState(null),[a,u]=$.useState(""),[c,h]=$.useState(""),[d,f]=$.useState(""),g=async v=>{v.preventDefault();try{let I="";if(r){const T=pv(vv,`images/${r.name}`);await dv(T,r),I=await fv(T)}await jo(mn(ae,"stores",t),{storeName:t,imageUrl:I,description:a,tags:[c.trim(),d.trim()].filter(T=>T)}),e(""),i(null),s(null),u(""),h(""),f(""),n("Ranking")}catch(I){console.error("Error adding document: ",I)}},_=v=>{const I=v.target.files[0];I?(i(I),s(URL.createObjectURL(I))):(i(null),s(null))};return y.jsxs("div",{className:"min-h-screen bg-white",children:[y.jsx("div",{className:"w-full bg-customBg",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{onClick:()=>n("Menu"),className:"flex pb-3 pt-14",children:[y.jsx("img",{src:"/public/images/angle-left.svg",alt:"右矢印"}),y.jsx("p",{className:"mx-auto text-white",children:"管理者ページ"})]})})}),y.jsx("div",{className:"max-w-xs mx-auto mt-20",children:y.jsxs("form",{onSubmit:g,className:"space-y-4",children:[y.jsx("div",{className:"text-center",children:y.jsxs("div",{className:"relative flex flex-col items-center justify-center w-full h-40 bg-[#d9d9d9] rounded cursor-pointer",children:[y.jsx("input",{id:"file-upload",type:"file",onChange:_,className:"hidden"}),y.jsx("label",{htmlFor:"file-upload",className:"absolute inset-0 flex flex-col items-center justify-center",children:o?y.jsx("img",{src:o,alt:"プレビュー画像",className:"object-cover w-full h-full rounded"}):y.jsxs(y.Fragment,{children:[y.jsx("img",{src:"/public/images/imageSelect.svg",alt:"画像アイコン",className:"w-12 h-12 mb-2"}),y.jsx("p",{className:"text-white",children:"画像を選択"})]})})]})}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-gray-700",children:"商店街名"}),y.jsx("input",{className:"w-full p-2 bg-gray-100 border border-gray-300 rounded",type:"text",value:t,onChange:v=>e(v.target.value)})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-gray-700",children:"商店街説明文"}),y.jsx("textarea",{className:"w-full p-2 bg-gray-100 border border-gray-300 rounded",value:a,onChange:v=>u(v.target.value)})]}),y.jsxs("div",{className:"flex space-x-2",children:[y.jsxs("div",{className:"w-1/2",children:[y.jsx("label",{className:"block text-gray-700",children:"タグ1"}),y.jsx("input",{className:"w-full p-2 bg-gray-100 border border-gray-300 rounded",type:"text",value:c,onChange:v=>h(v.target.value)})]}),y.jsxs("div",{className:"w-1/2",children:[y.jsx("label",{className:"block text-gray-700",children:"タグ2"}),y.jsx("input",{className:"w-full p-2 bg-gray-100 border border-gray-300 rounded",type:"text",value:d,onChange:v=>f(v.target.value)})]})]}),y.jsx("button",{className:"w-full py-2 font-semibold text-white bg-gray-800 rounded hover:bg-gray-700",children:"送信"})]})})]})},sh=["okiyamafirebaseservice@gmail.com","naotookiyama@gmail.com","sasarayamauchi8@gmail.com"],Rv=({setCurrentPage:n,userInfo:t})=>y.jsxs("div",{className:"font-notosansjp",children:[y.jsx("div",{className:"relative w-full h-48 bg-slate-200",children:y.jsx("div",{className:"absolute max-w-24 max-h-24 top-36 left-40",children:y.jsx("img",{className:"rounded-full",src:t.photoURL||"/public/images/icon.png",alt:"icon"})})}),y.jsxs("div",{className:"max-w-xs mx-auto mt-16 ",children:[y.jsx("h2",{className:"mx-auto text-2xl text-center mb-9",children:t?t.displayName:"名前がないよ"}),y.jsx(zr,{onClick:()=>n("checkin"),ItemSrc:"/public/images/location.svg",ItemAlt:"チェックイン管理"}),y.jsx(zr,{onClick:()=>n("checkinfo"),ItemSrc:"/public/images/bell.svg",ItemAlt:"お知らせ"}),y.jsx(zr,{onClick:()=>n("setting"),ItemSrc:"/public/images/gear.svg",ItemAlt:"設定*中身なし"}),y.jsx(zr,{onClick:()=>n("search"),ItemSrc:"/public/images/glass.svg",ItemAlt:"探す"}),sh.includes(t.email)&&y.jsx(zr,{onClick:()=>n("admin"),ItemSrc:"/public/images/gear.svg",ItemAlt:"管理者"})]}),sh.includes(t.email)&&n==="admin"&&y.jsx(m1,{})]}),ea=({InfoDay:n,InfoTitle:t,onClick:e})=>y.jsx("div",{className:"border-b-2 border-solid",children:y.jsxs("div",{onClick:e,className:"max-w-xs mt-6 mx-auto pb-5 ",children:[y.jsx("p",{className:"text-customDay",children:n}),y.jsx("h4",{children:t})]})}),Nv=({setCurrentPage:n})=>y.jsxs("div",{children:[y.jsx("div",{className:"bg-customBg w-full",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{onClick:()=>n("Menu"),className:"pt-14 pb-3 flex",children:[y.jsx("img",{src:"/public/images/angle-left.svg",alt:"右矢印"}),y.jsx("p",{className:" mx-auto text-white",children:"お知らせ"})]})})}),y.jsx(ea,{onClick:()=>n("Article"),InfoTitle:"システムメンテナンスのお知らせ",InfoDay:"2024/9/18 10:50"}),y.jsx(ea,{onClick:()=>n("Article"),InfoTitle:"【システムアップデートのお知らせ】バグ修正とパフォーマンス向上の最新情報",InfoDay:"2024/9/13 10:50"}),y.jsx(ea,{onClick:()=>n("Article"),InfoTitle:"【ユーザーアンケートのお願い】より良いサービスのために皆様の声をお聞かせください",InfoDay:"2024/9/10 10:50"})]}),na=({MenuCount:n,MenuText:t})=>y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{className:"flex items-center justify-between  mt-7 pb-5  border-b-2 border-solid",children:[y.jsx("p",{className:"text-base",children:t}),y.jsxs("p",{className:"flex items-center",children:[y.jsxs("span",{className:"text-4xl mr-1",children:[n," "]}),"回"]})]})}),Ov=({setCurrentPage:n})=>{const[t,e]=$.useState(0),[r,i]=$.useState(0),[o,s]=$.useState(0);return $.useEffect(()=>{const a=async c=>{try{const h=mn(ae,"大須商店街",c.uid),d=await si(h);if(d.exists()){const f=d.data();e(f.count||0);const g=mn(ae,"円頓寺商店街",c.uid),_=await si(g);if(_.exists()){const T=_.data();i(T.count||0)}const v=mn(ae,"せと末広町商店街",c.uid),I=await si(v);if(I.exists()){const T=I.data();s(T.count||0)}}}catch{}},u=Ri.onAuthStateChanged(c=>{c&&a(c)});return()=>u()},[]),y.jsxs("div",{children:[y.jsx("div",{className:"w-full bg-customBg",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{onClick:()=>n("Menu"),className:"flex pb-3 pt-14 ",children:[y.jsx("img",{src:"/public/images/angle-left.svg",alt:"左矢印"}),y.jsx("p",{className:"mx-auto text-white",children:"チェックイン管理"})]})})}),y.jsx(na,{MenuText:"大須商店街",MenuCount:t}),y.jsx(na,{MenuText:"円頓寺商店街",MenuCount:r}),y.jsx(na,{MenuText:"せと末広町商店街",MenuCount:o})]})},Pv=({setCurrentPage:n})=>y.jsx("div",{children:y.jsx("div",{className:"bg-customBg w-full",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{onClick:()=>n("CheckInfo"),className:"pt-14 pb-3 flex ",children:[y.jsx("img",{src:"/public/images/angle-left.svg",alt:"右矢印"}),y.jsx("p",{className:" mx-auto text-white",children:"設定"})]})})})}),Dv=n=>{const{style:t,color:e="#513C38",width:r=27,height:i=27,classname:o}=n;return y.jsxs("svg",{width:r,height:i,viewBox:"0 0 27 27",fill:"none",className:o,xmlns:"http://www.w3.org/2000/svg",style:t,children:[y.jsx("g",{clipPath:"url(#clip0_245_1545)",children:y.jsx("path",{d:"M21.9375 10.9688C21.9375 13.3893 21.1518 15.6252 19.8281 17.4393L26.5043 24.1207C27.1635 24.7799 27.1635 25.8504 26.5043 26.5096C25.8451 27.1688 24.7746 27.1688 24.1154 26.5096L17.4393 19.8281C15.6252 21.157 13.3893 21.9375 10.9688 21.9375C4.90957 21.9375 0 17.0279 0 10.9688C0 4.90957 4.90957 0 10.9688 0C17.0279 0 21.9375 4.90957 21.9375 10.9688ZM10.9688 18.5625C11.966 18.5625 12.9534 18.3661 13.8748 17.9845C14.7961 17.6028 15.6332 17.0435 16.3383 16.3383C17.0435 15.6332 17.6028 14.7961 17.9845 13.8748C18.3661 12.9534 18.5625 11.966 18.5625 10.9688C18.5625 9.97152 18.3661 8.98406 17.9845 8.06275C17.6028 7.14143 17.0435 6.3043 16.3383 5.59916C15.6332 4.89401 14.7961 4.33466 13.8748 3.95304C12.9534 3.57142 11.966 3.375 10.9688 3.375C9.97153 3.375 8.98406 3.57142 8.06275 3.95304C7.14143 4.33466 6.3043 4.89401 5.59916 5.59916C4.89401 6.3043 4.33466 7.14143 3.95304 8.06275C3.57142 8.98406 3.375 9.97152 3.375 10.9688C3.375 11.966 3.57142 12.9534 3.95304 13.8748C4.33466 14.7961 4.89401 15.6332 5.59916 16.3383C6.3043 17.0435 7.14143 17.6028 8.06275 17.9845C8.98406 18.3661 9.97153 18.5625 10.9688 18.5625Z",fill:e})}),y.jsx("defs",{children:y.jsx("clipPath",{id:"clip0_245_1545",children:y.jsx("rect",{width:"27",height:"27",fill:"white"})})})]})},_1=()=>y.jsxs("div",{className:"ml-auto mt-5 w-fit flex items-center  mr-4",children:[y.jsx("p",{className:"mr-2  text-[#ebb625] text-xs font-medium ",children:"詳しく見る"}),y.jsx("img",{src:"/public/images/circle-right.svg",alt:""})]}),ra=[{id:1,title:"大須商店街",text:"定番の名古屋グルメはもちろんのこと、行列のできるB級グルメや多国籍レストラン、カフェなどの飲食店がずらり。地…",btnText:"電車",purpose:"飲食店",score:"1,023",image:"/images/oosu.png"},{id:2,title:"円頓寺商店街",text:"円頓寺商店街は、名古屋駅のほど近くにある、古き良き下町情緒と、新しい文化が融合した魅力あふれる商店街です。",btnText:"バス",purpose:"サブカルチャー",score:"1,201",image:"/images/endoji.png"},{id:3,title:"SAKUMACHI商店街",text:"SAKUMACHI商店街は、名鉄瀬戸線「尼ケ坂」駅と「清水」駅間の高架下に新しくできた商店街。飲食店をはじめ様々な…",btnText:"徒歩",purpose:"歴史",score:"243",image:"/images/sakumachi.png"}],xv=({setCurrentPage:n})=>{const[t,e]=$.useState(""),[r,i]=$.useState(ra),[o,s]=$.useState(null),a=d=>{const f=d.target.value;e(f),h(f,o)},u=d=>{e(d),s(d),h(d,d)},c=()=>{e(""),i(ra)},h=(d,f)=>{const g=d.toLowerCase(),_=ra.filter(v=>{const I=v.title.toLowerCase().includes(g)||v.btnText.toLowerCase().includes(g)||v.purpose.toLowerCase().includes(g)||v.score.toLowerCase().includes(g),T=f?v.btnText===f||v.purpose===f:!0;return I&&T});i(_)};return y.jsxs("div",{className:"min-h-screen",children:[y.jsx("div",{className:"bg-customBg w-full",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{onClick:()=>n("CheckInfo"),className:"pt-14 pb-3 flex",children:[y.jsx("img",{src:"/public/images/angle-left.svg",alt:"右矢印"}),y.jsx("p",{className:"mx-auto text-white",children:"探す"})]})})}),y.jsxs("div",{className:"max-w-xs mx-auto mt-6 relative",children:[y.jsx("input",{className:"w-[316px] h-9 bg-[#eaeaea] rounded-[9px] pl-3 pr-10",type:"text",placeholder:"キーワードで探す",value:t,onChange:a}),t?y.jsx("button",{className:"absolute top-2 right-4 text-gray-500",onClick:c,children:"x"}):y.jsx(Dv,{color:"#929292",width:20,height:20,classname:"absolute top-2 right-4"})]}),t!==""&&y.jsx("div",{className:"max-w-xs mx-auto mt-6",children:r.length>0?r.map(d=>y.jsxs("div",{className:"max-w-xs mt-6 mx-auto rounded-md shadow-lg pb-5",children:[y.jsxs("div",{className:"relative",children:[y.jsx("img",{className:"w-[320px]",src:d.image,alt:d.title}),y.jsxs("div",{className:"absolute bottom-10 left-2 flex items-center bg-white p-1 h-5",children:[y.jsx("img",{className:"mr-1",src:"/images/walk2.svg",alt:"icon"}),y.jsx("p",{className:"text-sm",children:d.score})]}),y.jsx("p",{className:"text-xl absolute bottom-3 left-2 flex items-center bg-white p-1 h-6",children:d.title})]}),y.jsxs("div",{className:"px-4",children:[y.jsx("p",{className:" pt-2 line-clamp-3",children:d.text}),y.jsx("div",{className:"mt-4 flex items-center",children:y.jsxs("div",{className:"flex flex-wrap gap-2",children:[y.jsx("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",children:y.jsx("span",{className:"text-white",children:d.btnText})}),y.jsx("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",children:y.jsx("span",{className:"text-white",children:d.purpose})})]})}),y.jsx(_1,{})]})]},d.id)):y.jsx("p",{className:"text-gray-600",children:"該当するアイテムが見つかりませんでした。"})}),t===""&&y.jsxs("div",{className:"max-w-xs mx-auto mt-12",children:[y.jsx("h3",{className:"text-[#513C38] font-bold text-xl",children:"交通手段で探す"}),y.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("電車"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"電車"})]}),y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("徒歩"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"徒歩"})]}),y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("バイク"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"バイク"})]}),y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("バス"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"バス"})]})]})]}),t===""&&y.jsxs("div",{className:"max-w-xs mx-auto mt-12",children:[y.jsx("h3",{className:"text-[#513C38] font-bold text-xl",children:"目的で探す"}),y.jsxs("div",{className:"flex flex-wrap gap-x-2 gap-y-3 mt-3",children:[y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("飲食店"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"飲食店"})]}),y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("歴史"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"歴史"})]}),y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("サブカルチャー"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"サブカルチャー"})]}),y.jsxs("button",{className:"bg-yellow-500 py-1 px-3 rounded-full flex items-center",onClick:()=>u("祭り・イベント"),children:[y.jsx("img",{className:"mr-1",src:"/public/images/dia.svg",alt:""}),y.jsx("span",{className:"text-white",children:"祭り・イベント"})]})]})]})]})},Mv=({setCurrentPage:n})=>y.jsxs("div",{children:[y.jsx("div",{className:"bg-customBg w-full",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{onClick:()=>n("checkinfo"),className:"pt-14 pb-3 flex ",children:[y.jsx("img",{src:"/public/images/angle-left.svg",alt:"右矢印"}),y.jsx("p",{className:" mx-auto text-white",children:"お知らせ詳細"})]})})}),y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{className:"max-w-xs mt-6 mx-auto pb-5 ",children:[y.jsx("p",{className:"text-customDay",children:"2024/9/18 10:50"}),y.jsx("h4",{className:"mb-5",children:"システムメンテナンスのお知らせ"}),y.jsx("p",{children:"【日時】2024年9月22日 02:00 - 04:00 【内容】システムの安定性向上のため、定期メンテナンスを実施いたします。この時間帯はサービスが一時的に利用できなくなります。 メンテナンス後は、システムのパフォーマンスが向上し、より快適にご利用いただける予定です。ご不便をおかけしますが、ご理解のほどよろしくお願いいたします。"})]})})]}),kv=({userInfo:n})=>{const[t,e]=$.useState("menu"),r=()=>{switch(t){case"checkinfo":return y.jsx(Nv,{setCurrentPage:e});case"checkin":return y.jsx(Ov,{setCurrentPage:e});case"setting":return y.jsx(Pv,{setCurrentPage:e});case"search":return y.jsx(xv,{setCurrentPage:e});case"admin":return y.jsx(m1,{setCurrentPage:e});case"Article":return y.jsx(Mv,{setCurrentPage:e});default:return y.jsx(Rv,{setCurrentPage:e,userInfo:n})}};return y.jsx("div",{children:r()})},Lv=({CardTitle:n,CardText:t,CardBtnText:e,CardScore:r,CardImage:i})=>y.jsx("div",{children:y.jsxs("div",{className:"max-w-xs pb-5 mx-auto mt-6 rounded-md shadow-lg",children:[y.jsxs("div",{className:"relative",children:[y.jsx("img",{className:"w-[320px]",src:i,alt:n}),y.jsxs("div",{className:"absolute flex items-center h-5 p-1 bg-white bottom-10 left-2",children:[y.jsx("img",{className:"mr-1",src:"/images/walk2.svg",alt:"icon"}),y.jsx("p",{className:"text-sm",children:r})]}),y.jsx("p",{className:"absolute flex items-center h-6 p-1 text-xl bg-white bottom-3 left-2",children:n})]}),y.jsx("p",{className:"px-4 pt-2 line-clamp-3",children:t}),y.jsxs("div",{className:"flex items-center mt-4 ml-4",children:[y.jsx(Pa,{CardBtnText:e}),y.jsx(Pa,{CardBtnText:e})]}),y.jsx(_1,{})]})}),Vv=()=>{const[n,t]=$.useState([]);return $.useEffect(()=>{(async()=>{try{const i=(await _n(gn(ae,"stores"))).docs.map(o=>({id:o.id,...o.data()}));t(i)}catch(r){console.error("Error fetching stores data: ",r)}})()},[]),y.jsxs("div",{children:[y.jsx("div",{className:"w-full bg-customBg",children:y.jsx("div",{className:"max-w-xs mx-auto",children:y.jsxs("div",{className:"flex items-center pb-3 mx-auto pt-14 w-fit",children:[y.jsx("img",{className:"mr-1",src:"/public/images/trending.svg",alt:"右矢印"}),y.jsx("p",{className:"text-white",children:"急上昇"})]})})}),y.jsx("div",{className:"mb-40",children:n.map(e=>y.jsx(Lv,{CardTitle:e.storeName||"Unnamed Store",CardText:e.description||"No description available",CardBtnText:e.tags[0]||["No tags available"],CardScore:e.score||"0",CardImage:e.imageUrl||"/images/default.png"},e.id))})]})};var ro,Da,Bv=(ro=function(n,t){return ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},ro(n,t)},function(n,t){function e(){this.constructor=n}ro(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}),Fv=function(n){function t(e){var r,i,o,s=this.constructor,a=n.call(this,e)||this;return Object.defineProperty(a,"name",{value:s.name,enumerable:!1,configurable:!0}),r=a,i=s.prototype,(o=Object.setPrototypeOf)?o(r,i):r.__proto__=i,function(u,c){c===void 0&&(c=u.constructor);var h=Error.captureStackTrace;h&&h(u,c)}(a),a}return Bv(t,n),t}(Error),Uv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),fe=function(n){function t(e){e===void 0&&(e=void 0);var r=n.call(this,e)||this;return r.message=e,r}return Uv(t,n),t.prototype.getKind=function(){return this.constructor.kind},t.kind="Exception",t}(Fv),jv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),St=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return jv(t,n),t.kind="ArgumentException",t}(fe),Hv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Z=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return Hv(t,n),t.kind="IllegalArgumentException",t}(fe),y1=function(){function n(t){if(this.binarizer=t,t===null)throw new Z("Binarizer must be non-null.")}return n.prototype.getWidth=function(){return this.binarizer.getWidth()},n.prototype.getHeight=function(){return this.binarizer.getHeight()},n.prototype.getBlackRow=function(t,e){return this.binarizer.getBlackRow(t,e)},n.prototype.getBlackMatrix=function(){return this.matrix!==null&&this.matrix!==void 0||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},n.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},n.prototype.crop=function(t,e,r,i){var o=this.binarizer.getLuminanceSource().crop(t,e,r,i);return new n(this.binarizer.createBinarizer(o))},n.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},n.prototype.rotateCounterClockwise=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new n(this.binarizer.createBinarizer(t))},n.prototype.rotateCounterClockwise45=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new n(this.binarizer.createBinarizer(t))},n.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},n}(),Gv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),xt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return Gv(t,n),t.getChecksumInstance=function(){return new t},t.kind="ChecksumException",t}(fe),Wv=function(){function n(t){this.source=t}return n.prototype.getLuminanceSource=function(){return this.source},n.prototype.getWidth=function(){return this.source.getWidth()},n.prototype.getHeight=function(){return this.source.getHeight()},n}(),wt=function(){function n(){}return n.arraycopy=function(t,e,r,i,o){for(;o--;)r[i++]=t[e++]},n.currentTimeMillis=function(){return Date.now()},n}(),zv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bu=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return zv(t,n),t.kind="IndexOutOfBoundsException",t}(fe),Xv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ah=function(n){function t(e,r){e===void 0&&(e=void 0),r===void 0&&(r=void 0);var i=n.call(this,r)||this;return i.index=e,i.message=r,i}return Xv(t,n),t.kind="ArrayIndexOutOfBoundsException",t}(Bu),qv=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},we=function(){function n(){}return n.fill=function(t,e){for(var r=0,i=t.length;r<i;r++)t[r]=e},n.fillWithin=function(t,e,r,i){n.rangeCheck(t.length,e,r);for(var o=e;o<r;o++)t[o]=i},n.rangeCheck=function(t,e,r){if(e>r)throw new Z("fromIndex("+e+") > toIndex("+r+")");if(e<0)throw new ah(e);if(r>t)throw new ah(r)},n.asList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t},n.create=function(t,e,r){return Array.from({length:t}).map(function(i){return Array.from({length:e}).fill(r)})},n.createInt32Array=function(t,e,r){return Array.from({length:t}).map(function(i){return Int32Array.from({length:e}).fill(r)})},n.equals=function(t,e){if(!t||!e||!t.length||!e.length||t.length!==e.length)return!1;for(var r=0,i=t.length;r<i;r++)if(t[r]!==e[r])return!1;return!0},n.hashCode=function(t){var e,r;if(t===null)return 0;var i=1;try{for(var o=qv(t),s=o.next();!s.done;s=o.next())i=31*i+s.value}catch(a){e={error:a}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i},n.fillUint8Array=function(t,e){for(var r=0;r!==t.length;r++)t[r]=e},n.copyOf=function(t,e){return t.slice(0,e)},n.copyOfUint8Array=function(t,e){if(t.length<=e){var r=new Uint8Array(e);return r.set(t),r}return t.slice(0,e)},n.copyOfRange=function(t,e,r){var i=r-e,o=new Int32Array(i);return wt.arraycopy(t,e,o,0,i),o},n.binarySearch=function(t,e,r){r===void 0&&(r=n.numberComparator);for(var i=0,o=t.length-1;i<=o;){var s=o+i>>1,a=r(e,t[s]);if(a>0)i=s+1;else{if(!(a<0))return s;o=s-1}}return-i-1},n.numberComparator=function(t,e){return t-e},n}(),Gt=function(){function n(){}return n.numberOfTrailingZeros=function(t){var e;if(t===0)return 32;var r=31;return(e=t<<16)!==0&&(r-=16,t=e),(e=t<<8)!==0&&(r-=8,t=e),(e=t<<4)!==0&&(r-=4,t=e),(e=t<<2)!==0&&(r-=2,t=e),r-(t<<1>>>31)},n.numberOfLeadingZeros=function(t){if(t===0)return 32;var e=1;return!(t>>>16)&&(e+=16,t<<=16),!(t>>>24)&&(e+=8,t<<=8),!(t>>>28)&&(e+=4,t<<=4),!(t>>>30)&&(e+=2,t<<=2),e-=t>>>31},n.toHexString=function(t){return t.toString(16)},n.toBinaryString=function(t){return String(parseInt(String(t),2))},n.bitCount=function(t){return t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135,t+=t>>>8,63&(t+=t>>>16)},n.truncDivision=function(t,e){return Math.trunc(t/e)},n.parseInt=function(t,e){return e===void 0&&(e=void 0),parseInt(t,e)},n.MIN_VALUE_32_BITS=-2147483648,n.MAX_VALUE=Number.MAX_SAFE_INTEGER,n}(),be=function(){function n(t,e){t===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,this.bits=e??n.makeArray(t))}return n.prototype.getSize=function(){return this.size},n.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},n.prototype.ensureCapacity=function(t){if(t>32*this.bits.length){var e=n.makeArray(t);wt.arraycopy(this.bits,0,e,0,this.bits.length),this.bits=e}},n.prototype.get=function(t){return(this.bits[Math.floor(t/32)]&1<<(31&t))!=0},n.prototype.set=function(t){this.bits[Math.floor(t/32)]|=1<<(31&t)},n.prototype.flip=function(t){this.bits[Math.floor(t/32)]^=1<<(31&t)},n.prototype.getNextSet=function(t){var e=this.size;if(t>=e)return e;var r=this.bits,i=Math.floor(t/32),o=r[i];o&=~((1<<(31&t))-1);for(var s=r.length;o===0;){if(++i===s)return e;o=r[i]}var a=32*i+Gt.numberOfTrailingZeros(o);return a>e?e:a},n.prototype.getNextUnset=function(t){var e=this.size;if(t>=e)return e;var r=this.bits,i=Math.floor(t/32),o=~r[i];o&=~((1<<(31&t))-1);for(var s=r.length;o===0;){if(++i===s)return e;o=~r[i]}var a=32*i+Gt.numberOfTrailingZeros(o);return a>e?e:a},n.prototype.setBulk=function(t,e){this.bits[Math.floor(t/32)]=e},n.prototype.setRange=function(t,e){if(e<t||t<0||e>this.size)throw new Z;if(e!==t){e--;for(var r=Math.floor(t/32),i=Math.floor(e/32),o=this.bits,s=r;s<=i;s++){var a=(2<<(s<i?31:31&e))-(1<<(s>r?0:31&t));o[s]|=a}}},n.prototype.clear=function(){for(var t=this.bits.length,e=this.bits,r=0;r<t;r++)e[r]=0},n.prototype.isRange=function(t,e,r){if(e<t||t<0||e>this.size)throw new Z;if(e===t)return!0;e--;for(var i=Math.floor(t/32),o=Math.floor(e/32),s=this.bits,a=i;a<=o;a++){var u=(2<<(a<o?31:31&e))-(1<<(a>i?0:31&t))&4294967295;if((s[a]&u)!==(r?u:0))return!1}return!0},n.prototype.appendBit=function(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++},n.prototype.appendBits=function(t,e){if(e<0||e>32)throw new Z("Num bits must be between 0 and 32");this.ensureCapacity(this.size+e);for(var r=e;r>0;r--)this.appendBit((t>>r-1&1)==1)},n.prototype.appendBitArray=function(t){var e=t.size;this.ensureCapacity(this.size+e);for(var r=0;r<e;r++)this.appendBit(t.get(r))},n.prototype.xor=function(t){if(this.size!==t.size)throw new Z("Sizes don't match");for(var e=this.bits,r=0,i=e.length;r<i;r++)e[r]^=t.bits[r]},n.prototype.toBytes=function(t,e,r,i){for(var o=0;o<i;o++){for(var s=0,a=0;a<8;a++)this.get(t)&&(s|=1<<7-a),t++;e[r+o]=s}},n.prototype.getBitArray=function(){return this.bits},n.prototype.reverse=function(){for(var t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),r=e+1,i=this.bits,o=0;o<r;o++){var s=i[o];s=(s=(s=(s=(s=s>>1&1431655765|(1431655765&s)<<1)>>2&858993459|(858993459&s)<<2)>>4&252645135|(252645135&s)<<4)>>8&16711935|(16711935&s)<<8)>>16&65535|(65535&s)<<16,t[e-o]=s}if(this.size!==32*r){var a=32*r-this.size,u=t[0]>>>a;for(o=1;o<r;o++){var c=t[o];u|=c<<32-a,t[o-1]=u,u=c>>>a}t[r-1]=u}this.bits=t},n.makeArray=function(t){return new Int32Array(Math.floor((t+31)/32))},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.size===e.size&&we.equals(this.bits,e.bits)},n.prototype.hashCode=function(){return 31*this.size+we.hashCode(this.bits)},n.prototype.toString=function(){for(var t="",e=0,r=this.size;e<r;e++)!(7&e)&&(t+=" "),t+=this.get(e)?"X":".";return t},n.prototype.clone=function(){return new n(this.size,this.bits.slice())},n}();(function(n){n[n.OTHER=0]="OTHER",n[n.PURE_BARCODE=1]="PURE_BARCODE",n[n.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",n[n.TRY_HARDER=3]="TRY_HARDER",n[n.CHARACTER_SET=4]="CHARACTER_SET",n[n.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",n[n.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",n[n.ASSUME_GS1=7]="ASSUME_GS1",n[n.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",n[n.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",n[n.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Da||(Da={}));var ht,_t=Da,$v=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),W=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return $v(t,n),t.getFormatInstance=function(){return new t},t.kind="FormatException",t}(fe),Kv=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(n){n[n.Cp437=0]="Cp437",n[n.ISO8859_1=1]="ISO8859_1",n[n.ISO8859_2=2]="ISO8859_2",n[n.ISO8859_3=3]="ISO8859_3",n[n.ISO8859_4=4]="ISO8859_4",n[n.ISO8859_5=5]="ISO8859_5",n[n.ISO8859_6=6]="ISO8859_6",n[n.ISO8859_7=7]="ISO8859_7",n[n.ISO8859_8=8]="ISO8859_8",n[n.ISO8859_9=9]="ISO8859_9",n[n.ISO8859_10=10]="ISO8859_10",n[n.ISO8859_11=11]="ISO8859_11",n[n.ISO8859_13=12]="ISO8859_13",n[n.ISO8859_14=13]="ISO8859_14",n[n.ISO8859_15=14]="ISO8859_15",n[n.ISO8859_16=15]="ISO8859_16",n[n.SJIS=16]="SJIS",n[n.Cp1250=17]="Cp1250",n[n.Cp1251=18]="Cp1251",n[n.Cp1252=19]="Cp1252",n[n.Cp1256=20]="Cp1256",n[n.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",n[n.UTF8=22]="UTF8",n[n.ASCII=23]="ASCII",n[n.Big5=24]="Big5",n[n.GB18030=25]="GB18030",n[n.EUC_KR=26]="EUC_KR"})(ht||(ht={}));var xa,le=function(){function n(t,e,r){for(var i,o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];this.valueIdentifier=t,this.name=r,this.values=typeof e=="number"?Int32Array.from([e]):e,this.otherEncodingNames=s,n.VALUE_IDENTIFIER_TO_ECI.set(t,this),n.NAME_TO_ECI.set(r,this);for(var u=this.values,c=0,h=u.length;c!==h;c++){var d=u[c];n.VALUES_TO_ECI.set(d,this)}try{for(var f=Kv(s),g=f.next();!g.done;g=f.next()){var _=g.value;n.NAME_TO_ECI.set(_,this)}}catch(v){i={error:v}}finally{try{g&&!g.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}return n.prototype.getValueIdentifier=function(){return this.valueIdentifier},n.prototype.getName=function(){return this.name},n.prototype.getValue=function(){return this.values[0]},n.getCharacterSetECIByValue=function(t){if(t<0||t>=900)throw new W("incorect value");var e=n.VALUES_TO_ECI.get(t);if(e===void 0)throw new W("incorect value");return e},n.getCharacterSetECIByName=function(t){var e=n.NAME_TO_ECI.get(t);if(e===void 0)throw new W("incorect value");return e},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.getName()===e.getName()},n.VALUE_IDENTIFIER_TO_ECI=new Map,n.VALUES_TO_ECI=new Map,n.NAME_TO_ECI=new Map,n.Cp437=new n(ht.Cp437,Int32Array.from([0,2]),"Cp437"),n.ISO8859_1=new n(ht.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),n.ISO8859_2=new n(ht.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),n.ISO8859_3=new n(ht.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),n.ISO8859_4=new n(ht.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),n.ISO8859_5=new n(ht.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),n.ISO8859_6=new n(ht.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),n.ISO8859_7=new n(ht.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),n.ISO8859_8=new n(ht.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),n.ISO8859_9=new n(ht.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),n.ISO8859_10=new n(ht.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),n.ISO8859_11=new n(ht.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),n.ISO8859_13=new n(ht.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),n.ISO8859_14=new n(ht.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),n.ISO8859_15=new n(ht.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),n.ISO8859_16=new n(ht.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),n.SJIS=new n(ht.SJIS,20,"SJIS","Shift_JIS"),n.Cp1250=new n(ht.Cp1250,21,"Cp1250","windows-1250"),n.Cp1251=new n(ht.Cp1251,22,"Cp1251","windows-1251"),n.Cp1252=new n(ht.Cp1252,23,"Cp1252","windows-1252"),n.Cp1256=new n(ht.Cp1256,24,"Cp1256","windows-1256"),n.UnicodeBigUnmarked=new n(ht.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),n.UTF8=new n(ht.UTF8,26,"UTF8","UTF-8"),n.ASCII=new n(ht.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),n.Big5=new n(ht.Big5,28,"Big5"),n.GB18030=new n(ht.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),n.EUC_KR=new n(ht.EUC_KR,30,"EUC_KR","EUC-KR"),n}(),Yv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Eo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return Yv(t,n),t.kind="UnsupportedOperationException",t}(fe),jn=function(){function n(){}return n.decode=function(t,e){var r=this.encodingName(e);return this.customDecoder?this.customDecoder(t,r):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(r)?this.decodeFallback(t,r):new TextDecoder(r).decode(t)},n.shouldDecodeOnFallback=function(t){return!n.isBrowser()&&t==="ISO-8859-1"},n.encode=function(t,e){var r=this.encodingName(e);return this.customEncoder?this.customEncoder(t,r):typeof TextEncoder>"u"?this.encodeFallback(t):new TextEncoder().encode(t)},n.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},n.encodingName=function(t){return typeof t=="string"?t:t.getName()},n.encodingCharacterSet=function(t){return t instanceof le?t:le.getCharacterSetECIByName(t)},n.decodeFallback=function(t,e){var r=this.encodingCharacterSet(e);if(n.isDecodeFallbackSupported(r)){for(var i="",o=0,s=t.length;o<s;o++){var a=t[o].toString(16);a.length<2&&(a="0"+a),i+="%"+a}return decodeURIComponent(i)}if(r.equals(le.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new Eo("Encoding "+this.encodingName(e)+" not supported by fallback.")},n.isDecodeFallbackSupported=function(t){return t.equals(le.UTF8)||t.equals(le.ISO8859_1)||t.equals(le.ASCII)},n.encodeFallback=function(t){for(var e=btoa(unescape(encodeURIComponent(t))).split(""),r=[],i=0;i<e.length;i++)r.push(e[i].charCodeAt(0));return new Uint8Array(r)},n}(),Vt=function(){function n(){}return n.castAsNonUtf8Char=function(t,e){e===void 0&&(e=null);var r=e?e.getName():this.ISO88591;return jn.decode(new Uint8Array([t]),r)},n.guessEncoding=function(t,e){if(e!=null&&e.get(_t.CHARACTER_SET)!==void 0)return e.get(_t.CHARACTER_SET).toString();for(var r=t.length,i=!0,o=!0,s=!0,a=0,u=0,c=0,h=0,d=0,f=0,g=0,_=0,v=0,I=0,T=0,N=t.length>3&&t[0]===239&&t[1]===187&&t[2]===191,k=0;k<r&&(i||o||s);k++){var P=255&t[k];s&&(a>0?128&P?a--:s=!1:128&P&&(64&P?(a++,32&P?(a++,16&P?(a++,8&P?s=!1:h++):c++):u++):s=!1)),i&&(P>127&&P<160?i=!1:P>159&&(P<192||P===215||P===247)&&T++),o&&(d>0?P<64||P===127||P>252?o=!1:d--:P===128||P===160||P>239?o=!1:P>160&&P<224?(f++,_=0,++g>v&&(v=g)):P>127?(d++,g=0,++_>I&&(I=_)):(g=0,_=0))}return s&&a>0&&(s=!1),o&&d>0&&(o=!1),s&&(N||u+c+h>0)?n.UTF8:o&&(n.ASSUME_SHIFT_JIS||v>=3||I>=3)?n.SHIFT_JIS:i&&o?v===2&&f===2||10*T>=r?n.SHIFT_JIS:n.ISO88591:i?n.ISO88591:o?n.SHIFT_JIS:s?n.UTF8:n.PLATFORM_DEFAULT_ENCODING},n.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var i=-1;function o(a,u,c,h,d,f){if(a==="%%")return"%";if(e[++i]!==void 0){a=h?parseInt(h.substr(1)):void 0;var g,_=d?parseInt(d.substr(1)):void 0;switch(f){case"s":g=e[i];break;case"c":g=e[i][0];break;case"f":g=parseFloat(e[i]).toFixed(a);break;case"p":g=parseFloat(e[i]).toPrecision(a);break;case"e":g=parseFloat(e[i]).toExponential(a);break;case"x":g=parseInt(e[i]).toString(_||16);break;case"d":g=parseFloat(parseInt(e[i],_||10).toPrecision(a)).toFixed(0)}g=typeof g=="object"?JSON.stringify(g):(+g).toString(_);for(var v=parseInt(c),I=c&&c[0]+""=="0"?"0":" ";g.length<v;)g=u!==void 0?g+I:I+g;return g}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(s,o)},n.getBytes=function(t,e){return jn.encode(t,e)},n.getCharCode=function(t,e){return e===void 0&&(e=0),t.charCodeAt(e)},n.getCharAt=function(t){return String.fromCharCode(t)},n.SHIFT_JIS=le.SJIS.getName(),n.GB2312="GB2312",n.ISO88591=le.ISO8859_1.getName(),n.EUC_JP="EUC_JP",n.UTF8=le.UTF8.getName(),n.PLATFORM_DEFAULT_ENCODING=n.UTF8,n.ASSUME_SHIFT_JIS=!1,n}(),pt=function(){function n(t){t===void 0&&(t=""),this.value=t}return n.prototype.enableDecoding=function(t){return this.encoding=t,this},n.prototype.append=function(t){return typeof t=="string"?this.value+=t.toString():this.encoding?this.value+=Vt.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this},n.prototype.appendChars=function(t,e,r){for(var i=e;e<e+r;i++)this.append(t[i]);return this},n.prototype.length=function(){return this.value.length},n.prototype.charAt=function(t){return this.value.charAt(t)},n.prototype.deleteCharAt=function(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)},n.prototype.setCharAt=function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)},n.prototype.substring=function(t,e){return this.value.substring(t,e)},n.prototype.setLengthToZero=function(){this.value=""},n.prototype.toString=function(){return this.value},n.prototype.insert=function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+e.length)},n}(),Qe=function(){function n(t,e,r,i){if(this.width=t,this.height=e,this.rowSize=r,this.bits=i,e==null&&(e=t),this.height=e,t<1||e<1)throw new Z("Both dimensions must be greater than 0");r==null&&(r=Math.floor((t+31)/32)),this.rowSize=r,i==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return n.parseFromBooleanArray=function(t){for(var e=t.length,r=t[0].length,i=new n(r,e),o=0;o<e;o++)for(var s=t[o],a=0;a<r;a++)s[a]&&i.set(a,o);return i},n.parseFromString=function(t,e,r){if(t===null)throw new Z("stringRepresentation cannot be null");for(var i=new Array(t.length),o=0,s=0,a=-1,u=0,c=0;c<t.length;)if(t.charAt(c)===`
`||t.charAt(c)==="\r"){if(o>s){if(a===-1)a=o-s;else if(o-s!==a)throw new Z("row lengths do not match");s=o,u++}c++}else if(t.substring(c,c+e.length)===e)c+=e.length,i[o]=!0,o++;else{if(t.substring(c,c+r.length)!==r)throw new Z("illegal character encountered: "+t.substring(c));c+=r.length,i[o]=!1,o++}if(o>s){if(a===-1)a=o-s;else if(o-s!==a)throw new Z("row lengths do not match");u++}for(var h=new n(a,u),d=0;d<o;d++)i[d]&&h.set(Math.floor(d%a),Math.floor(d/a));return h},n.prototype.get=function(t,e){var r=e*this.rowSize+Math.floor(t/32);return(this.bits[r]>>>(31&t)&1)!=0},n.prototype.set=function(t,e){var r=e*this.rowSize+Math.floor(t/32);this.bits[r]|=1<<(31&t)&4294967295},n.prototype.unset=function(t,e){var r=e*this.rowSize+Math.floor(t/32);this.bits[r]&=~(1<<(31&t)&4294967295)},n.prototype.flip=function(t,e){var r=e*this.rowSize+Math.floor(t/32);this.bits[r]^=1<<(31&t)&4294967295},n.prototype.xor=function(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new Z("input matrix dimensions do not match");for(var e=new be(Math.floor(this.width/32)+1),r=this.rowSize,i=this.bits,o=0,s=this.height;o<s;o++)for(var a=o*r,u=t.getRow(o,e).getBitArray(),c=0;c<r;c++)i[a+c]^=u[c]},n.prototype.clear=function(){for(var t=this.bits,e=t.length,r=0;r<e;r++)t[r]=0},n.prototype.setRegion=function(t,e,r,i){if(e<0||t<0)throw new Z("Left and top must be nonnegative");if(i<1||r<1)throw new Z("Height and width must be at least 1");var o=t+r,s=e+i;if(s>this.height||o>this.width)throw new Z("The region must fit inside the matrix");for(var a=this.rowSize,u=this.bits,c=e;c<s;c++)for(var h=c*a,d=t;d<o;d++)u[h+Math.floor(d/32)]|=1<<(31&d)&4294967295},n.prototype.getRow=function(t,e){e==null||e.getSize()<this.width?e=new be(this.width):e.clear();for(var r=this.rowSize,i=this.bits,o=t*r,s=0;s<r;s++)e.setBulk(32*s,i[o+s]);return e},n.prototype.setRow=function(t,e){wt.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)},n.prototype.rotate180=function(){for(var t=this.getWidth(),e=this.getHeight(),r=new be(t),i=new be(t),o=0,s=Math.floor((e+1)/2);o<s;o++)r=this.getRow(o,r),i=this.getRow(e-1-o,i),r.reverse(),i.reverse(),this.setRow(o,i),this.setRow(e-1-o,r)},n.prototype.getEnclosingRectangle=function(){for(var t=this.width,e=this.height,r=this.rowSize,i=this.bits,o=t,s=e,a=-1,u=-1,c=0;c<e;c++)for(var h=0;h<r;h++){var d=i[c*r+h];if(d!==0){if(c<s&&(s=c),c>u&&(u=c),32*h<o){for(var f=0;!(d<<31-f&4294967295);)f++;32*h+f<o&&(o=32*h+f)}if(32*h+31>a){for(f=31;!(d>>>f);)f--;32*h+f>a&&(a=32*h+f)}}}return a<o||u<s?null:Int32Array.from([o,s,a-o+1,u-s+1])},n.prototype.getTopLeftOnBit=function(){for(var t=this.rowSize,e=this.bits,r=0;r<e.length&&e[r]===0;)r++;if(r===e.length)return null;for(var i=r/t,o=r%t*32,s=e[r],a=0;!(s<<31-a&4294967295);)a++;return o+=a,Int32Array.from([o,i])},n.prototype.getBottomRightOnBit=function(){for(var t=this.rowSize,e=this.bits,r=e.length-1;r>=0&&e[r]===0;)r--;if(r<0)return null;for(var i=Math.floor(r/t),o=32*Math.floor(r%t),s=e[r],a=31;!(s>>>a);)a--;return o+=a,Int32Array.from([o,i])},n.prototype.getWidth=function(){return this.width},n.prototype.getHeight=function(){return this.height},n.prototype.getRowSize=function(){return this.rowSize},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.width===e.width&&this.height===e.height&&this.rowSize===e.rowSize&&we.equals(this.bits,e.bits)},n.prototype.hashCode=function(){var t=this.width;return t=31*(t=31*(t=31*(t=31*t+this.width)+this.height)+this.rowSize)+we.hashCode(this.bits)},n.prototype.toString=function(t,e,r){return t===void 0&&(t="X "),e===void 0&&(e="  "),r===void 0&&(r=`
`),this.buildToString(t,e,r)},n.prototype.buildToString=function(t,e,r){for(var i=new pt,o=0,s=this.height;o<s;o++){for(var a=0,u=this.width;a<u;a++)i.append(this.get(a,o)?t:e);i.append(r)}return i.toString()},n.prototype.clone=function(){return new n(this.width,this.height,this.rowSize,this.bits.slice())},n}(),Qv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),V=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return Qv(t,n),t.getNotFoundInstance=function(){return new t},t.kind="NotFoundException",t}(fe),Zv=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jv=function(n){function t(e){var r=n.call(this,e)||this;return r.luminances=t.EMPTY,r.buckets=new Int32Array(t.LUMINANCE_BUCKETS),r}return Zv(t,n),t.prototype.getBlackRow=function(e,r){var i=this.getLuminanceSource(),o=i.getWidth();r==null||r.getSize()<o?r=new be(o):r.clear(),this.initArrays(o);for(var s=i.getRow(e,this.luminances),a=this.buckets,u=0;u<o;u++)a[(255&s[u])>>t.LUMINANCE_SHIFT]++;var c=t.estimateBlackPoint(a);if(o<3)for(u=0;u<o;u++)(255&s[u])<c&&r.set(u);else{var h=255&s[0],d=255&s[1];for(u=1;u<o-1;u++){var f=255&s[u+1];(4*d-h-f)/2<c&&r.set(u),h=d,d=f}}return r},t.prototype.getBlackMatrix=function(){var e=this.getLuminanceSource(),r=e.getWidth(),i=e.getHeight(),o=new Qe(r,i);this.initArrays(r);for(var s=this.buckets,a=1;a<5;a++)for(var u=Math.floor(i*a/5),c=e.getRow(u,this.luminances),h=Math.floor(4*r/5),d=Math.floor(r/5);d<h;d++)s[(255&c[d])>>t.LUMINANCE_SHIFT]++;var f=t.estimateBlackPoint(s),g=e.getMatrix();for(a=0;a<i;a++){var _=a*r;for(d=0;d<r;d++)(255&g[_+d])<f&&o.set(d,a)}return o},t.prototype.createBinarizer=function(e){return new t(e)},t.prototype.initArrays=function(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));for(var r=this.buckets,i=0;i<t.LUMINANCE_BUCKETS;i++)r[i]=0},t.estimateBlackPoint=function(e){for(var r=e.length,i=0,o=0,s=0,a=0;a<r;a++)e[a]>s&&(o=a,s=e[a]),e[a]>i&&(i=e[a]);var u=0,c=0;for(a=0;a<r;a++){var h=a-o;(_=e[a]*h*h)>c&&(u=a,c=_)}if(o>u){var d=o;o=u,u=d}if(u-o<=r/16)throw new V;var f=u-1,g=-1;for(a=u-1;a>o;a--){var _,v=a-o;(_=v*v*(u-a)*(i-e[a]))>g&&(f=a,g=_)}return f<<t.LUMINANCE_SHIFT},t.LUMINANCE_BITS=5,t.LUMINANCE_SHIFT=8-t.LUMINANCE_BITS,t.LUMINANCE_BUCKETS=1<<t.LUMINANCE_BITS,t.EMPTY=Uint8ClampedArray.from([0]),t}(Wv),tE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),w1=function(n){function t(e){var r=n.call(this,e)||this;return r.matrix=null,r}return tE(t,n),t.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var e=this.getLuminanceSource(),r=e.getWidth(),i=e.getHeight();if(r>=t.MINIMUM_DIMENSION&&i>=t.MINIMUM_DIMENSION){var o=e.getMatrix(),s=r>>t.BLOCK_SIZE_POWER;r&t.BLOCK_SIZE_MASK&&s++;var a=i>>t.BLOCK_SIZE_POWER;i&t.BLOCK_SIZE_MASK&&a++;var u=t.calculateBlackPoints(o,s,a,r,i),c=new Qe(r,i);t.calculateThresholdForBlock(o,s,a,r,i,u,c),this.matrix=c}else this.matrix=n.prototype.getBlackMatrix.call(this);return this.matrix},t.prototype.createBinarizer=function(e){return new t(e)},t.calculateThresholdForBlock=function(e,r,i,o,s,a,u){for(var c=s-t.BLOCK_SIZE,h=o-t.BLOCK_SIZE,d=0;d<i;d++){var f=d<<t.BLOCK_SIZE_POWER;f>c&&(f=c);for(var g=t.cap(d,2,i-3),_=0;_<r;_++){var v=_<<t.BLOCK_SIZE_POWER;v>h&&(v=h);for(var I=t.cap(_,2,r-3),T=0,N=-2;N<=2;N++){var k=a[g+N];T+=k[I-2]+k[I-1]+k[I]+k[I+1]+k[I+2]}var P=T/25;t.thresholdBlock(e,v,f,P,o,u)}}},t.cap=function(e,r,i){return e<r?r:e>i?i:e},t.thresholdBlock=function(e,r,i,o,s,a){for(var u=0,c=i*s+r;u<t.BLOCK_SIZE;u++,c+=s)for(var h=0;h<t.BLOCK_SIZE;h++)(255&e[c+h])<=o&&a.set(r+h,i+u)},t.calculateBlackPoints=function(e,r,i,o,s){for(var a=s-t.BLOCK_SIZE,u=o-t.BLOCK_SIZE,c=new Array(i),h=0;h<i;h++){c[h]=new Int32Array(r);var d=h<<t.BLOCK_SIZE_POWER;d>a&&(d=a);for(var f=0;f<r;f++){var g=f<<t.BLOCK_SIZE_POWER;g>u&&(g=u);for(var _=0,v=255,I=0,T=0,N=d*o+g;T<t.BLOCK_SIZE;T++,N+=o){for(var k=0;k<t.BLOCK_SIZE;k++){var P=255&e[N+k];_+=P,P<v&&(v=P),P>I&&(I=P)}if(I-v>t.MIN_DYNAMIC_RANGE)for(T++,N+=o;T<t.BLOCK_SIZE;T++,N+=o)for(k=0;k<t.BLOCK_SIZE;k++)_+=255&e[N+k]}var B=_>>2*t.BLOCK_SIZE_POWER;if(I-v<=t.MIN_DYNAMIC_RANGE&&(B=v/2,h>0&&f>0)){var F=(c[h-1][f]+2*c[h][f-1]+c[h-1][f-1])/4;v<F&&(B=F)}c[h][f]=B}}return c},t.BLOCK_SIZE_POWER=3,t.BLOCK_SIZE=1<<t.BLOCK_SIZE_POWER,t.BLOCK_SIZE_MASK=t.BLOCK_SIZE-1,t.MINIMUM_DIMENSION=5*t.BLOCK_SIZE,t.MIN_DYNAMIC_RANGE=24,t}(Jv),Ni=function(){function n(t,e){this.width=t,this.height=e}return n.prototype.getWidth=function(){return this.width},n.prototype.getHeight=function(){return this.height},n.prototype.isCropSupported=function(){return!1},n.prototype.crop=function(t,e,r,i){throw new Eo("This luminance source does not support cropping.")},n.prototype.isRotateSupported=function(){return!1},n.prototype.rotateCounterClockwise=function(){throw new Eo("This luminance source does not support rotation by 90 degrees.")},n.prototype.rotateCounterClockwise45=function(){throw new Eo("This luminance source does not support rotation by 45 degrees.")},n.prototype.toString=function(){for(var t=new Uint8ClampedArray(this.width),e=new pt,r=0;r<this.height;r++){for(var i=this.getRow(r,t),o=0;o<this.width;o++){var s=255&i[o],a=void 0;a=s<64?"#":s<128?"+":s<192?".":" ",e.append(a)}e.append(`
`)}return e.toString()},n}(),eE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ps=function(n){function t(e){var r=n.call(this,e.getWidth(),e.getHeight())||this;return r.delegate=e,r}return eE(t,n),t.prototype.getRow=function(e,r){for(var i=this.delegate.getRow(e,r),o=this.getWidth(),s=0;s<o;s++)i[s]=255-(255&i[s]);return i},t.prototype.getMatrix=function(){for(var e=this.delegate.getMatrix(),r=this.getWidth()*this.getHeight(),i=new Uint8ClampedArray(r),o=0;o<r;o++)i[o]=255-(255&e[o]);return i},t.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},t.prototype.crop=function(e,r,i,o){return new t(this.delegate.crop(e,r,i,o))},t.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},t.prototype.invert=function(){return this.delegate},t.prototype.rotateCounterClockwise=function(){return new t(this.delegate.rotateCounterClockwise())},t.prototype.rotateCounterClockwise45=function(){return new t(this.delegate.rotateCounterClockwise45())},t}(Ni),nE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),rE=function(n){function t(e){var r=n.call(this,e.width,e.height)||this;return r.canvas=e,r.tempCanvasElement=null,r.buffer=t.makeBufferFromCanvasImageData(e),r}return nE(t,n),t.makeBufferFromCanvasImageData=function(e){var r=e.getContext("2d").getImageData(0,0,e.width,e.height);return t.toGrayscaleBuffer(r.data,e.width,e.height)},t.toGrayscaleBuffer=function(e,r,i){for(var o=new Uint8ClampedArray(r*i),s=0,a=0,u=e.length;s<u;s+=4,a++){var c=void 0;e[s+3]===0?c=255:c=306*e[s]+601*e[s+1]+117*e[s+2]+512>>10,o[a]=c}return o},t.prototype.getRow=function(e,r){if(e<0||e>=this.getHeight())throw new Z("Requested row is outside the image: "+e);var i=this.getWidth(),o=e*i;return r===null?r=this.buffer.slice(o,o+i):(r.length<i&&(r=new Uint8ClampedArray(i)),r.set(this.buffer.slice(o,o+i))),r},t.prototype.getMatrix=function(){return this.buffer},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(e,r,i,o){return n.prototype.crop.call(this,e,r,i,o),this},t.prototype.isRotateSupported=function(){return!0},t.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},t.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},t.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement},t.prototype.rotate=function(e){var r=this.getTempCanvasElement(),i=r.getContext("2d"),o=e*t.DEGREE_TO_RADIANS,s=this.canvas.width,a=this.canvas.height,u=Math.ceil(Math.abs(Math.cos(o))*s+Math.abs(Math.sin(o))*a),c=Math.ceil(Math.abs(Math.sin(o))*s+Math.abs(Math.cos(o))*a);return r.width=u,r.height=c,i.translate(u/2,c/2),i.rotate(o),i.drawImage(this.canvas,s/-2,a/-2),this.buffer=t.makeBufferFromCanvasImageData(r),this},t.prototype.invert=function(){return new ps(this)},t.DEGREE_TO_RADIANS=Math.PI/180,t}(Ni),iE=function(){function n(t,e,r){this.deviceId=t,this.label=e,this.kind="videoinput",this.groupId=r||void 0}return n.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},n}(),oe=function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function s(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){var h;c.done?i(c.value):(h=c.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}u((r=r.apply(n,[])).next())})},se=function(n,t){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return function(h){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&h[0]?r.return:h[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,h[1])).done)return i;switch(r=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,r=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||h[0]!==6&&h[0]!==2)){s=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){s.label=h[1];break}if(h[0]===6&&s.label<i[1]){s.label=i[1],i=h;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(h);break}i[2]&&s.ops.pop(),s.trys.pop();continue}h=t.call(n,s)}catch(d){h=[6,d],r=0}finally{e=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([u,c])}}},oE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Cr=function(){function n(t,e,r){e===void 0&&(e=500),this.reader=t,this.timeBetweenScansMillis=e,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(n.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canEnumerateDevices",{get:function(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(t){this._timeBetweenDecodingAttempts=t<0?0:t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hints",{get:function(){return this._hints},set:function(t){this._hints=t||null},enumerable:!1,configurable:!0}),n.prototype.listVideoInputDevices=function(){return oe(this,void 0,void 0,function(){var t,e,r,i,o,s,a,u,c,h,d,f;return se(this,function(g){switch(g.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:t=g.sent(),e=[];try{for(r=oE(t),i=r.next();!i.done;i=r.next())o=i.value,(s=o.kind==="video"?"videoinput":o.kind)==="videoinput"&&(a=o.deviceId||o.id,u=o.label||"Video device "+(e.length+1),c=o.groupId,h={deviceId:a,label:u,kind:s,groupId:c},e.push(h))}catch(_){d={error:_}}finally{try{i&&!i.done&&(f=r.return)&&f.call(r)}finally{if(d)throw d.error}}return[2,e]}})})},n.prototype.getVideoInputDevices=function(){return oe(this,void 0,void 0,function(){return se(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return[2,t.sent().map(function(e){return new iE(e.deviceId,e.label)})]}})})},n.prototype.findDeviceById=function(t){return oe(this,void 0,void 0,function(){var e;return se(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return(e=r.sent())?[2,e.find(function(i){return i.deviceId===t})]:[2,null]}})})},n.prototype.decodeFromInputVideoDevice=function(t,e){return oe(this,void 0,void 0,function(){return se(this,function(r){switch(r.label){case 0:return[4,this.decodeOnceFromVideoDevice(t,e)];case 1:return[2,r.sent()]}})})},n.prototype.decodeOnceFromVideoDevice=function(t,e){return oe(this,void 0,void 0,function(){var r;return se(this,function(i){switch(i.label){case 0:return this.reset(),r={video:t?{deviceId:{exact:t}}:{facingMode:"environment"}},[4,this.decodeOnceFromConstraints(r,e)];case 1:return[2,i.sent()]}})})},n.prototype.decodeOnceFromConstraints=function(t,e){return oe(this,void 0,void 0,function(){var r;return se(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return r=i.sent(),[4,this.decodeOnceFromStream(r,e)];case 2:return[2,i.sent()]}})})},n.prototype.decodeOnceFromStream=function(t,e){return oe(this,void 0,void 0,function(){var r;return se(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(t,e)];case 1:return r=i.sent(),[4,this.decodeOnce(r)];case 2:return[2,i.sent()]}})})},n.prototype.decodeFromInputVideoDeviceContinuously=function(t,e,r){return oe(this,void 0,void 0,function(){return se(this,function(i){switch(i.label){case 0:return[4,this.decodeFromVideoDevice(t,e,r)];case 1:return[2,i.sent()]}})})},n.prototype.decodeFromVideoDevice=function(t,e,r){return oe(this,void 0,void 0,function(){var i;return se(this,function(o){switch(o.label){case 0:return i={video:t?{deviceId:{exact:t}}:{facingMode:"environment"}},[4,this.decodeFromConstraints(i,e,r)];case 1:return[2,o.sent()]}})})},n.prototype.decodeFromConstraints=function(t,e,r){return oe(this,void 0,void 0,function(){var i;return se(this,function(o){switch(o.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return i=o.sent(),[4,this.decodeFromStream(i,e,r)];case 2:return[2,o.sent()]}})})},n.prototype.decodeFromStream=function(t,e,r){return oe(this,void 0,void 0,function(){var i;return se(this,function(o){switch(o.label){case 0:return this.reset(),[4,this.attachStreamToVideo(t,e)];case 1:return i=o.sent(),[4,this.decodeContinuously(i,r)];case 2:return[2,o.sent()]}})})},n.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},n.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},n.prototype.attachStreamToVideo=function(t,e){return oe(this,void 0,void 0,function(){var r;return se(this,function(i){switch(i.label){case 0:return r=this.prepareVideoElement(e),this.addVideoSource(r,t),this.videoElement=r,this.stream=t,[4,this.playVideoOnLoadAsync(r)];case 1:return i.sent(),[2,r]}})})},n.prototype.playVideoOnLoadAsync=function(t){var e=this;return new Promise(function(r,i){return e.playVideoOnLoad(t,function(){return r()})})},n.prototype.playVideoOnLoad=function(t,e){var r=this;this.videoEndedListener=function(){return r.stopStreams()},this.videoCanPlayListener=function(){return r.tryPlayVideo(t)},t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",e),this.tryPlayVideo(t)},n.prototype.isVideoPlaying=function(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2},n.prototype.tryPlayVideo=function(t){return oe(this,void 0,void 0,function(){return se(this,function(e){switch(e.label){case 0:if(this.isVideoPlaying(t))return console.warn("Trying to play video that is already playing."),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.play()];case 2:return e.sent(),[3,4];case 3:return e.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},n.prototype.getMediaElement=function(t,e){var r=document.getElementById(t);if(!r)throw new St("element with id '"+t+"' not found");if(r.nodeName.toLowerCase()!==e.toLowerCase())throw new St("element with id '"+t+"' must be an "+e+" element");return r},n.prototype.decodeFromImage=function(t,e){if(!t&&!e)throw new St("either imageElement with a src set or an url must be provided");return e&&!t?this.decodeFromImageUrl(e):this.decodeFromImageElement(t)},n.prototype.decodeFromVideo=function(t,e){if(!t&&!e)throw new St("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrl(e):this.decodeFromVideoElement(t)},n.prototype.decodeFromVideoContinuously=function(t,e,r){if(t===void 0&&e===void 0)throw new St("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrlContinuously(e,r):this.decodeFromVideoElementContinuously(t,r)},n.prototype.decodeFromImageElement=function(t){if(!t)throw new St("An image element must be provided.");this.reset();var e=this.prepareImageElement(t);return this.imageElement=e,this.isImageLoaded(e)?this.decodeOnce(e,!1,!0):this._decodeOnLoadImage(e)},n.prototype.decodeFromVideoElement=function(t){var e=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(e)},n.prototype.decodeFromVideoElementContinuously=function(t,e){var r=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(r,e)},n.prototype._decodeFromVideoElementSetup=function(t){if(!t)throw new St("A video element must be provided.");this.reset();var e=this.prepareVideoElement(t);return this.videoElement=e,e},n.prototype.decodeFromImageUrl=function(t){if(!t)throw new St("An URL must be provided.");this.reset();var e=this.prepareImageElement();this.imageElement=e;var r=this._decodeOnLoadImage(e);return e.src=t,r},n.prototype.decodeFromVideoUrl=function(t){if(!t)throw new St("An URL must be provided.");this.reset();var e=this.prepareVideoElement(),r=this.decodeFromVideoElement(e);return e.src=t,r},n.prototype.decodeFromVideoUrlContinuously=function(t,e){if(!t)throw new St("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),i=this.decodeFromVideoElementContinuously(r,e);return r.src=t,i},n.prototype._decodeOnLoadImage=function(t){var e=this;return new Promise(function(r,i){e.imageLoadedListener=function(){return e.decodeOnce(t,!1,!0).then(r,i)},t.addEventListener("load",e.imageLoadedListener)})},n.prototype._decodeOnLoadVideo=function(t){return oe(this,void 0,void 0,function(){return se(this,function(e){switch(e.label){case 0:return[4,this.playVideoOnLoadAsync(t)];case 1:return e.sent(),[4,this.decodeOnce(t)];case 2:return[2,e.sent()]}})})},n.prototype._decodeOnLoadVideoContinuously=function(t,e){return oe(this,void 0,void 0,function(){return se(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(t)];case 1:return r.sent(),this.decodeContinuously(t,e),[2]}})})},n.prototype.isImageLoaded=function(t){return!!t.complete&&t.naturalWidth!==0},n.prototype.prepareImageElement=function(t){var e;return t===void 0&&((e=document.createElement("img")).width=200,e.height=200),typeof t=="string"&&(e=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(e=t),e},n.prototype.prepareVideoElement=function(t){var e;return t||typeof document>"u"||((e=document.createElement("video")).width=200,e.height=200),typeof t=="string"&&(e=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(e=t),e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e},n.prototype.decodeOnce=function(t,e,r){var i=this;e===void 0&&(e=!0),r===void 0&&(r=!0),this._stopAsyncDecode=!1;var o=function(s,a){if(i._stopAsyncDecode)return a(new V("Video stream has ended before any code could be detected.")),void(i._stopAsyncDecode=void 0);try{s(i.decode(t))}catch(u){if(e&&u instanceof V||(u instanceof xt||u instanceof W)&&r)return setTimeout(o,i._timeBetweenDecodingAttempts,s,a);a(u)}};return new Promise(function(s,a){return o(s,a)})},n.prototype.decodeContinuously=function(t,e){var r=this;this._stopContinuousDecode=!1;var i=function(){if(r._stopContinuousDecode)r._stopContinuousDecode=void 0;else try{var o=r.decode(t);e(o,null),setTimeout(i,r.timeBetweenScansMillis)}catch(s){e(null,s),(s instanceof xt||s instanceof W||s instanceof V)&&setTimeout(i,r._timeBetweenDecodingAttempts)}};i()},n.prototype.decode=function(t){var e=this.createBinaryBitmap(t);return this.decodeBitmap(e)},n.prototype.createBinaryBitmap=function(t){var e=this.getCaptureCanvasContext(t);this.drawImageOnCanvas(e,t);var r=this.getCaptureCanvas(t),i=new rE(r),o=new w1(i);return new y1(o)},n.prototype.getCaptureCanvasContext=function(t){if(!this.captureCanvasContext){var e=this.getCaptureCanvas(t).getContext("2d");this.captureCanvasContext=e}return this.captureCanvasContext},n.prototype.getCaptureCanvas=function(t){if(!this.captureCanvas){var e=this.createCaptureCanvas(t);this.captureCanvas=e}return this.captureCanvas},n.prototype.drawImageOnCanvas=function(t,e){t.drawImage(e,0,0)},n.prototype.decodeBitmap=function(t){return this.reader.decode(t,this._hints)},n.prototype.createCaptureCanvas=function(t){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var e,r,i=document.createElement("canvas");return t!==void 0&&(t instanceof HTMLVideoElement?(e=t.videoWidth,r=t.videoHeight):t instanceof HTMLImageElement&&(e=t.naturalWidth||t.width,r=t.naturalHeight||t.height)),i.style.width=e+"px",i.style.height=r+"px",i.width=e,i.height=r,i},n.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(t){return t.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},n.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},n.prototype._destroyVideoElement=function(){this.videoElement&&(this.videoEndedListener!==void 0&&this.videoElement.removeEventListener("ended",this.videoEndedListener),this.videoPlayingEventListener!==void 0&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),this.videoCanPlayListener!==void 0&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},n.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},n.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},n.prototype.addVideoSource=function(t,e){try{t.srcObject=e}catch{t.src=URL.createObjectURL(e)}},n.prototype.cleanVideoSource=function(t){try{t.srcObject=null}catch{t.src=""}this.videoElement.removeAttribute("src")},n}(),pe=function(){function n(t,e,r,i,o,s){r===void 0&&(r=e==null?0:8*e.length),s===void 0&&(s=wt.currentTimeMillis()),this.text=t,this.rawBytes=e,this.numBits=r,this.resultPoints=i,this.format=o,this.timestamp=s,this.text=t,this.rawBytes=e,this.numBits=r??(e==null?0:8*e.length),this.resultPoints=i,this.format=o,this.resultMetadata=null,this.timestamp=s??wt.currentTimeMillis()}return n.prototype.getText=function(){return this.text},n.prototype.getRawBytes=function(){return this.rawBytes},n.prototype.getNumBits=function(){return this.numBits},n.prototype.getResultPoints=function(){return this.resultPoints},n.prototype.getBarcodeFormat=function(){return this.format},n.prototype.getResultMetadata=function(){return this.resultMetadata},n.prototype.putMetadata=function(t,e){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)},n.prototype.putAllMetadata=function(t){t!==null&&(this.resultMetadata===null?this.resultMetadata=t:this.resultMetadata=new Map(t))},n.prototype.addResultPoints=function(t){var e=this.resultPoints;if(e===null)this.resultPoints=t;else if(t!==null&&t.length>0){var r=new Array(e.length+t.length);wt.arraycopy(e,0,r,0,e.length),wt.arraycopy(t,0,r,e.length,t.length),this.resultPoints=r}},n.prototype.getTimestamp=function(){return this.timestamp},n.prototype.toString=function(){return this.text},n}();(function(n){n[n.AZTEC=0]="AZTEC",n[n.CODABAR=1]="CODABAR",n[n.CODE_39=2]="CODE_39",n[n.CODE_93=3]="CODE_93",n[n.CODE_128=4]="CODE_128",n[n.DATA_MATRIX=5]="DATA_MATRIX",n[n.EAN_8=6]="EAN_8",n[n.EAN_13=7]="EAN_13",n[n.ITF=8]="ITF",n[n.MAXICODE=9]="MAXICODE",n[n.PDF_417=10]="PDF_417",n[n.QR_CODE=11]="QR_CODE",n[n.RSS_14=12]="RSS_14",n[n.RSS_EXPANDED=13]="RSS_EXPANDED",n[n.UPC_A=14]="UPC_A",n[n.UPC_E=15]="UPC_E",n[n.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(xa||(xa={}));var Ma,Y=xa;(function(n){n[n.OTHER=0]="OTHER",n[n.ORIENTATION=1]="ORIENTATION",n[n.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",n[n.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",n[n.ISSUE_NUMBER=4]="ISSUE_NUMBER",n[n.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",n[n.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",n[n.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",n[n.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",n[n.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",n[n.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ma||(Ma={}));var Ut,Wt=Ma,gs=function(){function n(t,e,r,i,o,s){o===void 0&&(o=-1),s===void 0&&(s=-1),this.rawBytes=t,this.text=e,this.byteSegments=r,this.ecLevel=i,this.structuredAppendSequenceNumber=o,this.structuredAppendParity=s,this.numBits=t==null?0:8*t.length}return n.prototype.getRawBytes=function(){return this.rawBytes},n.prototype.getNumBits=function(){return this.numBits},n.prototype.setNumBits=function(t){this.numBits=t},n.prototype.getText=function(){return this.text},n.prototype.getByteSegments=function(){return this.byteSegments},n.prototype.getECLevel=function(){return this.ecLevel},n.prototype.getErrorsCorrected=function(){return this.errorsCorrected},n.prototype.setErrorsCorrected=function(t){this.errorsCorrected=t},n.prototype.getErasures=function(){return this.erasures},n.prototype.setErasures=function(t){this.erasures=t},n.prototype.getOther=function(){return this.other},n.prototype.setOther=function(t){this.other=t},n.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},n.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},n.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},n}(),Zr=function(){function n(){}return n.prototype.exp=function(t){return this.expTable[t]},n.prototype.log=function(t){if(t===0)throw new Z;return this.logTable[t]},n.addOrSubtract=function(t,e){return t^e},n}(),ui=function(){function n(t,e){if(e.length===0)throw new Z;this.field=t;var r=e.length;if(r>1&&e[0]===0){for(var i=1;i<r&&e[i]===0;)i++;i===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-i),wt.arraycopy(e,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}return n.prototype.getCoefficients=function(){return this.coefficients},n.prototype.getDegree=function(){return this.coefficients.length-1},n.prototype.isZero=function(){return this.coefficients[0]===0},n.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},n.prototype.evaluateAt=function(t){if(t===0)return this.getCoefficient(0);var e,r=this.coefficients;if(t===1){e=0;for(var i=0,o=r.length;i!==o;i++){var s=r[i];e=Zr.addOrSubtract(e,s)}return e}e=r[0];var a=r.length,u=this.field;for(i=1;i<a;i++)e=Zr.addOrSubtract(u.multiply(t,e),r[i]);return e},n.prototype.addOrSubtract=function(t){if(!this.field.equals(t.field))throw new Z("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;var e=this.coefficients,r=t.coefficients;if(e.length>r.length){var i=e;e=r,r=i}var o=new Int32Array(r.length),s=r.length-e.length;wt.arraycopy(r,0,o,0,s);for(var a=s;a<r.length;a++)o[a]=Zr.addOrSubtract(e[a-s],r[a]);return new n(this.field,o)},n.prototype.multiply=function(t){if(!this.field.equals(t.field))throw new Z("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();for(var e=this.coefficients,r=e.length,i=t.coefficients,o=i.length,s=new Int32Array(r+o-1),a=this.field,u=0;u<r;u++)for(var c=e[u],h=0;h<o;h++)s[u+h]=Zr.addOrSubtract(s[u+h],a.multiply(c,i[h]));return new n(a,s)},n.prototype.multiplyScalar=function(t){if(t===0)return this.field.getZero();if(t===1)return this;for(var e=this.coefficients.length,r=this.field,i=new Int32Array(e),o=this.coefficients,s=0;s<e;s++)i[s]=r.multiply(o[s],t);return new n(r,i)},n.prototype.multiplyByMonomial=function(t,e){if(t<0)throw new Z;if(e===0)return this.field.getZero();for(var r=this.coefficients,i=r.length,o=new Int32Array(i+t),s=this.field,a=0;a<i;a++)o[a]=s.multiply(r[a],e);return new n(s,o)},n.prototype.divide=function(t){if(!this.field.equals(t.field))throw new Z("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new Z("Divide by 0");for(var e=this.field,r=e.getZero(),i=this,o=t.getCoefficient(t.getDegree()),s=e.inverse(o);i.getDegree()>=t.getDegree()&&!i.isZero();){var a=i.getDegree()-t.getDegree(),u=e.multiply(i.getCoefficient(i.getDegree()),s),c=t.multiplyByMonomial(a,u),h=e.buildMonomial(a,u);r=r.addOrSubtract(h),i=i.addOrSubtract(c)}return[r,i]},n.prototype.toString=function(){for(var t="",e=this.getDegree();e>=0;e--){var r=this.getCoefficient(e);if(r!==0){if(r<0?(t+=" - ",r=-r):t.length>0&&(t+=" + "),e===0||r!==1){var i=this.field.log(r);i===0?t+="1":i===1?t+="a":(t+="a^",t+=i)}e!==0&&(e===1?t+="x":(t+="x^",t+=e))}}return t},n}(),sE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),v1=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return sE(t,n),t.kind="ArithmeticException",t}(fe),aE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),hn=function(n){function t(e,r,i){var o=n.call(this)||this;o.primitive=e,o.size=r,o.generatorBase=i;for(var s=new Int32Array(r),a=1,u=0;u<r;u++)s[u]=a,(a*=2)>=r&&(a^=e,a&=r-1);o.expTable=s;var c=new Int32Array(r);for(u=0;u<r-1;u++)c[s[u]]=u;return o.logTable=c,o.zero=new ui(o,Int32Array.from([0])),o.one=new ui(o,Int32Array.from([1])),o}return aE(t,n),t.prototype.getZero=function(){return this.zero},t.prototype.getOne=function(){return this.one},t.prototype.buildMonomial=function(e,r){if(e<0)throw new Z;if(r===0)return this.zero;var i=new Int32Array(e+1);return i[0]=r,new ui(this,i)},t.prototype.inverse=function(e){if(e===0)throw new v1;return this.expTable[this.size-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.size-1)]},t.prototype.getSize=function(){return this.size},t.prototype.getGeneratorBase=function(){return this.generatorBase},t.prototype.toString=function(){return"GF(0x"+Gt.toHexString(this.primitive)+","+this.size+")"},t.prototype.equals=function(e){return e===this},t.AZTEC_DATA_12=new t(4201,4096,1),t.AZTEC_DATA_10=new t(1033,1024,1),t.AZTEC_DATA_6=new t(67,64,1),t.AZTEC_PARAM=new t(19,16,1),t.QR_CODE_FIELD_256=new t(285,256,0),t.DATA_MATRIX_FIELD_256=new t(301,256,1),t.AZTEC_DATA_8=t.DATA_MATRIX_FIELD_256,t.MAXICODE_FIELD_64=t.AZTEC_DATA_6,t}(Zr),uE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),io=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return uE(t,n),t.kind="ReedSolomonException",t}(fe),cE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Oi=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return cE(t,n),t.kind="IllegalStateException",t}(fe),ms=function(){function n(t){this.field=t}return n.prototype.decode=function(t,e){for(var r=this.field,i=new ui(r,t),o=new Int32Array(e),s=!0,a=0;a<e;a++){var u=i.evaluateAt(r.exp(a+r.getGeneratorBase()));o[o.length-1-a]=u,u!==0&&(s=!1)}if(!s){var c=new ui(r,o),h=this.runEuclideanAlgorithm(r.buildMonomial(e,1),c,e),d=h[0],f=h[1],g=this.findErrorLocations(d),_=this.findErrorMagnitudes(f,g);for(a=0;a<g.length;a++){var v=t.length-1-r.log(g[a]);if(v<0)throw new io("Bad error location");t[v]=hn.addOrSubtract(t[v],_[a])}}},n.prototype.runEuclideanAlgorithm=function(t,e,r){if(t.getDegree()<e.getDegree()){var i=t;t=e,e=i}for(var o=this.field,s=t,a=e,u=o.getZero(),c=o.getOne();a.getDegree()>=(r/2|0);){var h=s,d=u;if(u=c,(s=a).isZero())throw new io("r_{i-1} was zero");a=h;for(var f=o.getZero(),g=s.getCoefficient(s.getDegree()),_=o.inverse(g);a.getDegree()>=s.getDegree()&&!a.isZero();){var v=a.getDegree()-s.getDegree(),I=o.multiply(a.getCoefficient(a.getDegree()),_);f=f.addOrSubtract(o.buildMonomial(v,I)),a=a.addOrSubtract(s.multiplyByMonomial(v,I))}if(c=f.multiply(u).addOrSubtract(d),a.getDegree()>=s.getDegree())throw new Oi("Division algorithm failed to reduce polynomial?")}var T=c.getCoefficient(0);if(T===0)throw new io("sigmaTilde(0) was zero");var N=o.inverse(T);return[c.multiplyScalar(N),a.multiplyScalar(N)]},n.prototype.findErrorLocations=function(t){var e=t.getDegree();if(e===1)return Int32Array.from([t.getCoefficient(1)]);for(var r=new Int32Array(e),i=0,o=this.field,s=1;s<o.getSize()&&i<e;s++)t.evaluateAt(s)===0&&(r[i]=o.inverse(s),i++);if(i!==e)throw new io("Error locator degree does not match number of roots");return r},n.prototype.findErrorMagnitudes=function(t,e){for(var r=e.length,i=new Int32Array(r),o=this.field,s=0;s<r;s++){for(var a=o.inverse(e[s]),u=1,c=0;c<r;c++)if(s!==c){var h=o.multiply(e[c],a),d=1&h?-2&h:1|h;u=o.multiply(u,d)}i[s]=o.multiply(t.evaluateAt(a),o.inverse(u)),o.getGeneratorBase()!==0&&(i[s]=o.multiply(i[s],a))}return i},n}();(function(n){n[n.UPPER=0]="UPPER",n[n.LOWER=1]="LOWER",n[n.MIXED=2]="MIXED",n[n.DIGIT=3]="DIGIT",n[n.PUNCT=4]="PUNCT",n[n.BINARY=5]="BINARY"})(Ut||(Ut={}));var uh=function(){function n(){}return n.prototype.decode=function(t){this.ddata=t;var e=t.getBits(),r=this.extractBits(e),i=this.correctBits(r),o=n.convertBoolArrayToByteArray(i),s=n.getEncodedData(i),a=new gs(o,s,null,null);return a.setNumBits(i.length),a},n.highLevelDecode=function(t){return this.getEncodedData(t)},n.getEncodedData=function(t){for(var e=t.length,r=Ut.UPPER,i=Ut.UPPER,o="",s=0;s<e;)if(i===Ut.BINARY){if(e-s<5)break;var a=n.readCode(t,s,5);if(s+=5,a===0){if(e-s<11)break;a=n.readCode(t,s,11)+31,s+=11}for(var u=0;u<a;u++){if(e-s<8){s=e;break}var c=n.readCode(t,s,8);o+=Vt.castAsNonUtf8Char(c),s+=8}i=r}else{var h=i===Ut.DIGIT?4:5;if(e-s<h)break;c=n.readCode(t,s,h),s+=h;var d=n.getCharacter(i,c);d.startsWith("CTRL_")?(r=i,i=n.getTable(d.charAt(5)),d.charAt(6)==="L"&&(r=i)):(o+=d,i=r)}return o},n.getTable=function(t){switch(t){case"L":return Ut.LOWER;case"P":return Ut.PUNCT;case"M":return Ut.MIXED;case"D":return Ut.DIGIT;case"B":return Ut.BINARY;default:return Ut.UPPER}},n.getCharacter=function(t,e){switch(t){case Ut.UPPER:return n.UPPER_TABLE[e];case Ut.LOWER:return n.LOWER_TABLE[e];case Ut.MIXED:return n.MIXED_TABLE[e];case Ut.PUNCT:return n.PUNCT_TABLE[e];case Ut.DIGIT:return n.DIGIT_TABLE[e];default:throw new Oi("Bad table")}},n.prototype.correctBits=function(t){var e,r;this.ddata.getNbLayers()<=2?(r=6,e=hn.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,e=hn.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,e=hn.AZTEC_DATA_10):(r=12,e=hn.AZTEC_DATA_12);var i=this.ddata.getNbDatablocks(),o=t.length/r;if(o<i)throw new W;for(var s=t.length%r,a=new Int32Array(o),u=0;u<o;u++,s+=r)a[u]=n.readCode(t,s,r);try{new ms(e).decode(a,o-i)}catch(v){throw new W(v)}var c=(1<<r)-1,h=0;for(u=0;u<i;u++){if((g=a[u])===0||g===c)throw new W;g!==1&&g!==c-1||h++}var d=new Array(i*r-h),f=0;for(u=0;u<i;u++){var g;if((g=a[u])===1||g===c-1)d.fill(g>1,f,f+r-1),f+=r-1;else for(var _=r-1;_>=0;--_)d[f++]=(g&1<<_)!=0}return d},n.prototype.extractBits=function(t){var e=this.ddata.isCompact(),r=this.ddata.getNbLayers(),i=(e?11:14)+4*r,o=new Int32Array(i),s=new Array(this.totalBitsInLayer(r,e));if(e)for(var a=0;a<o.length;a++)o[a]=a;else{var u=i+1+2*Gt.truncDivision(Gt.truncDivision(i,2)-1,15),c=i/2,h=Gt.truncDivision(u,2);for(a=0;a<c;a++){var d=a+Gt.truncDivision(a,15);o[c-a-1]=h-d-1,o[c+a]=h+d+1}}a=0;for(var f=0;a<r;a++){for(var g=4*(r-a)+(e?9:12),_=2*a,v=i-1-_,I=0;I<g;I++)for(var T=2*I,N=0;N<2;N++)s[f+T+N]=t.get(o[_+N],o[_+I]),s[f+2*g+T+N]=t.get(o[_+I],o[v-N]),s[f+4*g+T+N]=t.get(o[v-N],o[v-I]),s[f+6*g+T+N]=t.get(o[v-I],o[_+N]);f+=8*g}return s},n.readCode=function(t,e,r){for(var i=0,o=e;o<e+r;o++)i<<=1,t[o]&&(i|=1);return i},n.readByte=function(t,e){var r=t.length-e;return r>=8?n.readCode(t,e,8):n.readCode(t,e,r)<<8-r},n.convertBoolArrayToByteArray=function(t){for(var e=new Uint8Array((t.length+7)/8),r=0;r<e.length;r++)e[r]=n.readByte(t,8*r);return e},n.prototype.totalBitsInLayer=function(t,e){return((e?88:112)+16*t)*t},n.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],n.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],n.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],n.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],n.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],n}(),at=function(){function n(){}return n.round=function(t){return t===NaN?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0},n.distance=function(t,e,r,i){var o=t-r,s=e-i;return Math.sqrt(o*o+s*s)},n.sum=function(t){for(var e=0,r=0,i=t.length;r!==i;r++)e+=t[r];return e},n}(),ka=function(){function n(){}return n.floatToIntBits=function(t){return t},n.MAX_VALUE=Number.MAX_SAFE_INTEGER,n}(),X=function(){function n(t,e){this.x=t,this.y=e}return n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n.prototype.equals=function(t){if(t instanceof n){var e=t;return this.x===e.x&&this.y===e.y}return!1},n.prototype.hashCode=function(){return 31*ka.floatToIntBits(this.x)+ka.floatToIntBits(this.y)},n.prototype.toString=function(){return"("+this.x+","+this.y+")"},n.orderBestPatterns=function(t){var e,r,i,o=this.distance(t[0],t[1]),s=this.distance(t[1],t[2]),a=this.distance(t[0],t[2]);if(s>=o&&s>=a?(r=t[0],e=t[1],i=t[2]):a>=s&&a>=o?(r=t[1],e=t[0],i=t[2]):(r=t[2],e=t[0],i=t[1]),this.crossProductZ(e,r,i)<0){var u=e;e=i,i=u}t[0]=e,t[1]=r,t[2]=i},n.distance=function(t,e){return at.distance(t.x,t.y,e.x,e.y)},n.crossProductZ=function(t,e,r){var i=e.x,o=e.y;return(r.x-i)*(t.y-o)-(r.y-o)*(t.x-i)},n}(),Fu=function(){function n(t,e){this.bits=t,this.points=e}return n.prototype.getBits=function(){return this.bits},n.prototype.getPoints=function(){return this.points},n}(),lE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),hE=function(n){function t(e,r,i,o,s){var a=n.call(this,e,r)||this;return a.compact=i,a.nbDatablocks=o,a.nbLayers=s,a}return lE(t,n),t.prototype.getNbLayers=function(){return this.nbLayers},t.prototype.getNbDatablocks=function(){return this.nbDatablocks},t.prototype.isCompact=function(){return this.compact},t}(Fu),La=function(){function n(t,e,r,i){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),e==null&&(e=n.INIT_SIZE),r==null&&(r=t.getWidth()/2|0),i==null&&(i=t.getHeight()/2|0);var o=e/2|0;if(this.leftInit=r-o,this.rightInit=r+o,this.upInit=i-o,this.downInit=i+o,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new V}return n.prototype.detect=function(){for(var t=this.leftInit,e=this.rightInit,r=this.upInit,i=this.downInit,o=!1,s=!0,a=!1,u=!1,c=!1,h=!1,d=!1,f=this.width,g=this.height;s;){s=!1;for(var _=!0;(_||!u)&&e<f;)(_=this.containsBlackPoint(r,i,e,!1))?(e++,s=!0,u=!0):u||e++;if(e>=f){o=!0;break}for(var v=!0;(v||!c)&&i<g;)(v=this.containsBlackPoint(t,e,i,!0))?(i++,s=!0,c=!0):c||i++;if(i>=g){o=!0;break}for(var I=!0;(I||!h)&&t>=0;)(I=this.containsBlackPoint(r,i,t,!1))?(t--,s=!0,h=!0):h||t--;if(t<0){o=!0;break}for(var T=!0;(T||!d)&&r>=0;)(T=this.containsBlackPoint(t,e,r,!0))?(r--,s=!0,d=!0):d||r--;if(r<0){o=!0;break}s&&(a=!0)}if(!o&&a){for(var N=e-t,k=null,P=1;k===null&&P<N;P++)k=this.getBlackPointOnSegment(t,i-P,t+P,i);if(k==null)throw new V;var B=null;for(P=1;B===null&&P<N;P++)B=this.getBlackPointOnSegment(t,r+P,t+P,r);if(B==null)throw new V;var F=null;for(P=1;F===null&&P<N;P++)F=this.getBlackPointOnSegment(e,r+P,e-P,r);if(F==null)throw new V;var S=null;for(P=1;S===null&&P<N;P++)S=this.getBlackPointOnSegment(e,i-P,e-P,i);if(S==null)throw new V;return this.centerEdges(S,k,F,B)}throw new V},n.prototype.getBlackPointOnSegment=function(t,e,r,i){for(var o=at.round(at.distance(t,e,r,i)),s=(r-t)/o,a=(i-e)/o,u=this.image,c=0;c<o;c++){var h=at.round(t+c*s),d=at.round(e+c*a);if(u.get(h,d))return new X(h,d)}return null},n.prototype.centerEdges=function(t,e,r,i){var o=t.getX(),s=t.getY(),a=e.getX(),u=e.getY(),c=r.getX(),h=r.getY(),d=i.getX(),f=i.getY(),g=n.CORR;return o<this.width/2?[new X(d-g,f+g),new X(a+g,u+g),new X(c-g,h-g),new X(o+g,s-g)]:[new X(d+g,f+g),new X(a+g,u-g),new X(c-g,h+g),new X(o-g,s-g)]},n.prototype.containsBlackPoint=function(t,e,r,i){var o=this.image;if(i){for(var s=t;s<=e;s++)if(o.get(s,r))return!0}else for(var a=t;a<=e;a++)if(o.get(r,a))return!0;return!1},n.INIT_SIZE=10,n.CORR=1,n}(),ch=function(){function n(){}return n.checkAndNudgePoints=function(t,e){for(var r=t.getWidth(),i=t.getHeight(),o=!0,s=0;s<e.length&&o;s+=2){var a=Math.floor(e[s]),u=Math.floor(e[s+1]);if(a<-1||a>r||u<-1||u>i)throw new V;o=!1,a===-1?(e[s]=0,o=!0):a===r&&(e[s]=r-1,o=!0),u===-1?(e[s+1]=0,o=!0):u===i&&(e[s+1]=i-1,o=!0)}for(o=!0,s=e.length-2;s>=0&&o;s-=2){if(a=Math.floor(e[s]),u=Math.floor(e[s+1]),a<-1||a>r||u<-1||u>i)throw new V;o=!1,a===-1?(e[s]=0,o=!0):a===r&&(e[s]=r-1,o=!0),u===-1?(e[s+1]=0,o=!0):u===i&&(e[s+1]=i-1,o=!0)}},n}(),E1=function(){function n(t,e,r,i,o,s,a,u,c){this.a11=t,this.a21=e,this.a31=r,this.a12=i,this.a22=o,this.a32=s,this.a13=a,this.a23=u,this.a33=c}return n.quadrilateralToQuadrilateral=function(t,e,r,i,o,s,a,u,c,h,d,f,g,_,v,I){var T=n.quadrilateralToSquare(t,e,r,i,o,s,a,u);return n.squareToQuadrilateral(c,h,d,f,g,_,v,I).times(T)},n.prototype.transformPoints=function(t){for(var e=t.length,r=this.a11,i=this.a12,o=this.a13,s=this.a21,a=this.a22,u=this.a23,c=this.a31,h=this.a32,d=this.a33,f=0;f<e;f+=2){var g=t[f],_=t[f+1],v=o*g+u*_+d;t[f]=(r*g+s*_+c)/v,t[f+1]=(i*g+a*_+h)/v}},n.prototype.transformPointsWithValues=function(t,e){for(var r=this.a11,i=this.a12,o=this.a13,s=this.a21,a=this.a22,u=this.a23,c=this.a31,h=this.a32,d=this.a33,f=t.length,g=0;g<f;g++){var _=t[g],v=e[g],I=o*_+u*v+d;t[g]=(r*_+s*v+c)/I,e[g]=(i*_+a*v+h)/I}},n.squareToQuadrilateral=function(t,e,r,i,o,s,a,u){var c=t-r+o-a,h=e-i+s-u;if(c===0&&h===0)return new n(r-t,o-r,t,i-e,s-i,e,0,0,1);var d=r-o,f=a-o,g=i-s,_=u-s,v=d*_-f*g,I=(c*_-f*h)/v,T=(d*h-c*g)/v;return new n(r-t+I*r,a-t+T*a,t,i-e+I*i,u-e+T*u,e,I,T,1)},n.quadrilateralToSquare=function(t,e,r,i,o,s,a,u){return n.squareToQuadrilateral(t,e,r,i,o,s,a,u).buildAdjoint()},n.prototype.buildAdjoint=function(){return new n(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},n.prototype.times=function(t){return new n(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)},n}(),dE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),fE=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return dE(t,n),t.prototype.sampleGrid=function(e,r,i,o,s,a,u,c,h,d,f,g,_,v,I,T,N,k,P){var B=E1.quadrilateralToQuadrilateral(o,s,a,u,c,h,d,f,g,_,v,I,T,N,k,P);return this.sampleGridWithTransform(e,r,i,B)},t.prototype.sampleGridWithTransform=function(e,r,i,o){if(r<=0||i<=0)throw new V;for(var s=new Qe(r,i),a=new Float32Array(2*r),u=0;u<i;u++){for(var c=a.length,h=u+.5,d=0;d<c;d+=2)a[d]=d/2+.5,a[d+1]=h;o.transformPoints(a),ch.checkAndNudgePoints(e,a);try{for(d=0;d<c;d+=2)e.get(Math.floor(a[d]),Math.floor(a[d+1]))&&s.set(d/2,u)}catch{throw new V}}return s},t}(ch),Uu=function(){function n(){}return n.setGridSampler=function(t){n.gridSampler=t},n.getInstance=function(){return n.gridSampler},n.gridSampler=new fE,n}(),ce=function(){function n(t,e){this.x=t,this.y=e}return n.prototype.toResultPoint=function(){return new X(this.getX(),this.getY())},n.prototype.getX=function(){return this.x},n.prototype.getY=function(){return this.y},n}(),pE=function(){function n(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}return n.prototype.detect=function(){return this.detectMirror(!1)},n.prototype.detectMirror=function(t){var e=this.getMatrixCenter(),r=this.getBullsEyeCorners(e);if(t){var i=r[0];r[0]=r[2],r[2]=i}this.extractParameters(r);var o=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),s=this.getMatrixCornerPoints(r);return new hE(o,s,this.compact,this.nbDataBlocks,this.nbLayers)},n.prototype.extractParameters=function(t){if(!(this.isValidPoint(t[0])&&this.isValidPoint(t[1])&&this.isValidPoint(t[2])&&this.isValidPoint(t[3])))throw new V;var e=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(t[0],t[1],e),this.sampleLine(t[1],t[2],e),this.sampleLine(t[2],t[3],e),this.sampleLine(t[3],t[0],e)]);this.shift=this.getRotation(r,e);for(var i=0,o=0;o<4;o++){var s=r[(this.shift+o)%4];this.compact?(i<<=7,i+=s>>1&127):(i<<=10,i+=(s>>2&992)+(s>>1&31))}var a=this.getCorrectedParameterData(i,this.compact);this.compact?(this.nbLayers=1+(a>>6),this.nbDataBlocks=1+(63&a)):(this.nbLayers=1+(a>>11),this.nbDataBlocks=1+(2047&a))},n.prototype.getRotation=function(t,e){var r=0;t.forEach(function(o,s,a){r=(r<<3)+((o>>e-2<<1)+(1&o))}),r=((1&r)<<11)+(r>>1);for(var i=0;i<4;i++)if(Gt.bitCount(r^this.EXPECTED_CORNER_BITS[i])<=2)return i;throw new V},n.prototype.getCorrectedParameterData=function(t,e){var r,i;e?(r=7,i=2):(r=10,i=4);for(var o=r-i,s=new Int32Array(r),a=r-1;a>=0;--a)s[a]=15&t,t>>=4;try{new ms(hn.AZTEC_PARAM).decode(s,o)}catch{throw new V}var u=0;for(a=0;a<i;a++)u=(u<<4)+s[a];return u},n.prototype.getBullsEyeCorners=function(t){var e=t,r=t,i=t,o=t,s=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var a=this.getFirstDifferent(e,s,1,-1),u=this.getFirstDifferent(r,s,1,1),c=this.getFirstDifferent(i,s,-1,1),h=this.getFirstDifferent(o,s,-1,-1);if(this.nbCenterLayers>2){var d=this.distancePoint(h,a)*this.nbCenterLayers/(this.distancePoint(o,e)*(this.nbCenterLayers+2));if(d<.75||d>1.25||!this.isWhiteOrBlackRectangle(a,u,c,h))break}e=a,r=u,i=c,o=h,s=!s}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new V;this.compact=this.nbCenterLayers===5;var f=new X(e.getX()+.5,e.getY()-.5),g=new X(r.getX()+.5,r.getY()+.5),_=new X(i.getX()-.5,i.getY()+.5),v=new X(o.getX()-.5,o.getY()-.5);return this.expandSquare([f,g,_,v],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},n.prototype.getMatrixCenter=function(){var t,e,r,i;try{t=(c=new La(this.image).detect())[0],e=c[1],r=c[2],i=c[3]}catch{var o=this.image.getWidth()/2,s=this.image.getHeight()/2;t=this.getFirstDifferent(new ce(o+7,s-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new ce(o+7,s+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ce(o-7,s+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new ce(o-7,s-7),!1,-1,-1).toResultPoint()}var a=at.round((t.getX()+i.getX()+e.getX()+r.getX())/4),u=at.round((t.getY()+i.getY()+e.getY()+r.getY())/4);try{var c;t=(c=new La(this.image,15,a,u).detect())[0],e=c[1],r=c[2],i=c[3]}catch{t=this.getFirstDifferent(new ce(a+7,u-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new ce(a+7,u+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ce(a-7,u+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new ce(a-7,u-7),!1,-1,-1).toResultPoint()}return a=at.round((t.getX()+i.getX()+e.getX()+r.getX())/4),u=at.round((t.getY()+i.getY()+e.getY()+r.getY())/4),new ce(a,u)},n.prototype.getMatrixCornerPoints=function(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())},n.prototype.sampleGrid=function(t,e,r,i,o){var s=Uu.getInstance(),a=this.getDimension(),u=a/2-this.nbCenterLayers,c=a/2+this.nbCenterLayers;return s.sampleGrid(t,a,a,u,u,c,u,c,c,u,c,e.getX(),e.getY(),r.getX(),r.getY(),i.getX(),i.getY(),o.getX(),o.getY())},n.prototype.sampleLine=function(t,e,r){for(var i=0,o=this.distanceResultPoint(t,e),s=o/r,a=t.getX(),u=t.getY(),c=s*(e.getX()-t.getX())/o,h=s*(e.getY()-t.getY())/o,d=0;d<r;d++)this.image.get(at.round(a+d*c),at.round(u+d*h))&&(i|=1<<r-d-1);return i},n.prototype.isWhiteOrBlackRectangle=function(t,e,r,i){t=new ce(t.getX()-3,t.getY()+3),e=new ce(e.getX()-3,e.getY()-3),r=new ce(r.getX()+3,r.getY()-3),i=new ce(i.getX()+3,i.getY()+3);var o=this.getColor(i,t);if(o===0)return!1;var s=this.getColor(t,e);return s===o&&(s=this.getColor(e,r))===o&&(s=this.getColor(r,i))===o},n.prototype.getColor=function(t,e){for(var r=this.distancePoint(t,e),i=(e.getX()-t.getX())/r,o=(e.getY()-t.getY())/r,s=0,a=t.getX(),u=t.getY(),c=this.image.get(t.getX(),t.getY()),h=Math.ceil(r),d=0;d<h;d++)a+=i,u+=o,this.image.get(at.round(a),at.round(u))!==c&&s++;var f=s/r;return f>.1&&f<.9?0:f<=.1===c?1:-1},n.prototype.getFirstDifferent=function(t,e,r,i){for(var o=t.getX()+r,s=t.getY()+i;this.isValid(o,s)&&this.image.get(o,s)===e;)o+=r,s+=i;for(o-=r,s-=i;this.isValid(o,s)&&this.image.get(o,s)===e;)o+=r;for(o-=r;this.isValid(o,s)&&this.image.get(o,s)===e;)s+=i;return new ce(o,s-=i)},n.prototype.expandSquare=function(t,e,r){var i=r/(2*e),o=t[0].getX()-t[2].getX(),s=t[0].getY()-t[2].getY(),a=(t[0].getX()+t[2].getX())/2,u=(t[0].getY()+t[2].getY())/2,c=new X(a+i*o,u+i*s),h=new X(a-i*o,u-i*s);return o=t[1].getX()-t[3].getX(),s=t[1].getY()-t[3].getY(),a=(t[1].getX()+t[3].getX())/2,u=(t[1].getY()+t[3].getY())/2,[c,new X(a+i*o,u+i*s),h,new X(a-i*o,u-i*s)]},n.prototype.isValid=function(t,e){return t>=0&&t<this.image.getWidth()&&e>0&&e<this.image.getHeight()},n.prototype.isValidPoint=function(t){var e=at.round(t.getX()),r=at.round(t.getY());return this.isValid(e,r)},n.prototype.distancePoint=function(t,e){return at.distance(t.getX(),t.getY(),e.getX(),e.getY())},n.prototype.distanceResultPoint=function(t,e){return at.distance(t.getX(),t.getY(),e.getX(),e.getY())},n.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Gt.truncDivision(this.nbLayers-4,8)+1)+15},n}(),Ho=function(){function n(){}return n.prototype.decode=function(t,e){e===void 0&&(e=null);var r=null,i=new pE(t.getBlackMatrix()),o=null,s=null;try{o=(a=i.detectMirror(!1)).getPoints(),this.reportFoundResultPoints(e,o),s=new uh().decode(a)}catch(d){r=d}if(s==null)try{var a;o=(a=i.detectMirror(!0)).getPoints(),this.reportFoundResultPoints(e,o),s=new uh().decode(a)}catch(d){throw r??d}var u=new pe(s.getText(),s.getRawBytes(),s.getNumBits(),o,Y.AZTEC,wt.currentTimeMillis()),c=s.getByteSegments();c!=null&&u.putMetadata(Wt.BYTE_SEGMENTS,c);var h=s.getECLevel();return h!=null&&u.putMetadata(Wt.ERROR_CORRECTION_LEVEL,h),u},n.prototype.reportFoundResultPoints=function(t,e){if(t!=null){var r=t.get(_t.NEED_RESULT_POINT_CALLBACK);r!=null&&e.forEach(function(i,o,s){r.foundPossibleResultPoint(i)})}},n.prototype.reset=function(){},n}(),gE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e){return e===void 0&&(e=500),n.call(this,new Ho,e)||this}gE(t,n)})(Cr);var zt=function(){function n(){}return n.prototype.decode=function(t,e){try{return this.doDecode(t,e)}catch{if(e&&e.get(_t.TRY_HARDER)===!0&&t.isRotateSupported()){var r=t.rotateCounterClockwise(),i=this.doDecode(r,e),o=i.getResultMetadata(),s=270;o!==null&&o.get(Wt.ORIENTATION)===!0&&(s+=o.get(Wt.ORIENTATION)%360),i.putMetadata(Wt.ORIENTATION,s);var a=i.getResultPoints();if(a!==null)for(var u=r.getHeight(),c=0;c<a.length;c++)a[c]=new X(u-a[c].getY()-1,a[c].getX());return i}throw new V}},n.prototype.reset=function(){},n.prototype.doDecode=function(t,e){var r,i=t.getWidth(),o=t.getHeight(),s=new be(i),a=e&&e.get(_t.TRY_HARDER)===!0,u=Math.max(1,o>>(a?8:5));r=a?o:15;for(var c=Math.trunc(o/2),h=0;h<r;h++){var d=Math.trunc((h+1)/2),f=c+u*(1&h?-d:d);if(f<0||f>=o)break;try{s=t.getBlackRow(f,s)}catch{continue}for(var g=function(T){if(T===1&&(s.reverse(),e&&e.get(_t.NEED_RESULT_POINT_CALLBACK)===!0)){var N=new Map;e.forEach(function(B,F){return N.set(F,B)}),N.delete(_t.NEED_RESULT_POINT_CALLBACK),e=N}try{var k=_.decodeRow(f,s,e);if(T===1){k.putMetadata(Wt.ORIENTATION,180);var P=k.getResultPoints();P!==null&&(P[0]=new X(i-P[0].getX()-1,P[0].getY()),P[1]=new X(i-P[1].getX()-1,P[1].getY()))}return{value:k}}catch{}},_=this,v=0;v<2;v++){var I=g(v);if(typeof I=="object")return I.value}}throw new V},n.recordPattern=function(t,e,r){for(var i=r.length,o=0;o<i;o++)r[o]=0;var s=t.getSize();if(e>=s)throw new V;for(var a=!t.get(e),u=0,c=e;c<s;){if(t.get(c)!==a)r[u]++;else{if(++u===i)break;r[u]=1,a=!a}c++}if(u!==i&&(u!==i-1||c!==s))throw new V},n.recordPatternInReverse=function(t,e,r){for(var i=r.length,o=t.get(e);e>0&&i>=0;)t.get(--e)!==o&&(i--,o=!o);if(i>=0)throw new V;n.recordPattern(t,e+1,r)},n.patternMatchVariance=function(t,e,r){for(var i=t.length,o=0,s=0,a=0;a<i;a++)o+=t[a],s+=e[a];if(o<s)return Number.POSITIVE_INFINITY;var u=o/s;r*=u;for(var c=0,h=0;h<i;h++){var d=t[h],f=e[h]*u,g=d>f?d-f:f-d;if(g>r)return Number.POSITIVE_INFINITY;c+=g}return c/o},n}(),mE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),lh=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return mE(t,n),t.findStartPattern=function(e){for(var r=e.getSize(),i=e.getNextSet(0),o=0,s=Int32Array.from([0,0,0,0,0,0]),a=i,u=!1,c=i;c<r;c++)if(e.get(c)!==u)s[o]++;else{if(o===5){for(var h=t.MAX_AVG_VARIANCE,d=-1,f=t.CODE_START_A;f<=t.CODE_START_C;f++){var g=zt.patternMatchVariance(s,t.CODE_PATTERNS[f],t.MAX_INDIVIDUAL_VARIANCE);g<h&&(h=g,d=f)}if(d>=0&&e.isRange(Math.max(0,a-(c-a)/2),a,!1))return Int32Array.from([a,c,d]);a+=s[0]+s[1],(s=s.slice(2,s.length-1))[o-1]=0,s[o]=0,o--}else o++;s[o]=1,u=!u}throw new V},t.decodeCode=function(e,r,i){zt.recordPattern(e,i,r);for(var o=t.MAX_AVG_VARIANCE,s=-1,a=0;a<t.CODE_PATTERNS.length;a++){var u=t.CODE_PATTERNS[a],c=this.patternMatchVariance(r,u,t.MAX_INDIVIDUAL_VARIANCE);c<o&&(o=c,s=a)}if(s>=0)return s;throw new V},t.prototype.decodeRow=function(e,r,i){var o,s=i&&i.get(_t.ASSUME_GS1)===!0,a=t.findStartPattern(r),u=a[2],c=0,h=new Uint8Array(20);switch(h[c++]=u,u){case t.CODE_START_A:o=t.CODE_CODE_A;break;case t.CODE_START_B:o=t.CODE_CODE_B;break;case t.CODE_START_C:o=t.CODE_CODE_C;break;default:throw new W}for(var d=!1,f=!1,g="",_=a[0],v=a[1],I=Int32Array.from([0,0,0,0,0,0]),T=0,N=0,k=u,P=0,B=!0,F=!1,S=!1;!d;){var A=f;switch(f=!1,T=N,N=t.decodeCode(r,I,v),h[c++]=N,N!==t.CODE_STOP&&(B=!0),N!==t.CODE_STOP&&(k+=++P*N),_=v,v+=I.reduce(function(An,Tn){return An+Tn},0),N){case t.CODE_START_A:case t.CODE_START_B:case t.CODE_START_C:throw new W}switch(o){case t.CODE_CODE_A:if(N<64)g+=S===F?String.fromCharCode(32+N):String.fromCharCode(32+N+128),S=!1;else if(N<96)g+=S===F?String.fromCharCode(N-64):String.fromCharCode(N+64),S=!1;else switch(N!==t.CODE_STOP&&(B=!1),N){case t.CODE_FNC_1:s&&(g.length===0?g+="]C1":g+="");break;case t.CODE_FNC_2:case t.CODE_FNC_3:break;case t.CODE_FNC_4_A:!F&&S?(F=!0,S=!1):F&&S?(F=!1,S=!1):S=!0;break;case t.CODE_SHIFT:f=!0,o=t.CODE_CODE_B;break;case t.CODE_CODE_B:o=t.CODE_CODE_B;break;case t.CODE_CODE_C:o=t.CODE_CODE_C;break;case t.CODE_STOP:d=!0}break;case t.CODE_CODE_B:if(N<96)g+=S===F?String.fromCharCode(32+N):String.fromCharCode(32+N+128),S=!1;else switch(N!==t.CODE_STOP&&(B=!1),N){case t.CODE_FNC_1:s&&(g.length===0?g+="]C1":g+="");break;case t.CODE_FNC_2:case t.CODE_FNC_3:break;case t.CODE_FNC_4_B:!F&&S?(F=!0,S=!1):F&&S?(F=!1,S=!1):S=!0;break;case t.CODE_SHIFT:f=!0,o=t.CODE_CODE_A;break;case t.CODE_CODE_A:o=t.CODE_CODE_A;break;case t.CODE_CODE_C:o=t.CODE_CODE_C;break;case t.CODE_STOP:d=!0}break;case t.CODE_CODE_C:if(N<100)N<10&&(g+="0"),g+=N;else switch(N!==t.CODE_STOP&&(B=!1),N){case t.CODE_FNC_1:s&&(g.length===0?g+="]C1":g+="");break;case t.CODE_CODE_A:o=t.CODE_CODE_A;break;case t.CODE_CODE_B:o=t.CODE_CODE_B;break;case t.CODE_STOP:d=!0}}A&&(o=o===t.CODE_CODE_A?t.CODE_CODE_B:t.CODE_CODE_A)}var C=v-_;if(v=r.getNextUnset(v),!r.isRange(v,Math.min(r.getSize(),v+(v-_)/2),!1))throw new V;if((k-=P*T)%103!==T)throw new xt;var R=g.length;if(R===0)throw new V;R>0&&B&&(g=o===t.CODE_CODE_C?g.substring(0,R-2):g.substring(0,R-1));for(var O=(a[1]+a[0])/2,D=_+C/2,b=h.length,Nt=new Uint8Array(b),ue=0;ue<b;ue++)Nt[ue]=h[ue];var br=[new X(O,e),new X(D,e)];return new pe(g,Nt,0,br,Y.CODE_128,new Date().getTime())},t.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],t.MAX_AVG_VARIANCE=.25,t.MAX_INDIVIDUAL_VARIANCE=.7,t.CODE_SHIFT=98,t.CODE_CODE_C=99,t.CODE_CODE_B=100,t.CODE_CODE_A=101,t.CODE_FNC_1=102,t.CODE_FNC_2=97,t.CODE_FNC_3=96,t.CODE_FNC_4_A=101,t.CODE_FNC_4_B=100,t.CODE_START_A=103,t.CODE_START_B=104,t.CODE_START_C=105,t.CODE_STOP=106,t}(zt),_E=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ia=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hh=function(n){function t(e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var i=n.call(this)||this;return i.usingCheckDigit=e,i.extendedMode=r,i.decodeRowResult="",i.counters=new Int32Array(9),i}return _E(t,n),t.prototype.decodeRow=function(e,r,i){var o,s,a,u,c=this.counters;c.fill(0),this.decodeRowResult="";var h,d,f=t.findAsteriskPattern(r,c),g=r.getNextSet(f[1]),_=r.getSize();do{t.recordPattern(r,g,c);var v=t.toNarrowWidePattern(c);if(v<0)throw new V;h=t.patternToChar(v),this.decodeRowResult+=h,d=g;try{for(var I=(o=void 0,ia(c)),T=I.next();!T.done;T=I.next())g+=T.value}catch(O){o={error:O}}finally{try{T&&!T.done&&(s=I.return)&&s.call(I)}finally{if(o)throw o.error}}g=r.getNextSet(g)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var N,k=0;try{for(var P=ia(c),B=P.next();!B.done;B=P.next())k+=B.value}catch(O){a={error:O}}finally{try{B&&!B.done&&(u=P.return)&&u.call(P)}finally{if(a)throw a.error}}if(g!==_&&2*(g-d-k)<k)throw new V;if(this.usingCheckDigit){for(var F=this.decodeRowResult.length-1,S=0,A=0;A<F;A++)S+=t.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(A));if(this.decodeRowResult.charAt(F)!==t.ALPHABET_STRING.charAt(S%43))throw new xt;this.decodeRowResult=this.decodeRowResult.substring(0,F)}if(this.decodeRowResult.length===0)throw new V;N=this.extendedMode?t.decodeExtended(this.decodeRowResult):this.decodeRowResult;var C=(f[1]+f[0])/2,R=d+k/2;return new pe(N,null,0,[new X(C,e),new X(R,e)],Y.CODE_39,new Date().getTime())},t.findAsteriskPattern=function(e,r){for(var i=e.getSize(),o=e.getNextSet(0),s=0,a=o,u=!1,c=r.length,h=o;h<i;h++)if(e.get(h)!==u)r[s]++;else{if(s===c-1){if(this.toNarrowWidePattern(r)===t.ASTERISK_ENCODING&&e.isRange(Math.max(0,a-Math.floor((h-a)/2)),a,!1))return[a,h];a+=r[0]+r[1],r.copyWithin(0,2,2+s-1),r[s-1]=0,r[s]=0,s--}else s++;r[s]=1,u=!u}throw new V},t.toNarrowWidePattern=function(e){var r,i,o,s=e.length,a=0;do{var u=2147483647;try{for(var c=(r=void 0,ia(e)),h=c.next();!h.done;h=c.next())(_=h.value)<u&&_>a&&(u=_)}catch(v){r={error:v}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}a=u,o=0;for(var d=0,f=0,g=0;g<s;g++)(_=e[g])>a&&(f|=1<<s-1-g,o++,d+=_);if(o===3){for(g=0;g<s&&o>0;g++){var _;if((_=e[g])>a&&(o--,2*_>=d))return-1}return f}}while(o>3);return-1},t.patternToChar=function(e){for(var r=0;r<t.CHARACTER_ENCODINGS.length;r++)if(t.CHARACTER_ENCODINGS[r]===e)return t.ALPHABET_STRING.charAt(r);if(e===t.ASTERISK_ENCODING)return"*";throw new V},t.decodeExtended=function(e){for(var r=e.length,i="",o=0;o<r;o++){var s=e.charAt(o);if(s==="+"||s==="$"||s==="%"||s==="/"){var a=e.charAt(o+1),u="\0";switch(s){case"+":if(!(a>="A"&&a<="Z"))throw new W;u=String.fromCharCode(a.charCodeAt(0)+32);break;case"$":if(!(a>="A"&&a<="Z"))throw new W;u=String.fromCharCode(a.charCodeAt(0)-64);break;case"%":if(a>="A"&&a<="E")u=String.fromCharCode(a.charCodeAt(0)-38);else if(a>="F"&&a<="J")u=String.fromCharCode(a.charCodeAt(0)-11);else if(a>="K"&&a<="O")u=String.fromCharCode(a.charCodeAt(0)+16);else if(a>="P"&&a<="T")u=String.fromCharCode(a.charCodeAt(0)+43);else if(a==="U")u="\0";else if(a==="V")u="@";else if(a==="W")u="`";else{if(a!=="X"&&a!=="Y"&&a!=="Z")throw new W;u=""}break;case"/":if(a>="A"&&a<="O")u=String.fromCharCode(a.charCodeAt(0)-32);else{if(a!=="Z")throw new W;u=":"}}i+=u,o++}else i+=s}return i},t.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",t.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],t.ASTERISK_ENCODING=148,t}(zt),yE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),wE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},dh=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.narrowLineWidth=-1,e}return yE(t,n),t.prototype.decodeRow=function(e,r,i){var o,s,a=this.decodeStart(r),u=this.decodeEnd(r),c=new pt;t.decodeMiddle(r,a[1],u[0],c);var h=c.toString(),d=null;i!=null&&(d=i.get(_t.ALLOWED_LENGTHS)),d==null&&(d=t.DEFAULT_ALLOWED_LENGTHS);var f=h.length,g=!1,_=0;try{for(var v=wE(d),I=v.next();!I.done;I=v.next()){var T=I.value;if(f===T){g=!0;break}T>_&&(_=T)}}catch(k){o={error:k}}finally{try{I&&!I.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}if(!g&&f>_&&(g=!0),!g)throw new W;var N=[new X(a[1],e),new X(u[0],e)];return new pe(h,null,0,N,Y.ITF,new Date().getTime())},t.decodeMiddle=function(e,r,i,o){var s=new Int32Array(10),a=new Int32Array(5),u=new Int32Array(5);for(s.fill(0),a.fill(0),u.fill(0);r<i;){zt.recordPattern(e,r,s);for(var c=0;c<5;c++){var h=2*c;a[c]=s[h],u[c]=s[h+1]}var d=t.decodeDigit(a);o.append(d.toString()),d=this.decodeDigit(u),o.append(d.toString()),s.forEach(function(f){r+=f})}},t.prototype.decodeStart=function(e){var r=t.skipWhiteSpace(e),i=t.findGuardPattern(e,r,t.START_PATTERN);return this.narrowLineWidth=(i[1]-i[0])/4,this.validateQuietZone(e,i[0]),i},t.prototype.validateQuietZone=function(e,r){var i=10*this.narrowLineWidth;i=i<r?i:r;for(var o=r-1;i>0&&o>=0&&!e.get(o);o--)i--;if(i!==0)throw new V},t.skipWhiteSpace=function(e){var r=e.getSize(),i=e.getNextSet(0);if(i===r)throw new V;return i},t.prototype.decodeEnd=function(e){e.reverse();try{var r=t.skipWhiteSpace(e),i=void 0;try{i=t.findGuardPattern(e,r,t.END_PATTERN_REVERSED[0])}catch(s){s instanceof V&&(i=t.findGuardPattern(e,r,t.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,i[0]);var o=i[0];return i[0]=e.getSize()-i[1],i[1]=e.getSize()-o,i}finally{e.reverse()}},t.findGuardPattern=function(e,r,i){var o=i.length,s=new Int32Array(o),a=e.getSize(),u=!1,c=0,h=r;s.fill(0);for(var d=r;d<a;d++)if(e.get(d)!==u)s[c]++;else{if(c===o-1){if(zt.patternMatchVariance(s,i,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return[h,d];h+=s[0]+s[1],wt.arraycopy(s,2,s,0,c-1),s[c-1]=0,s[c]=0,c--}else c++;s[c]=1,u=!u}throw new V},t.decodeDigit=function(e){for(var r=t.MAX_AVG_VARIANCE,i=-1,o=t.PATTERNS.length,s=0;s<o;s++){var a=t.PATTERNS[s],u=zt.patternMatchVariance(e,a,t.MAX_INDIVIDUAL_VARIANCE);u<r?(r=u,i=s):u===r&&(i=-1)}if(i>=0)return i%10;throw new V},t.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],t.MAX_AVG_VARIANCE=.38,t.MAX_INDIVIDUAL_VARIANCE=.5,t.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],t.START_PATTERN=Int32Array.from([1,1,1,1]),t.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],t}(zt),vE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),wr=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.decodeRowStringBuffer="",e}return vE(t,n),t.findStartGuardPattern=function(e){for(var r,i=!1,o=0,s=Int32Array.from([0,0,0]);!i;){s=Int32Array.from([0,0,0]);var a=(r=t.findGuardPattern(e,o,!1,this.START_END_PATTERN,s))[0],u=a-((o=r[1])-a);u>=0&&(i=e.isRange(u,a,!1))}return r},t.checkChecksum=function(e){return t.checkStandardUPCEANChecksum(e)},t.checkStandardUPCEANChecksum=function(e){var r=e.length;if(r===0)return!1;var i=parseInt(e.charAt(r-1),10);return t.getStandardUPCEANChecksum(e.substring(0,r-1))===i},t.getStandardUPCEANChecksum=function(e){for(var r=e.length,i=0,o=r-1;o>=0;o-=2){if((s=e.charAt(o).charCodeAt(0)-48)<0||s>9)throw new W;i+=s}for(i*=3,o=r-2;o>=0;o-=2){var s;if((s=e.charAt(o).charCodeAt(0)-48)<0||s>9)throw new W;i+=s}return(1e3-i)%10},t.decodeEnd=function(e,r){return t.findGuardPattern(e,r,!1,t.START_END_PATTERN,new Int32Array(t.START_END_PATTERN.length).fill(0))},t.findGuardPatternWithoutCounters=function(e,r,i,o){return this.findGuardPattern(e,r,i,o,new Int32Array(o.length))},t.findGuardPattern=function(e,r,i,o,s){for(var a=e.getSize(),u=0,c=r=i?e.getNextUnset(r):e.getNextSet(r),h=o.length,d=i,f=r;f<a;f++)if(e.get(f)!==d)s[u]++;else{if(u===h-1){if(zt.patternMatchVariance(s,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return Int32Array.from([c,f]);c+=s[0]+s[1];for(var g=s.slice(2,s.length-1),_=0;_<u-1;_++)s[_]=g[_];s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,d=!d}throw new V},t.decodeDigit=function(e,r,i,o){this.recordPattern(e,i,r);for(var s=this.MAX_AVG_VARIANCE,a=-1,u=o.length,c=0;c<u;c++){var h=o[c],d=zt.patternMatchVariance(r,h,t.MAX_INDIVIDUAL_VARIANCE);d<s&&(s=d,a=c)}if(a>=0)return a;throw new V},t.MAX_AVG_VARIANCE=.48,t.MAX_INDIVIDUAL_VARIANCE=.7,t.START_END_PATTERN=Int32Array.from([1,1,1]),t.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),t.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),t.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],t}(zt),EE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},IE=function(){function n(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return n.prototype.decodeRow=function(t,e,r){var i=this.decodeRowStringBuffer,o=this.decodeMiddle(e,r,i),s=i.toString(),a=n.parseExtensionString(s),u=[new X((r[0]+r[1])/2,t),new X(o,t)],c=new pe(s,null,0,u,Y.UPC_EAN_EXTENSION,new Date().getTime());return a!=null&&c.putAllMetadata(a),c},n.prototype.decodeMiddle=function(t,e,r){var i,o,s=this.decodeMiddleCounters;s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var a=t.getSize(),u=e[1],c=0,h=0;h<5&&u<a;h++){var d=wr.decodeDigit(t,s,u,wr.L_AND_G_PATTERNS);r+=String.fromCharCode(48+d%10);try{for(var f=(i=void 0,EE(s)),g=f.next();!g.done;g=f.next())u+=g.value}catch(v){i={error:v}}finally{try{g&&!g.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}d>=10&&(c|=1<<4-h),h!==4&&(u=t.getNextSet(u),u=t.getNextUnset(u))}if(r.length!==5)throw new V;var _=this.determineCheckDigit(c);if(n.extensionChecksum(r.toString())!==_)throw new V;return u},n.extensionChecksum=function(t){for(var e=t.length,r=0,i=e-2;i>=0;i-=2)r+=t.charAt(i).charCodeAt(0)-48;for(r*=3,i=e-1;i>=0;i-=2)r+=t.charAt(i).charCodeAt(0)-48;return(r*=3)%10},n.prototype.determineCheckDigit=function(t){for(var e=0;e<10;e++)if(t===this.CHECK_DIGIT_ENCODINGS[e])return e;throw new V},n.parseExtensionString=function(t){if(t.length!==5)return null;var e=n.parseExtension5String(t);return e==null?null:new Map([[Wt.SUGGESTED_PRICE,e]])},n.parseExtension5String=function(t){var e;switch(t.charAt(0)){case"0":e="£";break;case"5":e="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}e="";break;default:e=""}var r=parseInt(t.substring(1)),i=r%100;return e+(r/100).toString()+"."+(i<10?"0"+i:i.toString())},n}(),AE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},TE=function(){function n(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return n.prototype.decodeRow=function(t,e,r){var i=this.decodeRowStringBuffer,o=this.decodeMiddle(e,r,i),s=i.toString(),a=n.parseExtensionString(s),u=[new X((r[0]+r[1])/2,t),new X(o,t)],c=new pe(s,null,0,u,Y.UPC_EAN_EXTENSION,new Date().getTime());return a!=null&&c.putAllMetadata(a),c},n.prototype.decodeMiddle=function(t,e,r){var i,o,s=this.decodeMiddleCounters;s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var a=t.getSize(),u=e[1],c=0,h=0;h<2&&u<a;h++){var d=wr.decodeDigit(t,s,u,wr.L_AND_G_PATTERNS);r+=String.fromCharCode(48+d%10);try{for(var f=(i=void 0,AE(s)),g=f.next();!g.done;g=f.next())u+=g.value}catch(_){i={error:_}}finally{try{g&&!g.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}d>=10&&(c|=1<<1-h),h!==1&&(u=t.getNextSet(u),u=t.getNextUnset(u))}if(r.length!==2)throw new V;if(parseInt(r.toString())%4!==c)throw new V;return u},n.parseExtensionString=function(t){return t.length!==2?null:new Map([[Wt.ISSUE_NUMBER,parseInt(t)]])},n}(),CE=function(){function n(){}return n.decodeRow=function(t,e,r){var i=wr.findGuardPattern(e,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new IE().decodeRow(t,e,i)}catch{return new TE().decodeRow(t,e,i)}},n.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),n}(),SE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Pt=function(n){function t(){var e=n.call(this)||this;e.decodeRowStringBuffer="",t.L_AND_G_PATTERNS=t.L_PATTERNS.map(function(a){return Int32Array.from(a)});for(var r=10;r<20;r++){for(var i=t.L_PATTERNS[r-10],o=new Int32Array(i.length),s=0;s<i.length;s++)o[s]=i[i.length-s-1];t.L_AND_G_PATTERNS[r]=o}return e}return SE(t,n),t.prototype.decodeRow=function(e,r,i){var o=t.findStartGuardPattern(r),s=i==null?null:i.get(_t.NEED_RESULT_POINT_CALLBACK);if(s!=null){var a=new X((o[0]+o[1])/2,e);s.foundPossibleResultPoint(a)}var u=this.decodeMiddle(r,o,this.decodeRowStringBuffer),c=u.rowOffset,h=u.resultString;if(s!=null){var d=new X(c,e);s.foundPossibleResultPoint(d)}var f=t.decodeEnd(r,c);if(s!=null){var g=new X((f[0]+f[1])/2,e);s.foundPossibleResultPoint(g)}var _=f[1],v=_+(_-f[0]);if(v>=r.getSize()||!r.isRange(_,v,!1))throw new V;var I=h.toString();if(I.length<8)throw new W;if(!t.checkChecksum(I))throw new xt;var T=(o[1]+o[0])/2,N=(f[1]+f[0])/2,k=this.getBarcodeFormat(),P=[new X(T,e),new X(N,e)],B=new pe(I,null,0,P,k,new Date().getTime()),F=0;try{var S=CE.decodeRow(e,r,f[1]);B.putMetadata(Wt.UPC_EAN_EXTENSION,S.getText()),B.putAllMetadata(S.getResultMetadata()),B.addResultPoints(S.getResultPoints()),F=S.getText().length}catch{}var A=i==null?null:i.get(_t.ALLOWED_EAN_EXTENSIONS);if(A!=null){var C=!1;for(var R in A)if(F.toString()===R){C=!0;break}if(!C)throw new V}return k===Y.EAN_13||Y.UPC_A,B},t.checkChecksum=function(e){return t.checkStandardUPCEANChecksum(e)},t.checkStandardUPCEANChecksum=function(e){var r=e.length;if(r===0)return!1;var i=parseInt(e.charAt(r-1),10);return t.getStandardUPCEANChecksum(e.substring(0,r-1))===i},t.getStandardUPCEANChecksum=function(e){for(var r=e.length,i=0,o=r-1;o>=0;o-=2){if((s=e.charAt(o).charCodeAt(0)-48)<0||s>9)throw new W;i+=s}for(i*=3,o=r-2;o>=0;o-=2){var s;if((s=e.charAt(o).charCodeAt(0)-48)<0||s>9)throw new W;i+=s}return(1e3-i)%10},t.decodeEnd=function(e,r){return t.findGuardPattern(e,r,!1,t.START_END_PATTERN,new Int32Array(t.START_END_PATTERN.length).fill(0))},t}(wr),bE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),fh=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Va=function(n){function t(){var e=n.call(this)||this;return e.decodeMiddleCounters=Int32Array.from([0,0,0,0]),e}return bE(t,n),t.prototype.decodeMiddle=function(e,r,i){var o,s,a,u,c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;for(var h=e.getSize(),d=r[1],f=0,g=0;g<6&&d<h;g++){var _=Pt.decodeDigit(e,c,d,Pt.L_AND_G_PATTERNS);i+=String.fromCharCode(48+_%10);try{for(var v=(o=void 0,fh(c)),I=v.next();!I.done;I=v.next())d+=I.value}catch(k){o={error:k}}finally{try{I&&!I.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}_>=10&&(f|=1<<5-g)}for(i=t.determineFirstDigit(i,f),d=Pt.findGuardPattern(e,d,!0,Pt.MIDDLE_PATTERN,new Int32Array(Pt.MIDDLE_PATTERN.length).fill(0))[1],g=0;g<6&&d<h;g++){_=Pt.decodeDigit(e,c,d,Pt.L_PATTERNS),i+=String.fromCharCode(48+_);try{for(var T=(a=void 0,fh(c)),N=T.next();!N.done;N=T.next())d+=N.value}catch(k){a={error:k}}finally{try{N&&!N.done&&(u=T.return)&&u.call(T)}finally{if(a)throw a.error}}}return{rowOffset:d,resultString:i}},t.prototype.getBarcodeFormat=function(){return Y.EAN_13},t.determineFirstDigit=function(e,r){for(var i=0;i<10;i++)if(r===this.FIRST_DIGIT_ENCODINGS[i])return e=String.fromCharCode(48+i)+e;throw new V},t.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],t}(Pt),RE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ph=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},gh=function(n){function t(){var e=n.call(this)||this;return e.decodeMiddleCounters=Int32Array.from([0,0,0,0]),e}return RE(t,n),t.prototype.decodeMiddle=function(e,r,i){var o,s,a,u,c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;for(var h=e.getSize(),d=r[1],f=0;f<4&&d<h;f++){var g=Pt.decodeDigit(e,c,d,Pt.L_PATTERNS);i+=String.fromCharCode(48+g);try{for(var _=(o=void 0,ph(c)),v=_.next();!v.done;v=_.next())d+=v.value}catch(N){o={error:N}}finally{try{v&&!v.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}}for(d=Pt.findGuardPattern(e,d,!0,Pt.MIDDLE_PATTERN,new Int32Array(Pt.MIDDLE_PATTERN.length).fill(0))[1],f=0;f<4&&d<h;f++){g=Pt.decodeDigit(e,c,d,Pt.L_PATTERNS),i+=String.fromCharCode(48+g);try{for(var I=(a=void 0,ph(c)),T=I.next();!T.done;T=I.next())d+=T.value}catch(N){a={error:N}}finally{try{T&&!T.done&&(u=I.return)&&u.call(I)}finally{if(a)throw a.error}}}return{rowOffset:d,resultString:i}},t.prototype.getBarcodeFormat=function(){return Y.EAN_8},t}(Pt),NE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),OE=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.ean13Reader=new Va,e}return NE(t,n),t.prototype.getBarcodeFormat=function(){return Y.UPC_A},t.prototype.decode=function(e,r){return this.maybeReturnResult(this.ean13Reader.decode(e))},t.prototype.decodeRow=function(e,r,i){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,r,i))},t.prototype.decodeMiddle=function(e,r,i){return this.ean13Reader.decodeMiddle(e,r,i)},t.prototype.maybeReturnResult=function(e){var r=e.getText();if(r.charAt(0)==="0"){var i=new pe(r.substring(1),null,null,e.getResultPoints(),Y.UPC_A);return e.getResultMetadata()!=null&&i.putAllMetadata(e.getResultMetadata()),i}throw new V},t.prototype.reset=function(){this.ean13Reader.reset()},t}(Pt),PE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),DE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},mh=function(n){function t(){var e=n.call(this)||this;return e.decodeMiddleCounters=new Int32Array(4),e}return PE(t,n),t.prototype.decodeMiddle=function(e,r,i){var o,s,a=this.decodeMiddleCounters.map(function(v){return v});a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var u=e.getSize(),c=r[1],h=0,d=0;d<6&&c<u;d++){var f=t.decodeDigit(e,a,c,t.L_AND_G_PATTERNS);i+=String.fromCharCode(48+f%10);try{for(var g=(o=void 0,DE(a)),_=g.next();!_.done;_=g.next())c+=_.value}catch(v){o={error:v}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}f>=10&&(h|=1<<5-d)}return t.determineNumSysAndCheckDigit(new pt(i),h),c},t.prototype.decodeEnd=function(e,r){return t.findGuardPatternWithoutCounters(e,r,!0,t.MIDDLE_END_PATTERN)},t.prototype.checkChecksum=function(e){return Pt.checkChecksum(t.convertUPCEtoUPCA(e))},t.determineNumSysAndCheckDigit=function(e,r){for(var i=0;i<=1;i++)for(var o=0;o<10;o++)if(r===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[i][o])return e.insert(0,"0"+i),void e.append("0"+o);throw V.getNotFoundInstance()},t.prototype.getBarcodeFormat=function(){return Y.UPC_E},t.convertUPCEtoUPCA=function(e){var r=e.slice(1,7).split("").map(function(s){return s.charCodeAt(0)}),i=new pt;i.append(e.charAt(0));var o=r[5];switch(o){case 0:case 1:case 2:i.appendChars(r,0,2),i.append(o),i.append("0000"),i.appendChars(r,2,3);break;case 3:i.appendChars(r,0,3),i.append("00000"),i.appendChars(r,3,2);break;case 4:i.appendChars(r,0,4),i.append("00000"),i.append(r[4]);break;default:i.appendChars(r,0,5),i.append("0000"),i.append(o)}return e.length>=8&&i.append(e.charAt(7)),i.toString()},t.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),t.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],t}(Pt),xE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),_h=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},oa=function(n){function t(e){var r=n.call(this)||this,i=e==null?null:e.get(_t.POSSIBLE_FORMATS),o=[];return i!=null&&(i.indexOf(Y.EAN_13)>-1?o.push(new Va):i.indexOf(Y.UPC_A)>-1&&o.push(new OE),i.indexOf(Y.EAN_8)>-1&&o.push(new gh),i.indexOf(Y.UPC_E)>-1&&o.push(new mh)),o.length===0&&(o.push(new Va),o.push(new gh),o.push(new mh)),r.readers=o,r}return xE(t,n),t.prototype.decodeRow=function(e,r,i){var o,s;try{for(var a=_h(this.readers),u=a.next();!u.done;u=a.next()){var c=u.value;try{var h=c.decodeRow(e,r,i),d=h.getBarcodeFormat()===Y.EAN_13&&h.getText().charAt(0)==="0",f=i==null?null:i.get(_t.POSSIBLE_FORMATS),g=f==null||f.includes(Y.UPC_A);if(d&&g){var _=h.getRawBytes(),v=new pe(h.getText().substring(1),_,_.length,h.getResultPoints(),Y.UPC_A);return v.putAllMetadata(h.getResultMetadata()),v}return h}catch{}}}catch(I){o={error:I}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}throw new V},t.prototype.reset=function(){var e,r;try{for(var i=_h(this.readers),o=i.next();!o.done;o=i.next())o.value.reset()}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},t}(zt),ME=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),kE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},xn=function(n){function t(){var e=n.call(this)||this;return e.decodeFinderCounters=new Int32Array(4),e.dataCharacterCounters=new Int32Array(8),e.oddRoundingErrors=new Array(4),e.evenRoundingErrors=new Array(4),e.oddCounts=new Array(e.dataCharacterCounters.length/2),e.evenCounts=new Array(e.dataCharacterCounters.length/2),e}return ME(t,n),t.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},t.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},t.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},t.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},t.prototype.getOddCounts=function(){return this.oddCounts},t.prototype.getEvenCounts=function(){return this.evenCounts},t.prototype.parseFinderValue=function(e,r){for(var i=0;i<r.length;i++)if(zt.patternMatchVariance(e,r[i],t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return i;throw new V},t.count=function(e){return at.sum(new Int32Array(e))},t.increment=function(e,r){for(var i=0,o=r[0],s=1;s<e.length;s++)r[s]>o&&(o=r[s],i=s);e[i]++},t.decrement=function(e,r){for(var i=0,o=r[0],s=1;s<e.length;s++)r[s]<o&&(o=r[s],i=s);e[i]--},t.isFinderPattern=function(e){var r,i,o=e[0]+e[1],s=o/(o+e[2]+e[3]);if(s>=t.MIN_FINDER_PATTERN_RATIO&&s<=t.MAX_FINDER_PATTERN_RATIO){var a=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var c=kE(e),h=c.next();!h.done;h=c.next()){var d=h.value;d>u&&(u=d),d<a&&(a=d)}}catch(f){r={error:f}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return u<10*a}return!1},t.MAX_AVG_VARIANCE=.2,t.MAX_INDIVIDUAL_VARIANCE=.45,t.MIN_FINDER_PATTERN_RATIO=9.5/12,t.MAX_FINDER_PATTERN_RATIO=12.5/14,t}(zt),Go=function(){function n(t,e){this.value=t,this.checksumPortion=e}return n.prototype.getValue=function(){return this.value},n.prototype.getChecksumPortion=function(){return this.checksumPortion},n.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.value===e.value&&this.checksumPortion===e.checksumPortion},n.prototype.hashCode=function(){return this.value^this.checksumPortion},n}(),I1=function(){function n(t,e,r,i,o){this.value=t,this.startEnd=e,this.value=t,this.startEnd=e,this.resultPoints=new Array,this.resultPoints.push(new X(r,o)),this.resultPoints.push(new X(i,o))}return n.prototype.getValue=function(){return this.value},n.prototype.getStartEnd=function(){return this.startEnd},n.prototype.getResultPoints=function(){return this.resultPoints},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.value===e.value},n.prototype.hashCode=function(){return this.value},n}(),LE=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rr=function(){function n(){}return n.getRSSvalue=function(t,e,r){var i,o,s=0;try{for(var a=LE(t),u=a.next();!u.done;u=a.next())s+=u.value}catch(T){i={error:T}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}for(var c=0,h=0,d=t.length,f=0;f<d-1;f++){var g=void 0;for(g=1,h|=1<<f;g<t[f];g++,h&=~(1<<f)){var _=n.combins(s-g-1,d-f-2);if(r&&h===0&&s-g-(d-f-1)>=d-f-1&&(_-=n.combins(s-g-(d-f),d-f-2)),d-f-1>1){for(var v=0,I=s-g-(d-f-2);I>e;I--)v+=n.combins(s-g-I-1,d-f-3);_-=v*(d-1-f)}else s-g>e&&_--;c+=_}s-=g}return c},n.combins=function(t,e){var r,i;t-e>e?(i=e,r=t-e):(i=t-e,r=e);for(var o=1,s=1,a=t;a>r;a--)o*=a,s<=i&&(o/=s,s++);for(;s<=i;)o/=s,s++;return o},n}(),VE=function(){function n(){}return n.buildBitArray=function(t){var e=2*t.length-1;t[t.length-1].getRightChar()==null&&(e-=1);for(var r=new be(12*e),i=0,o=t[0].getRightChar().getValue(),s=11;s>=0;--s)o&1<<s&&r.set(i),i++;for(s=1;s<t.length;++s){for(var a=t[s],u=a.getLeftChar().getValue(),c=11;c>=0;--c)u&1<<c&&r.set(i),i++;if(a.getRightChar()!=null){var h=a.getRightChar().getValue();for(c=11;c>=0;--c)h&1<<c&&r.set(i),i++}}return r},n}(),Nn=function(){function n(t,e){e?this.decodedInformation=null:(this.finished=t,this.decodedInformation=e)}return n.prototype.getDecodedInformation=function(){return this.decodedInformation},n.prototype.isFinished=function(){return this.finished},n}(),ju=function(){function n(t){this.newPosition=t}return n.prototype.getNewPosition=function(){return this.newPosition},n}(),BE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ie=function(n){function t(e,r){var i=n.call(this,e)||this;return i.value=r,i}return BE(t,n),t.prototype.getValue=function(){return this.value},t.prototype.isFNC1=function(){return this.value===t.FNC1},t.FNC1="$",t}(ju),FE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),On=function(n){function t(e,r,i){var o=n.call(this,e)||this;return i?(o.remaining=!0,o.remainingValue=o.remainingValue):(o.remaining=!1,o.remainingValue=0),o.newString=r,o}return FE(t,n),t.prototype.getNewString=function(){return this.newString},t.prototype.isRemaining=function(){return this.remaining},t.prototype.getRemainingValue=function(){return this.remainingValue},t}(ju),UE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),oo=function(n){function t(e,r,i){var o=n.call(this,e)||this;if(r<0||r>10||i<0||i>10)throw new W;return o.firstDigit=r,o.secondDigit=i,o}return UE(t,n),t.prototype.getFirstDigit=function(){return this.firstDigit},t.prototype.getSecondDigit=function(){return this.secondDigit},t.prototype.getValue=function(){return 10*this.firstDigit+this.secondDigit},t.prototype.isFirstDigitFNC1=function(){return this.firstDigit===t.FNC1},t.prototype.isSecondDigitFNC1=function(){return this.secondDigit===t.FNC1},t.prototype.isAnyFNC1=function(){return this.firstDigit===t.FNC1||this.secondDigit===t.FNC1},t.FNC1=10,t}(ju),so=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},jE=function(){function n(){}return n.parseFieldsInGeneralPurpose=function(t){var e,r,i,o,s,a,u,c;if(!t)return null;if(t.length<2)throw new V;var h=t.substring(0,2);try{for(var d=so(n.TWO_DIGIT_DATA_LENGTH),f=d.next();!f.done;f=d.next())if((B=f.value)[0]===h)return B[1]===n.VARIABLE_LENGTH?n.processVariableAI(2,B[2],t):n.processFixedAI(2,B[1],t)}catch(F){e={error:F}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}if(t.length<3)throw new V;var g=t.substring(0,3);try{for(var _=so(n.THREE_DIGIT_DATA_LENGTH),v=_.next();!v.done;v=_.next())if((B=v.value)[0]===g)return B[1]===n.VARIABLE_LENGTH?n.processVariableAI(3,B[2],t):n.processFixedAI(3,B[1],t)}catch(F){i={error:F}}finally{try{v&&!v.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}try{for(var I=so(n.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),T=I.next();!T.done;T=I.next())if((B=T.value)[0]===g)return B[1]===n.VARIABLE_LENGTH?n.processVariableAI(4,B[2],t):n.processFixedAI(4,B[1],t)}catch(F){s={error:F}}finally{try{T&&!T.done&&(a=I.return)&&a.call(I)}finally{if(s)throw s.error}}if(t.length<4)throw new V;var N=t.substring(0,4);try{for(var k=so(n.FOUR_DIGIT_DATA_LENGTH),P=k.next();!P.done;P=k.next()){var B;if((B=P.value)[0]===N)return B[1]===n.VARIABLE_LENGTH?n.processVariableAI(4,B[2],t):n.processFixedAI(4,B[1],t)}}catch(F){u={error:F}}finally{try{P&&!P.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}throw new V},n.processFixedAI=function(t,e,r){if(r.length<t)throw new V;var i=r.substring(0,t);if(r.length<t+e)throw new V;var o=r.substring(t,t+e),s=r.substring(t+e),a="("+i+")"+o,u=n.parseFieldsInGeneralPurpose(s);return u==null?a:a+u},n.processVariableAI=function(t,e,r){var i,o=r.substring(0,t);i=r.length<t+e?r.length:t+e;var s=r.substring(t,i),a=r.substring(i),u="("+o+")"+s,c=n.parseFieldsInGeneralPurpose(a);return c==null?u:u+c},n.VARIABLE_LENGTH=[],n.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",n.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",n.VARIABLE_LENGTH,20],["22",n.VARIABLE_LENGTH,29],["30",n.VARIABLE_LENGTH,8],["37",n.VARIABLE_LENGTH,8],["90",n.VARIABLE_LENGTH,30],["91",n.VARIABLE_LENGTH,30],["92",n.VARIABLE_LENGTH,30],["93",n.VARIABLE_LENGTH,30],["94",n.VARIABLE_LENGTH,30],["95",n.VARIABLE_LENGTH,30],["96",n.VARIABLE_LENGTH,30],["97",n.VARIABLE_LENGTH,3],["98",n.VARIABLE_LENGTH,30],["99",n.VARIABLE_LENGTH,30]],n.THREE_DIGIT_DATA_LENGTH=[["240",n.VARIABLE_LENGTH,30],["241",n.VARIABLE_LENGTH,30],["242",n.VARIABLE_LENGTH,6],["250",n.VARIABLE_LENGTH,30],["251",n.VARIABLE_LENGTH,30],["253",n.VARIABLE_LENGTH,17],["254",n.VARIABLE_LENGTH,20],["400",n.VARIABLE_LENGTH,30],["401",n.VARIABLE_LENGTH,30],["402",17],["403",n.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",n.VARIABLE_LENGTH,20],["421",n.VARIABLE_LENGTH,15],["422",3],["423",n.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],n.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",n.VARIABLE_LENGTH,15],["391",n.VARIABLE_LENGTH,18],["392",n.VARIABLE_LENGTH,15],["393",n.VARIABLE_LENGTH,18],["703",n.VARIABLE_LENGTH,30]],n.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",n.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",n.VARIABLE_LENGTH,20],["8003",n.VARIABLE_LENGTH,30],["8004",n.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",n.VARIABLE_LENGTH,30],["8008",n.VARIABLE_LENGTH,12],["8018",18],["8020",n.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",n.VARIABLE_LENGTH,70],["8200",n.VARIABLE_LENGTH,70]],n}(),Io=function(){function n(t){this.buffer=new pt,this.information=t}return n.prototype.decodeAllCodes=function(t,e){for(var r=e,i=null;;){var o=this.decodeGeneralPurposeField(r,i),s=jE.parseFieldsInGeneralPurpose(o.getNewString());if(s!=null&&t.append(s),i=o.isRemaining()?""+o.getRemainingValue():null,r===o.getNewPosition())break;r=o.getNewPosition()}return t.toString()},n.prototype.isStillNumeric=function(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(var e=t;e<t+3;++e)if(this.information.get(e))return!0;return this.information.get(t+3)},n.prototype.decodeNumeric=function(t){if(t+7>this.information.getSize()){var e=this.extractNumericValueFromBitArray(t,4);return new oo(this.information.getSize(),e===0?oo.FNC1:e-1,oo.FNC1)}var r=this.extractNumericValueFromBitArray(t,7);return new oo(t+7,(r-8)/11,(r-8)%11)},n.prototype.extractNumericValueFromBitArray=function(t,e){return n.extractNumericValueFromBitArray(this.information,t,e)},n.extractNumericValueFromBitArray=function(t,e,r){for(var i=0,o=0;o<r;++o)t.get(e+o)&&(i|=1<<r-o-1);return i},n.prototype.decodeGeneralPurposeField=function(t,e){this.buffer.setLengthToZero(),e!=null&&this.buffer.append(e),this.current.setPosition(t);var r=this.parseBlocks();return r!=null&&r.isRemaining()?new On(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new On(this.current.getPosition(),this.buffer.toString())},n.prototype.parseBlocks=function(){var t,e;do{var r=this.current.getPosition();if(t=this.current.isAlpha()?(e=this.parseAlphaBlock()).isFinished():this.current.isIsoIec646()?(e=this.parseIsoIec646Block()).isFinished():(e=this.parseNumericBlock()).isFinished(),r===this.current.getPosition()&&!t)break}while(!t);return e.getDecodedInformation()},n.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){var e=void 0;return e=t.isSecondDigitFNC1()?new On(this.current.getPosition(),this.buffer.toString()):new On(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new Nn(!0,e)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1())return e=new On(this.current.getPosition(),this.buffer.toString()),new Nn(!0,e);this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Nn(!1)},n.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){var e=new On(this.current.getPosition(),this.buffer.toString());return new Nn(!0,e)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Nn(!1)},n.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){var e=new On(this.current.getPosition(),this.buffer.toString());return new Nn(!0,e)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Nn(!1)},n.prototype.isStillIsoIec646=function(t){if(t+5>this.information.getSize())return!1;var e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+7>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(t,7);if(r>=64&&r<116)return!0;if(t+8>this.information.getSize())return!1;var i=this.extractNumericValueFromBitArray(t,8);return i>=232&&i<253},n.prototype.decodeIsoIec646=function(t){var e=this.extractNumericValueFromBitArray(t,5);if(e===15)return new Ie(t+5,Ie.FNC1);if(e>=5&&e<15)return new Ie(t+5,"0"+(e-5));var r,i=this.extractNumericValueFromBitArray(t,7);if(i>=64&&i<90)return new Ie(t+7,""+(i+1));if(i>=90&&i<116)return new Ie(t+7,""+(i+7));switch(this.extractNumericValueFromBitArray(t,8)){case 232:r="!";break;case 233:r='"';break;case 234:r="%";break;case 235:r="&";break;case 236:r="'";break;case 237:r="(";break;case 238:r=")";break;case 239:r="*";break;case 240:r="+";break;case 241:r=",";break;case 242:r="-";break;case 243:r=".";break;case 244:r="/";break;case 245:r=":";break;case 246:r=";";break;case 247:r="<";break;case 248:r="=";break;case 249:r=">";break;case 250:r="?";break;case 251:r="_";break;case 252:r=" ";break;default:throw new W}return new Ie(t+8,r)},n.prototype.isStillAlpha=function(t){if(t+5>this.information.getSize())return!1;var e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+6>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(t,6);return r>=16&&r<63},n.prototype.decodeAlphanumeric=function(t){var e=this.extractNumericValueFromBitArray(t,5);if(e===15)return new Ie(t+5,Ie.FNC1);if(e>=5&&e<15)return new Ie(t+5,"0"+(e-5));var r,i=this.extractNumericValueFromBitArray(t,6);if(i>=32&&i<58)return new Ie(t+6,""+(i+33));switch(i){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new Oi("Decoding invalid alphanumeric value: "+i)}return new Ie(t+6,r)},n.prototype.isAlphaTo646ToAlphaLatch=function(t){if(t+1>this.information.getSize())return!1;for(var e=0;e<5&&e+t<this.information.getSize();++e)if(e===2){if(!this.information.get(t+2))return!1}else if(this.information.get(t+e))return!1;return!0},n.prototype.isAlphaOr646ToNumericLatch=function(t){if(t+3>this.information.getSize())return!1;for(var e=t;e<t+3;++e)if(this.information.get(e))return!1;return!0},n.prototype.isNumericToAlphaNumericLatch=function(t){if(t+1>this.information.getSize())return!1;for(var e=0;e<4&&e+t<this.information.getSize();++e)if(this.information.get(t+e))return!1;return!0},n}(),A1=function(){function n(t){this.information=t,this.generalDecoder=new Io(t)}return n.prototype.getInformation=function(){return this.information},n.prototype.getGeneralDecoder=function(){return this.generalDecoder},n}(),HE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ae=function(n){function t(e){return n.call(this,e)||this}return HE(t,n),t.prototype.encodeCompressedGtin=function(e,r){e.append("(01)");var i=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,r,i)},t.prototype.encodeCompressedGtinWithoutAI=function(e,r,i){for(var o=0;o<4;++o){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(r+10*o,10);s/100==0&&e.append("0"),s/10==0&&e.append("0"),e.append(s)}t.appendCheckDigit(e,i)},t.appendCheckDigit=function(e,r){for(var i=0,o=0;o<13;o++){var s=e.charAt(o+r).charCodeAt(0)-48;i+=1&o?s:3*s}(i=10-i%10)===10&&(i=0),e.append(i)},t.GTIN_SIZE=40,t}(A1),GE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),WE=function(n){function t(e){return n.call(this,e)||this}return GE(t,n),t.prototype.parseInformation=function(){var e=new pt;e.append("(01)");var r=e.length(),i=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE,4);return e.append(i),this.encodeCompressedGtinWithoutAI(e,t.HEADER_SIZE+4,r),this.getGeneralDecoder().decodeAllCodes(e,t.HEADER_SIZE+44)},t.HEADER_SIZE=4,t}(Ae),zE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),XE=function(n){function t(e){return n.call(this,e)||this}return zE(t,n),t.prototype.parseInformation=function(){var e=new pt;return this.getGeneralDecoder().decodeAllCodes(e,t.HEADER_SIZE)},t.HEADER_SIZE=5,t}(A1),qE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ao=function(n){function t(e){return n.call(this,e)||this}return qE(t,n),t.prototype.encodeCompressedWeight=function(e,r,i){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(r,i);this.addWeightCode(e,o);for(var s=this.checkWeight(o),a=1e5,u=0;u<5;++u)s/a==0&&e.append("0"),a/=10;e.append(s)},t}(Ae),$E=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),T1=function(n){function t(e){return n.call(this,e)||this}return $E(t,n),t.prototype.parseInformation=function(){if(this.getInformation().getSize()!=t.HEADER_SIZE+Ao.GTIN_SIZE+t.WEIGHT_SIZE)throw new V;var e=new pt;return this.encodeCompressedGtin(e,t.HEADER_SIZE),this.encodeCompressedWeight(e,t.HEADER_SIZE+Ao.GTIN_SIZE,t.WEIGHT_SIZE),e.toString()},t.HEADER_SIZE=5,t.WEIGHT_SIZE=15,t}(Ao),KE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),YE=function(n){function t(e){return n.call(this,e)||this}return KE(t,n),t.prototype.addWeightCode=function(e,r){e.append("(3103)")},t.prototype.checkWeight=function(e){return e},t}(T1),QE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ZE=function(n){function t(e){return n.call(this,e)||this}return QE(t,n),t.prototype.addWeightCode=function(e,r){r<1e4?e.append("(3202)"):e.append("(3203)")},t.prototype.checkWeight=function(e){return e<1e4?e:e-1e4},t}(T1),JE=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),t4=function(n){function t(e){return n.call(this,e)||this}return JE(t,n),t.prototype.parseInformation=function(){if(this.getInformation().getSize()<t.HEADER_SIZE+Ae.GTIN_SIZE)throw new V;var e=new pt;this.encodeCompressedGtin(e,t.HEADER_SIZE);var r=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+Ae.GTIN_SIZE,t.LAST_DIGIT_SIZE);e.append("(392"),e.append(r),e.append(")");var i=this.getGeneralDecoder().decodeGeneralPurposeField(t.HEADER_SIZE+Ae.GTIN_SIZE+t.LAST_DIGIT_SIZE,null);return e.append(i.getNewString()),e.toString()},t.HEADER_SIZE=8,t.LAST_DIGIT_SIZE=2,t}(Ae),e4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),n4=function(n){function t(e){return n.call(this,e)||this}return e4(t,n),t.prototype.parseInformation=function(){if(this.getInformation().getSize()<t.HEADER_SIZE+Ae.GTIN_SIZE)throw new V;var e=new pt;this.encodeCompressedGtin(e,t.HEADER_SIZE);var r=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+Ae.GTIN_SIZE,t.LAST_DIGIT_SIZE);e.append("(393"),e.append(r),e.append(")");var i=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+Ae.GTIN_SIZE+t.LAST_DIGIT_SIZE,t.FIRST_THREE_DIGITS_SIZE);i/100==0&&e.append("0"),i/10==0&&e.append("0"),e.append(i);var o=this.getGeneralDecoder().decodeGeneralPurposeField(t.HEADER_SIZE+Ae.GTIN_SIZE+t.LAST_DIGIT_SIZE+t.FIRST_THREE_DIGITS_SIZE,null);return e.append(o.getNewString()),e.toString()},t.HEADER_SIZE=8,t.LAST_DIGIT_SIZE=2,t.FIRST_THREE_DIGITS_SIZE=10,t}(Ae),r4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),rn=function(n){function t(e,r,i){var o=n.call(this,e)||this;return o.dateCode=i,o.firstAIdigits=r,o}return r4(t,n),t.prototype.parseInformation=function(){if(this.getInformation().getSize()!=t.HEADER_SIZE+t.GTIN_SIZE+t.WEIGHT_SIZE+t.DATE_SIZE)throw new V;var e=new pt;return this.encodeCompressedGtin(e,t.HEADER_SIZE),this.encodeCompressedWeight(e,t.HEADER_SIZE+t.GTIN_SIZE,t.WEIGHT_SIZE),this.encodeCompressedDate(e,t.HEADER_SIZE+t.GTIN_SIZE+t.WEIGHT_SIZE),e.toString()},t.prototype.encodeCompressedDate=function(e,r){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(r,t.DATE_SIZE);if(i!=38400){e.append("("),e.append(this.dateCode),e.append(")");var o=i%32,s=(i/=32)%12+1,a=i/=12;a/10==0&&e.append("0"),e.append(a),s/10==0&&e.append("0"),e.append(s),o/10==0&&e.append("0"),e.append(o)}},t.prototype.addWeightCode=function(e,r){e.append("("),e.append(this.firstAIdigits),e.append(r/1e5),e.append(")")},t.prototype.checkWeight=function(e){return e%1e5},t.HEADER_SIZE=8,t.WEIGHT_SIZE=20,t.DATE_SIZE=16,t}(Ao),yh=function(){function n(t,e,r,i){this.leftchar=t,this.rightchar=e,this.finderpattern=r,this.maybeLast=i}return n.prototype.mayBeLast=function(){return this.maybeLast},n.prototype.getLeftChar=function(){return this.leftchar},n.prototype.getRightChar=function(){return this.rightchar},n.prototype.getFinderPattern=function(){return this.finderpattern},n.prototype.mustBeLast=function(){return this.rightchar==null},n.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},n.equals=function(t,e){return t instanceof n&&n.equalsOrNull(t.leftchar,e.leftchar)&&n.equalsOrNull(t.rightchar,e.rightchar)&&n.equalsOrNull(t.finderpattern,e.finderpattern)},n.equalsOrNull=function(t,e){return t===null?e===null:n.equals(t,e)},n.prototype.hashCode=function(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()},n}(),i4=function(){function n(t,e,r){this.pairs=t,this.rowNumber=e,this.wasReversed=r}return n.prototype.getPairs=function(){return this.pairs},n.prototype.getRowNumber=function(){return this.rowNumber},n.prototype.isReversed=function(){return this.wasReversed},n.prototype.isEquivalent=function(t){return this.checkEqualitity(this,t)},n.prototype.toString=function(){return"{ "+this.pairs+" }"},n.prototype.equals=function(t,e){return t instanceof n&&this.checkEqualitity(t,e)&&t.wasReversed===e.wasReversed},n.prototype.checkEqualitity=function(t,e){var r;if(t&&e)return t.forEach(function(i,o){e.forEach(function(s){i.getLeftChar().getValue()===s.getLeftChar().getValue()&&i.getRightChar().getValue()===s.getRightChar().getValue()&&i.getFinderPatter().getValue()===s.getFinderPatter().getValue()&&(r=!0)})}),r},n}(),o4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),on=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s4=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.pairs=new Array(t.MAX_PAIRS),e.rows=new Array,e.startEnd=[2],e}return o4(t,n),t.prototype.decodeRow=function(e,r,i){this.pairs.length=0,this.startFromEven=!1;try{return t.constructResult(this.decodeRow2pairs(e,r))}catch{}return this.pairs.length=0,this.startFromEven=!0,t.constructResult(this.decodeRow2pairs(e,r))},t.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},t.prototype.decodeRow2pairs=function(e,r){for(var i,o=!1;!o;)try{this.pairs.push(this.retrieveNextPair(r,this.pairs,e))}catch(a){if(a instanceof V){if(!this.pairs.length)throw new V;o=!0}}if(this.checkChecksum())return this.pairs;if(i=!!this.rows.length,this.storeRow(e,!1),i){var s=this.checkRowsBoolean(!1);if(s!=null||(s=this.checkRowsBoolean(!0))!=null)return s}throw new V},t.prototype.checkRowsBoolean=function(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());var r=null;try{r=this.checkRows(new Array,0)}catch(i){console.log(i)}return e&&(this.rows=this.rows.reverse()),r},t.prototype.checkRows=function(e,r){for(var i,o,s=r;s<this.rows.length;s++){var a=this.rows[s];this.pairs.length=0;try{for(var u=(i=void 0,on(e)),c=u.next();!c.done;c=u.next()){var h=c.value;this.pairs.push(h.getPairs())}}catch(f){i={error:f}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}if(this.pairs.push(a.getPairs()),t.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var d=new Array(e);d.push(a);try{return this.checkRows(d,s+1)}catch(f){console.log(f)}}}throw new V},t.isValidSequence=function(e){var r,i;try{for(var o=on(t.FINDER_PATTERN_SEQUENCES),s=o.next();!s.done;s=o.next()){var a=s.value;if(!(e.length>a.length)){for(var u=!0,c=0;c<e.length;c++)if(e[c].getFinderPattern().getValue()!=a[c]){u=!1;break}if(u)return!0}}}catch(h){r={error:h}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return!1},t.prototype.storeRow=function(e,r){for(var i=0,o=!1,s=!1;i<this.rows.length;){var a=this.rows[i];if(a.getRowNumber()>e){s=a.isEquivalent(this.pairs);break}o=a.isEquivalent(this.pairs),i++}s||o||t.isPartialRow(this.pairs,this.rows)||(this.rows.push(i,new i4(this.pairs,e,r)),this.removePartialRows(this.pairs,this.rows))},t.prototype.removePartialRows=function(e,r){var i,o,s,a,u,c;try{for(var h=on(r),d=h.next();!d.done;d=h.next()){var f=d.value;if(f.getPairs().length!==e.length)try{for(var g=(s=void 0,on(f.getPairs())),_=g.next();!_.done;_=g.next()){var v=_.value,I=!1;try{for(var T=(u=void 0,on(e)),N=T.next();!N.done;N=T.next()){var k=N.value;if(yh.equals(v,k)){I=!0;break}}}catch(P){u={error:P}}finally{try{N&&!N.done&&(c=T.return)&&c.call(T)}finally{if(u)throw u.error}}}}catch(P){s={error:P}}finally{try{_&&!_.done&&(a=g.return)&&a.call(g)}finally{if(s)throw s.error}}}}catch(P){i={error:P}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}},t.isPartialRow=function(e,r){var i,o,s,a,u,c;try{for(var h=on(r),d=h.next();!d.done;d=h.next()){var f=d.value,g=!0;try{for(var _=(s=void 0,on(e)),v=_.next();!v.done;v=_.next()){var I=v.value,T=!1;try{for(var N=(u=void 0,on(f.getPairs())),k=N.next();!k.done;k=N.next()){var P=k.value;if(I.equals(P)){T=!0;break}}}catch(B){u={error:B}}finally{try{k&&!k.done&&(c=N.return)&&c.call(N)}finally{if(u)throw u.error}}if(!T){g=!1;break}}}catch(B){s={error:B}}finally{try{v&&!v.done&&(a=_.return)&&a.call(_)}finally{if(s)throw s.error}}if(g)return!0}}catch(B){i={error:B}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}return!1},t.prototype.getRows=function(){return this.rows},t.constructResult=function(e){var r=function(a){try{if(a.get(1))return new WE(a);if(!a.get(2))return new XE(a);switch(Io.extractNumericValueFromBitArray(a,1,4)){case 4:return new YE(a);case 5:return new ZE(a)}switch(Io.extractNumericValueFromBitArray(a,1,5)){case 12:return new t4(a);case 13:return new n4(a)}switch(Io.extractNumericValueFromBitArray(a,1,7)){case 56:return new rn(a,"310","11");case 57:return new rn(a,"320","11");case 58:return new rn(a,"310","13");case 59:return new rn(a,"320","13");case 60:return new rn(a,"310","15");case 61:return new rn(a,"320","15");case 62:return new rn(a,"310","17");case 63:return new rn(a,"320","17")}}catch(u){throw console.log(u),new Oi("unknown decoder: "+a)}}(VE.buildBitArray(e)).parseInformation(),i=e[0].getFinderPattern().getResultPoints(),o=e[e.length-1].getFinderPattern().getResultPoints(),s=[i[0],i[1],o[0],o[1]];return new pe(r,null,null,s,Y.RSS_EXPANDED,null)},t.prototype.checkChecksum=function(){var e=this.pairs.get(0),r=e.getLeftChar(),i=e.getRightChar();if(i==null)return!1;for(var o=i.getChecksumPortion(),s=2,a=1;a<this.pairs.size();++a){var u=this.pairs.get(a);o+=u.getLeftChar().getChecksumPortion(),s++;var c=u.getRightChar();c!=null&&(o+=c.getChecksumPortion(),s++)}return 211*(s-4)+(o%=211)==r.getValue()},t.getNextSecondBar=function(e,r){var i;return e.get(r)?(i=e.getNextUnset(r),i=e.getNextSet(i)):(i=e.getNextSet(r),i=e.getNextUnset(i)),i},t.prototype.retrieveNextPair=function(e,r,i){var o,s=r.length%2==0;this.startFromEven&&(s=!s);var a=!0,u=-1;do this.findNextPair(e,r,u),(o=this.parseFoundFinderPattern(e,i,s))==null?u=t.getNextSecondBar(e,this.startEnd[0]):a=!1;while(a);var c,h=this.decodeDataCharacter(e,o,s,!0);if(!this.isEmptyPair(r)&&r[r.length-1].mustBeLast())throw new V;try{c=this.decodeDataCharacter(e,o,s,!1)}catch(d){c=null,console.log(d)}return new yh(h,c,o,!0)},t.prototype.isEmptyPair=function(e){return e.length===0},t.prototype.findNextPair=function(e,r,i){var o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;var s,a=e.getSize();i>=0?s=i:this.isEmptyPair(r)?s=0:s=r[r.length-1].getFinderPattern().getStartEnd()[1];var u=r.length%2!=0;this.startFromEven&&(u=!u);for(var c=!1;s<a&&(c=!e.get(s));)s++;for(var h=0,d=s,f=s;f<a;f++)if(e.get(f)!=c)o[h]++;else{if(h==3){if(u&&t.reverseCounters(o),t.isFinderPattern(o))return this.startEnd[0]=d,void(this.startEnd[1]=f);u&&t.reverseCounters(o),d+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,h--}else h++;o[h]=1,c=!c}throw new V},t.reverseCounters=function(e){for(var r=e.length,i=0;i<r/2;++i){var o=e[i];e[i]=e[r-i-1],e[r-i-1]=o}},t.prototype.parseFoundFinderPattern=function(e,r,i){var o,s,a;if(i){for(var u=this.startEnd[0]-1;u>=0&&!e.get(u);)u--;u++,o=this.startEnd[0]-u,s=u,a=this.startEnd[1]}else s=this.startEnd[0],o=(a=e.getNextUnset(this.startEnd[1]+1))-this.startEnd[1];var c,h=this.getDecodeFinderCounters();wt.arraycopy(h,0,h,1,h.length-1),h[0]=o;try{c=this.parseFinderValue(h,t.FINDER_PATTERNS)}catch{return null}return new I1(c,[s,a],s,a,r)},t.prototype.decodeDataCharacter=function(e,r,i,o){for(var s=this.getDataCharacterCounters(),a=0;a<s.length;a++)s[a]=0;if(o)t.recordPatternInReverse(e,r.getStartEnd()[0],s);else{t.recordPattern(e,r.getStartEnd()[1],s);for(var u=0,c=s.length-1;u<c;u++,c--){var h=s[u];s[u]=s[c],s[c]=h}}var d=at.sum(new Int32Array(s))/17,f=(r.getStartEnd()[1]-r.getStartEnd()[0])/15;if(Math.abs(d-f)/f>.3)throw new V;var g=this.getOddCounts(),_=this.getEvenCounts(),v=this.getOddRoundingErrors(),I=this.getEvenRoundingErrors();for(u=0;u<s.length;u++){var T=1*s[u]/d,N=T+.5;if(N<1){if(T<.3)throw new V;N=1}else if(N>8){if(T>8.7)throw new V;N=8}var k=u/2;1&u?(_[k]=N,I[k]=T-N):(g[k]=N,v[k]=T-N)}this.adjustOddEvenCounts(17);var P=4*r.getValue()+(i?0:2)+(o?0:1)-1,B=0,F=0;for(u=g.length-1;u>=0;u--){if(t.isNotA1left(r,i,o)){var S=t.WEIGHTS[P][2*u];F+=g[u]*S}B+=g[u]}var A=0;for(u=_.length-1;u>=0;u--)t.isNotA1left(r,i,o)&&(S=t.WEIGHTS[P][2*u+1],A+=_[u]*S);var C=F+A;if(1&B||B>13||B<4)throw new V;var R=(13-B)/2,O=t.SYMBOL_WIDEST[R],D=9-O,b=rr.getRSSvalue(g,O,!0),Nt=rr.getRSSvalue(_,D,!1),ue=t.EVEN_TOTAL_SUBSET[R],br=t.GSUM[R];return new Go(b*ue+Nt+br,C)},t.isNotA1left=function(e,r,i){return!(e.getValue()==0&&r&&i)},t.prototype.adjustOddEvenCounts=function(e){var r=at.sum(new Int32Array(this.getOddCounts())),i=at.sum(new Int32Array(this.getEvenCounts())),o=!1,s=!1;r>13?s=!0:r<4&&(o=!0);var a=!1,u=!1;i>13?u=!0:i<4&&(a=!0);var c=r+i-e,h=(1&r)==1,d=(1&i)==0;if(c==1)if(h){if(d)throw new V;s=!0}else{if(!d)throw new V;u=!0}else if(c==-1)if(h){if(d)throw new V;o=!0}else{if(!d)throw new V;a=!0}else{if(c!=0)throw new V;if(h){if(!d)throw new V;r<i?(o=!0,u=!0):(s=!0,a=!0)}else if(d)throw new V}if(o){if(s)throw new V;t.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&t.decrement(this.getOddCounts(),this.getOddRoundingErrors()),a){if(u)throw new V;t.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&t.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},t.SYMBOL_WIDEST=[7,5,4,3,1],t.EVEN_TOTAL_SUBSET=[4,20,52,104,204],t.GSUM=[0,348,1388,2948,3988],t.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],t.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],t.FINDER_PAT_A=0,t.FINDER_PAT_B=1,t.FINDER_PAT_C=2,t.FINDER_PAT_D=3,t.FINDER_PAT_E=4,t.FINDER_PAT_F=5,t.FINDER_PATTERN_SEQUENCES=[[t.FINDER_PAT_A,t.FINDER_PAT_A],[t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B],[t.FINDER_PAT_A,t.FINDER_PAT_C,t.FINDER_PAT_B,t.FINDER_PAT_D],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_C],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_D,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_D],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_E],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F]],t.MAX_PAIRS=11,t}(xn),a4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),u4=function(n){function t(e,r,i){var o=n.call(this,e,r)||this;return o.count=0,o.finderPattern=i,o}return a4(t,n),t.prototype.getFinderPattern=function(){return this.finderPattern},t.prototype.getCount=function(){return this.count},t.prototype.incrementCount=function(){this.count++},t}(Go),c4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),sa=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},wh=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.possibleLeftPairs=[],e.possibleRightPairs=[],e}return c4(t,n),t.prototype.decodeRow=function(e,r,i){var o,s,a,u,c=this.decodePair(r,!1,e,i);t.addOrTally(this.possibleLeftPairs,c),r.reverse();var h=this.decodePair(r,!0,e,i);t.addOrTally(this.possibleRightPairs,h),r.reverse();try{for(var d=sa(this.possibleLeftPairs),f=d.next();!f.done;f=d.next()){var g=f.value;if(g.getCount()>1)try{for(var _=(a=void 0,sa(this.possibleRightPairs)),v=_.next();!v.done;v=_.next()){var I=v.value;if(I.getCount()>1&&t.checkChecksum(g,I))return t.constructResult(g,I)}}catch(T){a={error:T}}finally{try{v&&!v.done&&(u=_.return)&&u.call(_)}finally{if(a)throw a.error}}}}catch(T){o={error:T}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}throw new V},t.addOrTally=function(e,r){var i,o;if(r!=null){var s=!1;try{for(var a=sa(e),u=a.next();!u.done;u=a.next()){var c=u.value;if(c.getValue()===r.getValue()){c.incrementCount(),s=!0;break}}}catch(h){i={error:h}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}s||e.push(r)}},t.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},t.constructResult=function(e,r){for(var i=4537077*e.getValue()+r.getValue(),o=new String(i).toString(),s=new pt,a=13-o.length;a>0;a--)s.append("0");s.append(o);var u=0;for(a=0;a<13;a++){var c=s.charAt(a).charCodeAt(0)-48;u+=1&a?c:3*c}(u=10-u%10)===10&&(u=0),s.append(u.toString());var h=e.getFinderPattern().getResultPoints(),d=r.getFinderPattern().getResultPoints();return new pe(s.toString(),null,0,[h[0],h[1],d[0],d[1]],Y.RSS_14,new Date().getTime())},t.checkChecksum=function(e,r){var i=(e.getChecksumPortion()+16*r.getChecksumPortion())%79,o=9*e.getFinderPattern().getValue()+r.getFinderPattern().getValue();return o>72&&o--,o>8&&o--,i===o},t.prototype.decodePair=function(e,r,i,o){try{var s=this.findFinderPattern(e,r),a=this.parseFoundFinderPattern(e,i,r,s),u=o==null?null:o.get(_t.NEED_RESULT_POINT_CALLBACK);if(u!=null){var c=(s[0]+s[1])/2;r&&(c=e.getSize()-1-c),u.foundPossibleResultPoint(new X(c,i))}var h=this.decodeDataCharacter(e,a,!0),d=this.decodeDataCharacter(e,a,!1);return new u4(1597*h.getValue()+d.getValue(),h.getChecksumPortion()+4*d.getChecksumPortion(),a)}catch{return null}},t.prototype.decodeDataCharacter=function(e,r,i){for(var o=this.getDataCharacterCounters(),s=0;s<o.length;s++)o[s]=0;if(i)zt.recordPatternInReverse(e,r.getStartEnd()[0],o);else{zt.recordPattern(e,r.getStartEnd()[1]+1,o);for(var a=0,u=o.length-1;a<u;a++,u--){var c=o[a];o[a]=o[u],o[u]=c}}var h=i?16:15,d=at.sum(new Int32Array(o))/h,f=this.getOddCounts(),g=this.getEvenCounts(),_=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors();for(a=0;a<o.length;a++){var I=o[a]/d,T=Math.floor(I+.5);T<1?T=1:T>8&&(T=8);var N=Math.floor(a/2);1&a?(g[N]=T,v[N]=I-T):(f[N]=T,_[N]=I-T)}this.adjustOddEvenCounts(i,h);var k=0,P=0;for(a=f.length-1;a>=0;a--)P*=9,P+=f[a],k+=f[a];var B=0,F=0;for(a=g.length-1;a>=0;a--)B*=9,B+=g[a],F+=g[a];var S=P+3*B;if(i){if(1&k||k>12||k<4)throw new V;var A=(12-k)/2,C=9-(Nt=t.OUTSIDE_ODD_WIDEST[A]),R=rr.getRSSvalue(f,Nt,!1),O=rr.getRSSvalue(g,C,!0),D=t.OUTSIDE_EVEN_TOTAL_SUBSET[A],b=t.OUTSIDE_GSUM[A];return new Go(R*D+O+b,S)}if(1&F||F>10||F<4)throw new V;A=(10-F)/2,C=9-(Nt=t.INSIDE_ODD_WIDEST[A]),R=rr.getRSSvalue(f,Nt,!0),O=rr.getRSSvalue(g,C,!1);var Nt,ue=t.INSIDE_ODD_TOTAL_SUBSET[A];return b=t.INSIDE_GSUM[A],new Go(O*ue+R+b,S)},t.prototype.findFinderPattern=function(e,r){var i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;for(var o=e.getSize(),s=!1,a=0;a<o&&r!==(s=!e.get(a));)a++;for(var u=0,c=a,h=a;h<o;h++)if(e.get(h)!==s)i[u]++;else{if(u===3){if(xn.isFinderPattern(i))return[c,h];c+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,u--}else u++;i[u]=1,s=!s}throw new V},t.prototype.parseFoundFinderPattern=function(e,r,i,o){for(var s=e.get(o[0]),a=o[0]-1;a>=0&&s!==e.get(a);)a--;a++;var u=o[0]-a,c=this.getDecodeFinderCounters(),h=new Int32Array(c.length);wt.arraycopy(c,0,h,1,c.length-1),h[0]=u;var d=this.parseFinderValue(h,t.FINDER_PATTERNS),f=a,g=o[1];return i&&(f=e.getSize()-1-f,g=e.getSize()-1-g),new I1(d,[a,o[1]],f,g,r)},t.prototype.adjustOddEvenCounts=function(e,r){var i=at.sum(new Int32Array(this.getOddCounts())),o=at.sum(new Int32Array(this.getEvenCounts())),s=!1,a=!1,u=!1,c=!1;e?(i>12?a=!0:i<4&&(s=!0),o>12?c=!0:o<4&&(u=!0)):(i>11?a=!0:i<5&&(s=!0),o>10?c=!0:o<4&&(u=!0));var h=i+o-r,d=(1&i)==(e?1:0),f=(1&o)==1;if(h===1)if(d){if(f)throw new V;a=!0}else{if(!f)throw new V;c=!0}else if(h===-1)if(d){if(f)throw new V;s=!0}else{if(!f)throw new V;u=!0}else{if(h!==0)throw new V;if(d){if(!f)throw new V;i<o?(s=!0,c=!0):(a=!0,u=!0)}else if(f)throw new V}if(s){if(a)throw new V;xn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(a&&xn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),u){if(c)throw new V;xn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&xn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},t.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],t.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],t.OUTSIDE_GSUM=[0,161,961,2015,2715],t.INSIDE_GSUM=[0,336,1036,1516],t.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],t.INSIDE_ODD_WIDEST=[2,4,6,8],t.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],t}(xn),l4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ir=function(n){function t(e){var r=n.call(this)||this;r.readers=[];var i=e?e.get(_t.POSSIBLE_FORMATS):null,o=e&&e.get(_t.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;return i&&((i.includes(Y.EAN_13)||i.includes(Y.UPC_A)||i.includes(Y.EAN_8)||i.includes(Y.UPC_E))&&r.readers.push(new oa(e)),i.includes(Y.CODE_39)&&r.readers.push(new hh(o)),i.includes(Y.CODE_128)&&r.readers.push(new lh),i.includes(Y.ITF)&&r.readers.push(new dh),i.includes(Y.RSS_14)&&r.readers.push(new wh),i.includes(Y.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),r.readers.push(new s4))),r.readers.length===0&&(r.readers.push(new oa(e)),r.readers.push(new hh),r.readers.push(new oa(e)),r.readers.push(new lh),r.readers.push(new dh),r.readers.push(new wh)),r}return l4(t,n),t.prototype.decodeRow=function(e,r,i){for(var o=0;o<this.readers.length;o++)try{return this.readers[o].decodeRow(e,r,i)}catch{}throw new V},t.prototype.reset=function(){this.readers.forEach(function(e){return e.reset()})},t}(zt),h4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){return e===void 0&&(e=500),n.call(this,new ir(r),e,r)||this}h4(t,n)})(Cr);var Ot,vh=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},lt=function(){function n(t,e,r){this.ecCodewords=t,this.ecBlocks=[e],r&&this.ecBlocks.push(r)}return n.prototype.getECCodewords=function(){return this.ecCodewords},n.prototype.getECBlocks=function(){return this.ecBlocks},n}(),ct=function(){function n(t,e){this.count=t,this.dataCodewords=e}return n.prototype.getCount=function(){return this.count},n.prototype.getDataCodewords=function(){return this.dataCodewords},n}(),d4=function(){function n(t,e,r,i,o,s){var a,u;this.versionNumber=t,this.symbolSizeRows=e,this.symbolSizeColumns=r,this.dataRegionSizeRows=i,this.dataRegionSizeColumns=o,this.ecBlocks=s;var c=0,h=s.getECCodewords(),d=s.getECBlocks();try{for(var f=vh(d),g=f.next();!g.done;g=f.next()){var _=g.value;c+=_.getCount()*(_.getDataCodewords()+h)}}catch(v){a={error:v}}finally{try{g&&!g.done&&(u=f.return)&&u.call(f)}finally{if(a)throw a.error}}this.totalCodewords=c}return n.prototype.getVersionNumber=function(){return this.versionNumber},n.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},n.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},n.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},n.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},n.prototype.getTotalCodewords=function(){return this.totalCodewords},n.prototype.getECBlocks=function(){return this.ecBlocks},n.getVersionForDimensions=function(t,e){var r,i;if(1&t||1&e)throw new W;try{for(var o=vh(n.VERSIONS),s=o.next();!s.done;s=o.next()){var a=s.value;if(a.symbolSizeRows===t&&a.symbolSizeColumns===e)return a}}catch(u){r={error:u}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}throw new W},n.prototype.toString=function(){return""+this.versionNumber},n.buildVersions=function(){return[new n(1,10,10,8,8,new lt(5,new ct(1,3))),new n(2,12,12,10,10,new lt(7,new ct(1,5))),new n(3,14,14,12,12,new lt(10,new ct(1,8))),new n(4,16,16,14,14,new lt(12,new ct(1,12))),new n(5,18,18,16,16,new lt(14,new ct(1,18))),new n(6,20,20,18,18,new lt(18,new ct(1,22))),new n(7,22,22,20,20,new lt(20,new ct(1,30))),new n(8,24,24,22,22,new lt(24,new ct(1,36))),new n(9,26,26,24,24,new lt(28,new ct(1,44))),new n(10,32,32,14,14,new lt(36,new ct(1,62))),new n(11,36,36,16,16,new lt(42,new ct(1,86))),new n(12,40,40,18,18,new lt(48,new ct(1,114))),new n(13,44,44,20,20,new lt(56,new ct(1,144))),new n(14,48,48,22,22,new lt(68,new ct(1,174))),new n(15,52,52,24,24,new lt(42,new ct(2,102))),new n(16,64,64,14,14,new lt(56,new ct(2,140))),new n(17,72,72,16,16,new lt(36,new ct(4,92))),new n(18,80,80,18,18,new lt(48,new ct(4,114))),new n(19,88,88,20,20,new lt(56,new ct(4,144))),new n(20,96,96,22,22,new lt(68,new ct(4,174))),new n(21,104,104,24,24,new lt(56,new ct(6,136))),new n(22,120,120,18,18,new lt(68,new ct(6,175))),new n(23,132,132,20,20,new lt(62,new ct(8,163))),new n(24,144,144,22,22,new lt(62,new ct(8,156),new ct(2,155))),new n(25,8,18,6,16,new lt(7,new ct(1,5))),new n(26,8,32,6,14,new lt(11,new ct(1,10))),new n(27,12,26,10,24,new lt(14,new ct(1,16))),new n(28,12,36,10,16,new lt(18,new ct(1,22))),new n(29,16,36,14,16,new lt(24,new ct(1,32))),new n(30,16,48,14,22,new lt(28,new ct(1,49)))]},n.VERSIONS=n.buildVersions(),n}(),f4=function(){function n(t){var e=t.getHeight();if(e<8||e>144||1&e)throw new W;this.version=n.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new Qe(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return n.prototype.getVersion=function(){return this.version},n.readVersion=function(t){var e=t.getHeight(),r=t.getWidth();return d4.getVersionForDimensions(e,r)},n.prototype.readCodewords=function(){var t=new Int8Array(this.version.getTotalCodewords()),e=0,r=4,i=0,o=this.mappingBitMatrix.getHeight(),s=this.mappingBitMatrix.getWidth(),a=!1,u=!1,c=!1,h=!1;do if(r!==o||i!==0||a)if(r!==o-2||i!==0||!(3&s)||u)if(r!==o+4||i!==2||7&s||c)if(r!==o-2||i!==0||(7&s)!=4||h){do r<o&&i>=0&&!this.readMappingMatrix.get(i,r)&&(t[e++]=255&this.readUtah(r,i,o,s)),r-=2,i+=2;while(r>=0&&i<s);r+=1,i+=3;do r>=0&&i<s&&!this.readMappingMatrix.get(i,r)&&(t[e++]=255&this.readUtah(r,i,o,s)),r+=2,i-=2;while(r<o&&i>=0);r+=3,i+=1}else t[e++]=255&this.readCorner4(o,s),r-=2,i+=2,h=!0;else t[e++]=255&this.readCorner3(o,s),r-=2,i+=2,c=!0;else t[e++]=255&this.readCorner2(o,s),r-=2,i+=2,u=!0;else t[e++]=255&this.readCorner1(o,s),r-=2,i+=2,a=!0;while(r<o||i<s);if(e!==this.version.getTotalCodewords())throw new W;return t},n.prototype.readModule=function(t,e,r,i){return t<0&&(t+=r,e+=4-(r+4&7)),e<0&&(e+=i,t+=4-(i+4&7)),this.readMappingMatrix.set(e,t),this.mappingBitMatrix.get(e,t)},n.prototype.readUtah=function(t,e,r,i){var o=0;return this.readModule(t-2,e-2,r,i)&&(o|=1),o<<=1,this.readModule(t-2,e-1,r,i)&&(o|=1),o<<=1,this.readModule(t-1,e-2,r,i)&&(o|=1),o<<=1,this.readModule(t-1,e-1,r,i)&&(o|=1),o<<=1,this.readModule(t-1,e,r,i)&&(o|=1),o<<=1,this.readModule(t,e-2,r,i)&&(o|=1),o<<=1,this.readModule(t,e-1,r,i)&&(o|=1),o<<=1,this.readModule(t,e,r,i)&&(o|=1),o},n.prototype.readCorner1=function(t,e){var r=0;return this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,1,t,e)&&(r|=1),r<<=1,this.readModule(t-1,2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(2,e-1,t,e)&&(r|=1),r<<=1,this.readModule(3,e-1,t,e)&&(r|=1),r},n.prototype.readCorner2=function(t,e){var r=0;return this.readModule(t-3,0,t,e)&&(r|=1),r<<=1,this.readModule(t-2,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(0,e-4,t,e)&&(r|=1),r<<=1,this.readModule(0,e-3,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r},n.prototype.readCorner3=function(t,e){var r=0;return this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(0,e-3,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-3,t,e)&&(r|=1),r<<=1,this.readModule(1,e-2,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r},n.prototype.readCorner4=function(t,e){var r=0;return this.readModule(t-3,0,t,e)&&(r|=1),r<<=1,this.readModule(t-2,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(2,e-1,t,e)&&(r|=1),r<<=1,this.readModule(3,e-1,t,e)&&(r|=1),r},n.prototype.extractDataRegion=function(t){var e=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(t.getHeight()!==e)throw new Z("Dimension of bitMatrix must match the version size");for(var i=this.version.getDataRegionSizeRows(),o=this.version.getDataRegionSizeColumns(),s=e/i|0,a=r/o|0,u=new Qe(a*o,s*i),c=0;c<s;++c)for(var h=c*i,d=0;d<a;++d)for(var f=d*o,g=0;g<i;++g)for(var _=c*(i+2)+1+g,v=h+g,I=0;I<o;++I){var T=d*(o+2)+1+I;if(t.get(T,_)){var N=f+I;u.set(N,v)}}return u},n}(),Eh=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},p4=function(){function n(t,e){this.numDataCodewords=t,this.codewords=e}return n.getDataBlocks=function(t,e){var r,i,o,s,a=e.getECBlocks(),u=0,c=a.getECBlocks();try{for(var h=Eh(c),d=h.next();!d.done;d=h.next())u+=(I=d.value).getCount()}catch(b){r={error:b}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}var f=new Array(u),g=0;try{for(var _=Eh(c),v=_.next();!v.done;v=_.next())for(var I=v.value,T=0;T<I.getCount();T++){var N=I.getDataCodewords(),k=a.getECCodewords()+N;f[g++]=new n(N,new Uint8Array(k))}}catch(b){o={error:b}}finally{try{v&&!v.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}var P=f[0].codewords.length-a.getECCodewords(),B=P-1,F=0;for(T=0;T<B;T++)for(var S=0;S<g;S++)f[S].codewords[T]=t[F++];var A=e.getVersionNumber()===24,C=A?8:g;for(S=0;S<C;S++)f[S].codewords[P-1]=t[F++];var R=f[0].codewords.length;for(T=P;T<R;T++)for(S=0;S<g;S++){var O=A?(S+8)%g:S,D=A&&O>7?T-1:T;f[O].codewords[D]=t[F++]}if(F!==t.length)throw new Z;return f},n.prototype.getNumDataCodewords=function(){return this.numDataCodewords},n.prototype.getCodewords=function(){return this.codewords},n}(),C1=function(){function n(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}return n.prototype.getBitOffset=function(){return this.bitOffset},n.prototype.getByteOffset=function(){return this.byteOffset},n.prototype.readBits=function(t){if(t<1||t>32||t>this.available())throw new Z(""+t);var e=0,r=this.bitOffset,i=this.byteOffset,o=this.bytes;if(r>0){var s=8-r,a=t<s?t:s,u=255>>8-a<<(c=s-a);e=(o[i]&u)>>c,t-=a,(r+=a)===8&&(r=0,i++)}if(t>0){for(;t>=8;)e=e<<8|255&o[i],i++,t-=8;if(t>0){var c;u=255>>(c=8-t)<<c,e=e<<t|(o[i]&u)>>c,r+=t}}return this.bitOffset=r,this.byteOffset=i,e},n.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},n}();(function(n){n[n.PAD_ENCODE=0]="PAD_ENCODE",n[n.ASCII_ENCODE=1]="ASCII_ENCODE",n[n.C40_ENCODE=2]="C40_ENCODE",n[n.TEXT_ENCODE=3]="TEXT_ENCODE",n[n.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",n[n.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",n[n.BASE256_ENCODE=6]="BASE256_ENCODE"})(Ot||(Ot={}));var or,g4=function(){function n(){}return n.decode=function(t){var e=new C1(t),r=new pt,i=new pt,o=new Array,s=Ot.ASCII_ENCODE;do if(s===Ot.ASCII_ENCODE)s=this.decodeAsciiSegment(e,r,i);else{switch(s){case Ot.C40_ENCODE:this.decodeC40Segment(e,r);break;case Ot.TEXT_ENCODE:this.decodeTextSegment(e,r);break;case Ot.ANSIX12_ENCODE:this.decodeAnsiX12Segment(e,r);break;case Ot.EDIFACT_ENCODE:this.decodeEdifactSegment(e,r);break;case Ot.BASE256_ENCODE:this.decodeBase256Segment(e,r,o);break;default:throw new W}s=Ot.ASCII_ENCODE}while(s!==Ot.PAD_ENCODE&&e.available()>0);return i.length()>0&&r.append(i.toString()),new gs(t,r.toString(),o.length===0?null:o,null)},n.decodeAsciiSegment=function(t,e,r){var i=!1;do{var o=t.readBits(8);if(o===0)throw new W;if(o<=128)return i&&(o+=128),e.append(String.fromCharCode(o-1)),Ot.ASCII_ENCODE;if(o===129)return Ot.PAD_ENCODE;if(o<=229){var s=o-130;s<10&&e.append("0"),e.append(""+s)}else switch(o){case 230:return Ot.C40_ENCODE;case 231:return Ot.BASE256_ENCODE;case 232:e.append("");break;case 233:case 234:case 241:break;case 235:i=!0;break;case 236:e.append("[)>05"),r.insert(0,"");break;case 237:e.append("[)>06"),r.insert(0,"");break;case 238:return Ot.ANSIX12_ENCODE;case 239:return Ot.TEXT_ENCODE;case 240:return Ot.EDIFACT_ENCODE;default:if(o!==254||t.available()!==0)throw new W}}while(t.available()>0);return Ot.ASCII_ENCODE},n.decodeC40Segment=function(t,e){var r=!1,i=[],o=0;do{if(t.available()===8)return;var s=t.readBits(8);if(s===254)return;this.parseTwoBytes(s,t.readBits(8),i);for(var a=0;a<3;a++){var u=i[a];switch(o){case 0:if(u<3)o=u+1;else{if(!(u<this.C40_BASIC_SET_CHARS.length))throw new W;var c=this.C40_BASIC_SET_CHARS[u];r?(e.append(String.fromCharCode(c.charCodeAt(0)+128)),r=!1):e.append(c)}break;case 1:r?(e.append(String.fromCharCode(u+128)),r=!1):e.append(String.fromCharCode(u)),o=0;break;case 2:if(u<this.C40_SHIFT2_SET_CHARS.length)c=this.C40_SHIFT2_SET_CHARS[u],r?(e.append(String.fromCharCode(c.charCodeAt(0)+128)),r=!1):e.append(c);else switch(u){case 27:e.append("");break;case 30:r=!0;break;default:throw new W}o=0;break;case 3:r?(e.append(String.fromCharCode(u+224)),r=!1):e.append(String.fromCharCode(u+96)),o=0;break;default:throw new W}}}while(t.available()>0)},n.decodeTextSegment=function(t,e){var r=!1,i=[],o=0;do{if(t.available()===8)return;var s=t.readBits(8);if(s===254)return;this.parseTwoBytes(s,t.readBits(8),i);for(var a=0;a<3;a++){var u=i[a];switch(o){case 0:if(u<3)o=u+1;else{if(!(u<this.TEXT_BASIC_SET_CHARS.length))throw new W;var c=this.TEXT_BASIC_SET_CHARS[u];r?(e.append(String.fromCharCode(c.charCodeAt(0)+128)),r=!1):e.append(c)}break;case 1:r?(e.append(String.fromCharCode(u+128)),r=!1):e.append(String.fromCharCode(u)),o=0;break;case 2:if(u<this.TEXT_SHIFT2_SET_CHARS.length)c=this.TEXT_SHIFT2_SET_CHARS[u],r?(e.append(String.fromCharCode(c.charCodeAt(0)+128)),r=!1):e.append(c);else switch(u){case 27:e.append("");break;case 30:r=!0;break;default:throw new W}o=0;break;case 3:if(!(u<this.TEXT_SHIFT3_SET_CHARS.length))throw new W;c=this.TEXT_SHIFT3_SET_CHARS[u],r?(e.append(String.fromCharCode(c.charCodeAt(0)+128)),r=!1):e.append(c),o=0;break;default:throw new W}}}while(t.available()>0)},n.decodeAnsiX12Segment=function(t,e){var r=[];do{if(t.available()===8)return;var i=t.readBits(8);if(i===254)return;this.parseTwoBytes(i,t.readBits(8),r);for(var o=0;o<3;o++){var s=r[o];switch(s){case 0:e.append("\r");break;case 1:e.append("*");break;case 2:e.append(">");break;case 3:e.append(" ");break;default:if(s<14)e.append(String.fromCharCode(s+44));else{if(!(s<40))throw new W;e.append(String.fromCharCode(s+51))}}}}while(t.available()>0)},n.parseTwoBytes=function(t,e,r){var i=(t<<8)+e-1,o=Math.floor(i/1600);r[0]=o,i-=1600*o,o=Math.floor(i/40),r[1]=o,r[2]=i-40*o},n.decodeEdifactSegment=function(t,e){do{if(t.available()<=16)return;for(var r=0;r<4;r++){var i=t.readBits(6);if(i===31){var o=8-t.getBitOffset();return void(o!==8&&t.readBits(o))}!(32&i)&&(i|=64),e.append(String.fromCharCode(i))}}while(t.available()>0)},n.decodeBase256Segment=function(t,e,r){var i,o=1+t.getByteOffset(),s=this.unrandomize255State(t.readBits(8),o++);if((i=s===0?t.available()/8|0:s<250?s:250*(s-249)+this.unrandomize255State(t.readBits(8),o++))<0)throw new W;for(var a=new Uint8Array(i),u=0;u<i;u++){if(t.available()<8)throw new W;a[u]=this.unrandomize255State(t.readBits(8),o++)}r.push(a);try{e.append(jn.decode(a,Vt.ISO88591))}catch(c){throw new Oi("Platform does not support required encoding: "+c.message)}},n.unrandomize255State=function(t,e){var r=t-(149*e%255+1);return r>=0?r:r+256},n.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],n.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n.TEXT_SHIFT2_SET_CHARS=n.C40_SHIFT2_SET_CHARS,n.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],n}(),m4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_4=function(){function n(){this.rsDecoder=new ms(hn.DATA_MATRIX_FIELD_256)}return n.prototype.decode=function(t){var e,r,i=new f4(t),o=i.getVersion(),s=i.readCodewords(),a=p4.getDataBlocks(s,o),u=0;try{for(var c=m4(a),h=c.next();!h.done;h=c.next())u+=h.value.getNumDataCodewords()}catch(N){e={error:N}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}for(var d=new Uint8Array(u),f=a.length,g=0;g<f;g++){var _=a[g],v=_.getCodewords(),I=_.getNumDataCodewords();this.correctErrors(v,I);for(var T=0;T<I;T++)d[T*f+g]=v[T]}return g4.decode(d)},n.prototype.correctErrors=function(t,e){var r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch{throw new xt}for(var i=0;i<e;i++)t[i]=r[i]},n}(),y4=function(){function n(t){this.image=t,this.rectangleDetector=new La(this.image)}return n.prototype.detect=function(){var t=this.rectangleDetector.detect(),e=this.detectSolid1(t);if((e=this.detectSolid2(e))[3]=this.correctTopRight(e),!e[3])throw new V;var r=(e=this.shiftToModuleCenter(e))[0],i=e[1],o=e[2],s=e[3],a=this.transitionsBetween(r,s)+1,u=this.transitionsBetween(o,s)+1;(1&a)==1&&(a+=1),(1&u)==1&&(u+=1),4*a<7*u&&4*u<7*a&&(a=u=Math.max(a,u));var c=n.sampleGrid(this.image,r,i,o,s,a,u);return new Fu(c,[r,i,o,s])},n.shiftPoint=function(t,e,r){var i=(e.getX()-t.getX())/(r+1),o=(e.getY()-t.getY())/(r+1);return new X(t.getX()+i,t.getY()+o)},n.moveAway=function(t,e,r){var i=t.getX(),o=t.getY();return i<e?i-=1:i+=1,o<r?o-=1:o+=1,new X(i,o)},n.prototype.detectSolid1=function(t){var e=t[0],r=t[1],i=t[3],o=t[2],s=this.transitionsBetween(e,r),a=this.transitionsBetween(r,i),u=this.transitionsBetween(i,o),c=this.transitionsBetween(o,e),h=s,d=[o,e,r,i];return h>a&&(h=a,d[0]=e,d[1]=r,d[2]=i,d[3]=o),h>u&&(h=u,d[0]=r,d[1]=i,d[2]=o,d[3]=e),h>c&&(d[0]=i,d[1]=o,d[2]=e,d[3]=r),d},n.prototype.detectSolid2=function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=this.transitionsBetween(e,o),a=n.shiftPoint(r,i,4*(s+1)),u=n.shiftPoint(i,r,4*(s+1));return this.transitionsBetween(a,e)<this.transitionsBetween(u,o)?(t[0]=e,t[1]=r,t[2]=i,t[3]=o):(t[0]=r,t[1]=i,t[2]=o,t[3]=e),t},n.prototype.correctTopRight=function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=this.transitionsBetween(e,o),a=this.transitionsBetween(r,o),u=n.shiftPoint(e,r,4*(a+1)),c=n.shiftPoint(i,r,4*(s+1));s=this.transitionsBetween(u,o),a=this.transitionsBetween(c,o);var h=new X(o.getX()+(i.getX()-r.getX())/(s+1),o.getY()+(i.getY()-r.getY())/(s+1)),d=new X(o.getX()+(e.getX()-r.getX())/(a+1),o.getY()+(e.getY()-r.getY())/(a+1));return this.isValid(h)?this.isValid(d)?this.transitionsBetween(u,h)+this.transitionsBetween(c,h)>this.transitionsBetween(u,d)+this.transitionsBetween(c,d)?h:d:h:this.isValid(d)?d:null},n.prototype.shiftToModuleCenter=function(t){var e=t[0],r=t[1],i=t[2],o=t[3],s=this.transitionsBetween(e,o)+1,a=this.transitionsBetween(i,o)+1,u=n.shiftPoint(e,r,4*a),c=n.shiftPoint(i,r,4*s);(1&(s=this.transitionsBetween(u,o)+1))==1&&(s+=1),(1&(a=this.transitionsBetween(c,o)+1))==1&&(a+=1);var h,d,f=(e.getX()+r.getX()+i.getX()+o.getX())/4,g=(e.getY()+r.getY()+i.getY()+o.getY())/4;return e=n.moveAway(e,f,g),r=n.moveAway(r,f,g),i=n.moveAway(i,f,g),o=n.moveAway(o,f,g),u=n.shiftPoint(e,r,4*a),u=n.shiftPoint(u,o,4*s),h=n.shiftPoint(r,e,4*a),h=n.shiftPoint(h,i,4*s),c=n.shiftPoint(i,o,4*a),c=n.shiftPoint(c,r,4*s),d=n.shiftPoint(o,i,4*a),[u,h,c,d=n.shiftPoint(d,e,4*s)]},n.prototype.isValid=function(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()},n.sampleGrid=function(t,e,r,i,o,s,a){return Uu.getInstance().sampleGrid(t,s,a,.5,.5,s-.5,.5,s-.5,a-.5,.5,a-.5,e.getX(),e.getY(),o.getX(),o.getY(),i.getX(),i.getY(),r.getX(),r.getY())},n.prototype.transitionsBetween=function(t,e){var r=Math.trunc(t.getX()),i=Math.trunc(t.getY()),o=Math.trunc(e.getX()),s=Math.trunc(e.getY()),a=Math.abs(s-i)>Math.abs(o-r);if(a){var u=r;r=i,i=u,u=o,o=s,s=u}for(var c=Math.abs(o-r),h=Math.abs(s-i),d=-c/2,f=i<s?1:-1,g=r<o?1:-1,_=0,v=this.image.get(a?i:r,a?r:i),I=r,T=i;I!==o;I+=g){var N=this.image.get(a?T:I,a?I:T);if(N!==v&&(_++,v=N),(d+=h)>0){if(T===s)break;T+=f,d-=c}}return _},n}(),Wo=function(){function n(){this.decoder=new _4}return n.prototype.decode=function(t,e){var r,i;if(e===void 0&&(e=null),e!=null&&e.has(_t.PURE_BARCODE)){var o=n.extractPureBits(t.getBlackMatrix());r=this.decoder.decode(o),i=n.NO_POINTS}else{var s=new y4(t.getBlackMatrix()).detect();r=this.decoder.decode(s.getBits()),i=s.getPoints()}var a=r.getRawBytes(),u=new pe(r.getText(),a,8*a.length,i,Y.DATA_MATRIX,wt.currentTimeMillis()),c=r.getByteSegments();c!=null&&u.putMetadata(Wt.BYTE_SEGMENTS,c);var h=r.getECLevel();return h!=null&&u.putMetadata(Wt.ERROR_CORRECTION_LEVEL,h),u},n.prototype.reset=function(){},n.extractPureBits=function(t){var e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(e==null||r==null)throw new V;var i=this.moduleSize(e,t),o=e[1],s=r[1],a=e[0],u=(r[0]-a+1)/i,c=(s-o+1)/i;if(u<=0||c<=0)throw new V;var h=i/2;o+=h,a+=h;for(var d=new Qe(u,c),f=0;f<c;f++)for(var g=o+f*i,_=0;_<u;_++)t.get(a+_*i,g)&&d.set(_,f);return d},n.moduleSize=function(t,e){for(var r=e.getWidth(),i=t[0],o=t[1];i<r&&e.get(i,o);)i++;if(i===r)throw new V;var s=i-t[0];if(s===0)throw new V;return s},n.NO_POINTS=[],n}(),w4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e){return e===void 0&&(e=500),n.call(this,new Wo,e)||this}w4(t,n)})(Cr),function(n){n[n.L=0]="L",n[n.M=1]="M",n[n.Q=2]="Q",n[n.H=3]="H"}(or||(or={}));var Lt,v4=function(){function n(t,e,r){this.value=t,this.stringValue=e,this.bits=r,n.FOR_BITS.set(r,this),n.FOR_VALUE.set(t,this)}return n.prototype.getValue=function(){return this.value},n.prototype.getBits=function(){return this.bits},n.fromString=function(t){switch(t){case"L":return n.L;case"M":return n.M;case"Q":return n.Q;case"H":return n.H;default:throw new St(t+"not available")}},n.prototype.toString=function(){return this.stringValue},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.value===e.value},n.forBits=function(t){if(t<0||t>=n.FOR_BITS.size)throw new Z;return n.FOR_BITS.get(t)},n.FOR_BITS=new Map,n.FOR_VALUE=new Map,n.L=new n(or.L,"L",1),n.M=new n(or.M,"M",0),n.Q=new n(or.Q,"Q",3),n.H=new n(or.H,"H",2),n}(),E4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},S1=function(){function n(t){this.errorCorrectionLevel=v4.forBits(t>>3&3),this.dataMask=7&t}return n.numBitsDiffering=function(t,e){return Gt.bitCount(t^e)},n.decodeFormatInformation=function(t,e){var r=n.doDecodeFormatInformation(t,e);return r!==null?r:n.doDecodeFormatInformation(t^n.FORMAT_INFO_MASK_QR,e^n.FORMAT_INFO_MASK_QR)},n.doDecodeFormatInformation=function(t,e){var r,i,o=Number.MAX_SAFE_INTEGER,s=0;try{for(var a=E4(n.FORMAT_INFO_DECODE_LOOKUP),u=a.next();!u.done;u=a.next()){var c=u.value,h=c[0];if(h===t||h===e)return new n(c[1]);var d=n.numBitsDiffering(t,h);d<o&&(s=c[1],o=d),t!==e&&(d=n.numBitsDiffering(e,h))<o&&(s=c[1],o=d)}}catch(f){r={error:f}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o<=3?new n(s):null},n.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},n.prototype.getDataMask=function(){return this.dataMask},n.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.errorCorrectionLevel===e.errorCorrectionLevel&&this.dataMask===e.dataMask},n.FORMAT_INFO_MASK_QR=21522,n.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],n}(),I4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},M=function(){function n(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.ecCodewordsPerBlock=t,this.ecBlocks=e}return n.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},n.prototype.getNumBlocks=function(){var t,e,r=0,i=this.ecBlocks;try{for(var o=I4(i),s=o.next();!s.done;s=o.next())r+=s.value.getCount()}catch(a){t={error:a}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},n.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},n.prototype.getECBlocks=function(){return this.ecBlocks},n}(),E=function(){function n(t,e){this.count=t,this.dataCodewords=e}return n.prototype.getCount=function(){return this.count},n.prototype.getDataCodewords=function(){return this.dataCodewords},n}(),A4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},To=function(){function n(t,e){for(var r,i,o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=o;var a=0,u=o[0].getECCodewordsPerBlock(),c=o[0].getECBlocks();try{for(var h=A4(c),d=h.next();!d.done;d=h.next()){var f=d.value;a+=f.getCount()*(f.getDataCodewords()+u)}}catch(g){r={error:g}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}this.totalCodewords=a}return n.prototype.getVersionNumber=function(){return this.versionNumber},n.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},n.prototype.getTotalCodewords=function(){return this.totalCodewords},n.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},n.prototype.getECBlocksForLevel=function(t){return this.ecBlocks[t.getValue()]},n.getProvisionalVersionForDimension=function(t){if(t%4!=1)throw new W;try{return this.getVersionForNumber((t-17)/4)}catch{throw new W}},n.getVersionForNumber=function(t){if(t<1||t>40)throw new Z;return n.VERSIONS[t-1]},n.decodeVersionInformation=function(t){for(var e=Number.MAX_SAFE_INTEGER,r=0,i=0;i<n.VERSION_DECODE_INFO.length;i++){var o=n.VERSION_DECODE_INFO[i];if(o===t)return n.getVersionForNumber(i+7);var s=S1.numBitsDiffering(t,o);s<e&&(r=i+7,e=s)}return e<=3?n.getVersionForNumber(r):null},n.prototype.buildFunctionPattern=function(){var t=this.getDimensionForVersion(),e=new Qe(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);for(var r=this.alignmentPatternCenters.length,i=0;i<r;i++)for(var o=this.alignmentPatternCenters[i]-2,s=0;s<r;s++)i===0&&(s===0||s===r-1)||i===r-1&&s===0||e.setRegion(this.alignmentPatternCenters[s]-2,o,5,5);return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e},n.prototype.toString=function(){return""+this.versionNumber},n.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),n.VERSIONS=[new n(1,new Int32Array(0),new M(7,new E(1,19)),new M(10,new E(1,16)),new M(13,new E(1,13)),new M(17,new E(1,9))),new n(2,Int32Array.from([6,18]),new M(10,new E(1,34)),new M(16,new E(1,28)),new M(22,new E(1,22)),new M(28,new E(1,16))),new n(3,Int32Array.from([6,22]),new M(15,new E(1,55)),new M(26,new E(1,44)),new M(18,new E(2,17)),new M(22,new E(2,13))),new n(4,Int32Array.from([6,26]),new M(20,new E(1,80)),new M(18,new E(2,32)),new M(26,new E(2,24)),new M(16,new E(4,9))),new n(5,Int32Array.from([6,30]),new M(26,new E(1,108)),new M(24,new E(2,43)),new M(18,new E(2,15),new E(2,16)),new M(22,new E(2,11),new E(2,12))),new n(6,Int32Array.from([6,34]),new M(18,new E(2,68)),new M(16,new E(4,27)),new M(24,new E(4,19)),new M(28,new E(4,15))),new n(7,Int32Array.from([6,22,38]),new M(20,new E(2,78)),new M(18,new E(4,31)),new M(18,new E(2,14),new E(4,15)),new M(26,new E(4,13),new E(1,14))),new n(8,Int32Array.from([6,24,42]),new M(24,new E(2,97)),new M(22,new E(2,38),new E(2,39)),new M(22,new E(4,18),new E(2,19)),new M(26,new E(4,14),new E(2,15))),new n(9,Int32Array.from([6,26,46]),new M(30,new E(2,116)),new M(22,new E(3,36),new E(2,37)),new M(20,new E(4,16),new E(4,17)),new M(24,new E(4,12),new E(4,13))),new n(10,Int32Array.from([6,28,50]),new M(18,new E(2,68),new E(2,69)),new M(26,new E(4,43),new E(1,44)),new M(24,new E(6,19),new E(2,20)),new M(28,new E(6,15),new E(2,16))),new n(11,Int32Array.from([6,30,54]),new M(20,new E(4,81)),new M(30,new E(1,50),new E(4,51)),new M(28,new E(4,22),new E(4,23)),new M(24,new E(3,12),new E(8,13))),new n(12,Int32Array.from([6,32,58]),new M(24,new E(2,92),new E(2,93)),new M(22,new E(6,36),new E(2,37)),new M(26,new E(4,20),new E(6,21)),new M(28,new E(7,14),new E(4,15))),new n(13,Int32Array.from([6,34,62]),new M(26,new E(4,107)),new M(22,new E(8,37),new E(1,38)),new M(24,new E(8,20),new E(4,21)),new M(22,new E(12,11),new E(4,12))),new n(14,Int32Array.from([6,26,46,66]),new M(30,new E(3,115),new E(1,116)),new M(24,new E(4,40),new E(5,41)),new M(20,new E(11,16),new E(5,17)),new M(24,new E(11,12),new E(5,13))),new n(15,Int32Array.from([6,26,48,70]),new M(22,new E(5,87),new E(1,88)),new M(24,new E(5,41),new E(5,42)),new M(30,new E(5,24),new E(7,25)),new M(24,new E(11,12),new E(7,13))),new n(16,Int32Array.from([6,26,50,74]),new M(24,new E(5,98),new E(1,99)),new M(28,new E(7,45),new E(3,46)),new M(24,new E(15,19),new E(2,20)),new M(30,new E(3,15),new E(13,16))),new n(17,Int32Array.from([6,30,54,78]),new M(28,new E(1,107),new E(5,108)),new M(28,new E(10,46),new E(1,47)),new M(28,new E(1,22),new E(15,23)),new M(28,new E(2,14),new E(17,15))),new n(18,Int32Array.from([6,30,56,82]),new M(30,new E(5,120),new E(1,121)),new M(26,new E(9,43),new E(4,44)),new M(28,new E(17,22),new E(1,23)),new M(28,new E(2,14),new E(19,15))),new n(19,Int32Array.from([6,30,58,86]),new M(28,new E(3,113),new E(4,114)),new M(26,new E(3,44),new E(11,45)),new M(26,new E(17,21),new E(4,22)),new M(26,new E(9,13),new E(16,14))),new n(20,Int32Array.from([6,34,62,90]),new M(28,new E(3,107),new E(5,108)),new M(26,new E(3,41),new E(13,42)),new M(30,new E(15,24),new E(5,25)),new M(28,new E(15,15),new E(10,16))),new n(21,Int32Array.from([6,28,50,72,94]),new M(28,new E(4,116),new E(4,117)),new M(26,new E(17,42)),new M(28,new E(17,22),new E(6,23)),new M(30,new E(19,16),new E(6,17))),new n(22,Int32Array.from([6,26,50,74,98]),new M(28,new E(2,111),new E(7,112)),new M(28,new E(17,46)),new M(30,new E(7,24),new E(16,25)),new M(24,new E(34,13))),new n(23,Int32Array.from([6,30,54,78,102]),new M(30,new E(4,121),new E(5,122)),new M(28,new E(4,47),new E(14,48)),new M(30,new E(11,24),new E(14,25)),new M(30,new E(16,15),new E(14,16))),new n(24,Int32Array.from([6,28,54,80,106]),new M(30,new E(6,117),new E(4,118)),new M(28,new E(6,45),new E(14,46)),new M(30,new E(11,24),new E(16,25)),new M(30,new E(30,16),new E(2,17))),new n(25,Int32Array.from([6,32,58,84,110]),new M(26,new E(8,106),new E(4,107)),new M(28,new E(8,47),new E(13,48)),new M(30,new E(7,24),new E(22,25)),new M(30,new E(22,15),new E(13,16))),new n(26,Int32Array.from([6,30,58,86,114]),new M(28,new E(10,114),new E(2,115)),new M(28,new E(19,46),new E(4,47)),new M(28,new E(28,22),new E(6,23)),new M(30,new E(33,16),new E(4,17))),new n(27,Int32Array.from([6,34,62,90,118]),new M(30,new E(8,122),new E(4,123)),new M(28,new E(22,45),new E(3,46)),new M(30,new E(8,23),new E(26,24)),new M(30,new E(12,15),new E(28,16))),new n(28,Int32Array.from([6,26,50,74,98,122]),new M(30,new E(3,117),new E(10,118)),new M(28,new E(3,45),new E(23,46)),new M(30,new E(4,24),new E(31,25)),new M(30,new E(11,15),new E(31,16))),new n(29,Int32Array.from([6,30,54,78,102,126]),new M(30,new E(7,116),new E(7,117)),new M(28,new E(21,45),new E(7,46)),new M(30,new E(1,23),new E(37,24)),new M(30,new E(19,15),new E(26,16))),new n(30,Int32Array.from([6,26,52,78,104,130]),new M(30,new E(5,115),new E(10,116)),new M(28,new E(19,47),new E(10,48)),new M(30,new E(15,24),new E(25,25)),new M(30,new E(23,15),new E(25,16))),new n(31,Int32Array.from([6,30,56,82,108,134]),new M(30,new E(13,115),new E(3,116)),new M(28,new E(2,46),new E(29,47)),new M(30,new E(42,24),new E(1,25)),new M(30,new E(23,15),new E(28,16))),new n(32,Int32Array.from([6,34,60,86,112,138]),new M(30,new E(17,115)),new M(28,new E(10,46),new E(23,47)),new M(30,new E(10,24),new E(35,25)),new M(30,new E(19,15),new E(35,16))),new n(33,Int32Array.from([6,30,58,86,114,142]),new M(30,new E(17,115),new E(1,116)),new M(28,new E(14,46),new E(21,47)),new M(30,new E(29,24),new E(19,25)),new M(30,new E(11,15),new E(46,16))),new n(34,Int32Array.from([6,34,62,90,118,146]),new M(30,new E(13,115),new E(6,116)),new M(28,new E(14,46),new E(23,47)),new M(30,new E(44,24),new E(7,25)),new M(30,new E(59,16),new E(1,17))),new n(35,Int32Array.from([6,30,54,78,102,126,150]),new M(30,new E(12,121),new E(7,122)),new M(28,new E(12,47),new E(26,48)),new M(30,new E(39,24),new E(14,25)),new M(30,new E(22,15),new E(41,16))),new n(36,Int32Array.from([6,24,50,76,102,128,154]),new M(30,new E(6,121),new E(14,122)),new M(28,new E(6,47),new E(34,48)),new M(30,new E(46,24),new E(10,25)),new M(30,new E(2,15),new E(64,16))),new n(37,Int32Array.from([6,28,54,80,106,132,158]),new M(30,new E(17,122),new E(4,123)),new M(28,new E(29,46),new E(14,47)),new M(30,new E(49,24),new E(10,25)),new M(30,new E(24,15),new E(46,16))),new n(38,Int32Array.from([6,32,58,84,110,136,162]),new M(30,new E(4,122),new E(18,123)),new M(28,new E(13,46),new E(32,47)),new M(30,new E(48,24),new E(14,25)),new M(30,new E(42,15),new E(32,16))),new n(39,Int32Array.from([6,26,54,82,110,138,166]),new M(30,new E(20,117),new E(4,118)),new M(28,new E(40,47),new E(7,48)),new M(30,new E(43,24),new E(22,25)),new M(30,new E(10,15),new E(67,16))),new n(40,Int32Array.from([6,30,58,86,114,142,170]),new M(30,new E(19,118),new E(6,119)),new M(28,new E(18,47),new E(31,48)),new M(30,new E(34,24),new E(34,25)),new M(30,new E(20,15),new E(61,16)))],n}();(function(n){n[n.DATA_MASK_000=0]="DATA_MASK_000",n[n.DATA_MASK_001=1]="DATA_MASK_001",n[n.DATA_MASK_010=2]="DATA_MASK_010",n[n.DATA_MASK_011=3]="DATA_MASK_011",n[n.DATA_MASK_100=4]="DATA_MASK_100",n[n.DATA_MASK_101=5]="DATA_MASK_101",n[n.DATA_MASK_110=6]="DATA_MASK_110",n[n.DATA_MASK_111=7]="DATA_MASK_111"})(Lt||(Lt={}));var ve,Ih=function(){function n(t,e){this.value=t,this.isMasked=e}return n.prototype.unmaskBitMatrix=function(t,e){for(var r=0;r<e;r++)for(var i=0;i<e;i++)this.isMasked(r,i)&&t.flip(i,r)},n.values=new Map([[Lt.DATA_MASK_000,new n(Lt.DATA_MASK_000,function(t,e){return(t+e&1)==0})],[Lt.DATA_MASK_001,new n(Lt.DATA_MASK_001,function(t,e){return(1&t)==0})],[Lt.DATA_MASK_010,new n(Lt.DATA_MASK_010,function(t,e){return e%3==0})],[Lt.DATA_MASK_011,new n(Lt.DATA_MASK_011,function(t,e){return(t+e)%3==0})],[Lt.DATA_MASK_100,new n(Lt.DATA_MASK_100,function(t,e){return(Math.floor(t/2)+Math.floor(e/3)&1)==0})],[Lt.DATA_MASK_101,new n(Lt.DATA_MASK_101,function(t,e){return t*e%6==0})],[Lt.DATA_MASK_110,new n(Lt.DATA_MASK_110,function(t,e){return t*e%6<3})],[Lt.DATA_MASK_111,new n(Lt.DATA_MASK_111,function(t,e){return(t+e+t*e%3&1)==0})]]),n}(),T4=function(){function n(t){var e=t.getHeight();if(e<21||(3&e)!=1)throw new W;this.bitMatrix=t}return n.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var t=0,e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var r=5;r>=0;r--)t=this.copyBit(8,r,t);var i=this.bitMatrix.getHeight(),o=0,s=i-7;for(r=i-1;r>=s;r--)o=this.copyBit(8,r,o);for(e=i-8;e<i;e++)o=this.copyBit(e,8,o);if(this.parsedFormatInfo=S1.decodeFormatInformation(t,o),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new W},n.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var t=this.bitMatrix.getHeight(),e=Math.floor((t-17)/4);if(e<=6)return To.getVersionForNumber(e);for(var r=0,i=t-11,o=5;o>=0;o--)for(var s=t-9;s>=i;s--)r=this.copyBit(s,o,r);var a=To.decodeVersionInformation(r);if(a!==null&&a.getDimensionForVersion()===t)return this.parsedVersion=a,a;for(r=0,s=5;s>=0;s--)for(o=t-9;o>=i;o--)r=this.copyBit(s,o,r);if((a=To.decodeVersionInformation(r))!==null&&a.getDimensionForVersion()===t)return this.parsedVersion=a,a;throw new W},n.prototype.copyBit=function(t,e,r){return(this.isMirror?this.bitMatrix.get(e,t):this.bitMatrix.get(t,e))?r<<1|1:r<<1},n.prototype.readCodewords=function(){var t=this.readFormatInformation(),e=this.readVersion(),r=Ih.values.get(t.getDataMask()),i=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,i);for(var o=e.buildFunctionPattern(),s=!0,a=new Uint8Array(e.getTotalCodewords()),u=0,c=0,h=0,d=i-1;d>0;d-=2){d===6&&d--;for(var f=0;f<i;f++)for(var g=s?i-1-f:f,_=0;_<2;_++)o.get(d-_,g)||(h++,c<<=1,this.bitMatrix.get(d-_,g)&&(c|=1),h===8&&(a[u++]=c,h=0,c=0));s=!s}if(u!==e.getTotalCodewords())throw new W;return a},n.prototype.remask=function(){if(this.parsedFormatInfo!==null){var t=Ih.values[this.parsedFormatInfo.getDataMask()],e=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,e)}},n.prototype.setMirror=function(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t},n.prototype.mirror=function(){for(var t=this.bitMatrix,e=0,r=t.getWidth();e<r;e++)for(var i=e+1,o=t.getHeight();i<o;i++)t.get(e,i)!==t.get(i,e)&&(t.flip(i,e),t.flip(e,i))},n}(),Ah=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},C4=function(){function n(t,e){this.numDataCodewords=t,this.codewords=e}return n.getDataBlocks=function(t,e,r){var i,o,s,a;if(t.length!==e.getTotalCodewords())throw new Z;var u=e.getECBlocksForLevel(r),c=0,h=u.getECBlocks();try{for(var d=Ah(h),f=d.next();!f.done;f=d.next())c+=(T=f.value).getCount()}catch(D){i={error:D}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}var g=new Array(c),_=0;try{for(var v=Ah(h),I=v.next();!I.done;I=v.next())for(var T=I.value,N=0;N<T.getCount();N++){var k=T.getDataCodewords(),P=u.getECCodewordsPerBlock()+k;g[_++]=new n(k,new Uint8Array(P))}}catch(D){s={error:D}}finally{try{I&&!I.done&&(a=v.return)&&a.call(v)}finally{if(s)throw s.error}}for(var B=g[0].codewords.length,F=g.length-1;F>=0&&g[F].codewords.length!==B;)F--;F++;var S=B-u.getECCodewordsPerBlock(),A=0;for(N=0;N<S;N++)for(var C=0;C<_;C++)g[C].codewords[N]=t[A++];for(C=F;C<_;C++)g[C].codewords[S]=t[A++];var R=g[0].codewords.length;for(N=S;N<R;N++)for(C=0;C<_;C++){var O=C<F?N:N+1;g[C].codewords[O]=t[A++]}return g},n.prototype.getNumDataCodewords=function(){return this.numDataCodewords},n.prototype.getCodewords=function(){return this.codewords},n}();(function(n){n[n.TERMINATOR=0]="TERMINATOR",n[n.NUMERIC=1]="NUMERIC",n[n.ALPHANUMERIC=2]="ALPHANUMERIC",n[n.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",n[n.BYTE=4]="BYTE",n[n.ECI=5]="ECI",n[n.KANJI=6]="KANJI",n[n.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",n[n.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",n[n.HANZI=9]="HANZI"})(ve||(ve={}));var dt,ao,me=function(){function n(t,e,r,i){this.value=t,this.stringValue=e,this.characterCountBitsForVersions=r,this.bits=i,n.FOR_BITS.set(i,this),n.FOR_VALUE.set(t,this)}return n.forBits=function(t){var e=n.FOR_BITS.get(t);if(e===void 0)throw new Z;return e},n.prototype.getCharacterCountBits=function(t){var e,r=t.getVersionNumber();return e=r<=9?0:r<=26?1:2,this.characterCountBitsForVersions[e]},n.prototype.getValue=function(){return this.value},n.prototype.getBits=function(){return this.bits},n.prototype.equals=function(t){if(!(t instanceof n))return!1;var e=t;return this.value===e.value},n.prototype.toString=function(){return this.stringValue},n.FOR_BITS=new Map,n.FOR_VALUE=new Map,n.TERMINATOR=new n(ve.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),n.NUMERIC=new n(ve.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),n.ALPHANUMERIC=new n(ve.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),n.STRUCTURED_APPEND=new n(ve.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),n.BYTE=new n(ve.BYTE,"BYTE",Int32Array.from([8,16,16]),4),n.ECI=new n(ve.ECI,"ECI",Int32Array.from([0,0,0]),7),n.KANJI=new n(ve.KANJI,"KANJI",Int32Array.from([8,10,12]),8),n.FNC1_FIRST_POSITION=new n(ve.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),n.FNC1_SECOND_POSITION=new n(ve.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),n.HANZI=new n(ve.HANZI,"HANZI",Int32Array.from([8,10,12]),13),n}(),S4=function(){function n(){}return n.decode=function(t,e,r,i){var o=new C1(t),s=new pt,a=new Array,u=-1,c=-1;try{var h=null,d=!1,f=void 0;do{if(o.available()<4)f=me.TERMINATOR;else{var g=o.readBits(4);f=me.forBits(g)}switch(f){case me.TERMINATOR:break;case me.FNC1_FIRST_POSITION:case me.FNC1_SECOND_POSITION:d=!0;break;case me.STRUCTURED_APPEND:if(o.available()<16)throw new W;u=o.readBits(8),c=o.readBits(8);break;case me.ECI:var _=n.parseECIValue(o);if((h=le.getCharacterSetECIByValue(_))===null)throw new W;break;case me.HANZI:var v=o.readBits(4),I=o.readBits(f.getCharacterCountBits(e));v===n.GB2312_SUBSET&&n.decodeHanziSegment(o,s,I);break;default:var T=o.readBits(f.getCharacterCountBits(e));switch(f){case me.NUMERIC:n.decodeNumericSegment(o,s,T);break;case me.ALPHANUMERIC:n.decodeAlphanumericSegment(o,s,T,d);break;case me.BYTE:n.decodeByteSegment(o,s,T,h,a,i);break;case me.KANJI:n.decodeKanjiSegment(o,s,T);break;default:throw new W}}}while(f!==me.TERMINATOR)}catch{throw new W}return new gs(t,s.toString(),a.length===0?null:a,r===null?null:r.toString(),u,c)},n.decodeHanziSegment=function(t,e,r){if(13*r>t.available())throw new W;for(var i=new Uint8Array(2*r),o=0;r>0;){var s=t.readBits(13),a=s/96<<8&4294967295|s%96;a+=a<959?41377:42657,i[o]=a>>8&255,i[o+1]=255&a,o+=2,r--}try{e.append(jn.decode(i,Vt.GB2312))}catch(u){throw new W(u)}},n.decodeKanjiSegment=function(t,e,r){if(13*r>t.available())throw new W;for(var i=new Uint8Array(2*r),o=0;r>0;){var s=t.readBits(13),a=s/192<<8&4294967295|s%192;a+=a<7936?33088:49472,i[o]=a>>8,i[o+1]=a,o+=2,r--}try{e.append(jn.decode(i,Vt.SHIFT_JIS))}catch(u){throw new W(u)}},n.decodeByteSegment=function(t,e,r,i,o,s){if(8*r>t.available())throw new W;for(var a,u=new Uint8Array(r),c=0;c<r;c++)u[c]=t.readBits(8);a=i===null?Vt.guessEncoding(u,s):i.getName();try{e.append(jn.decode(u,a))}catch(h){throw new W(h)}o.push(u)},n.toAlphaNumericChar=function(t){if(t>=n.ALPHANUMERIC_CHARS.length)throw new W;return n.ALPHANUMERIC_CHARS[t]},n.decodeAlphanumericSegment=function(t,e,r,i){for(var o=e.length();r>1;){if(t.available()<11)throw new W;var s=t.readBits(11);e.append(n.toAlphaNumericChar(Math.floor(s/45))),e.append(n.toAlphaNumericChar(s%45)),r-=2}if(r===1){if(t.available()<6)throw new W;e.append(n.toAlphaNumericChar(t.readBits(6)))}if(i)for(var a=o;a<e.length();a++)e.charAt(a)==="%"&&(a<e.length()-1&&e.charAt(a+1)==="%"?e.deleteCharAt(a+1):e.setCharAt(a,""))},n.decodeNumericSegment=function(t,e,r){for(;r>=3;){if(t.available()<10)throw new W;var i=t.readBits(10);if(i>=1e3)throw new W;e.append(n.toAlphaNumericChar(Math.floor(i/100))),e.append(n.toAlphaNumericChar(Math.floor(i/10)%10)),e.append(n.toAlphaNumericChar(i%10)),r-=3}if(r===2){if(t.available()<7)throw new W;var o=t.readBits(7);if(o>=100)throw new W;e.append(n.toAlphaNumericChar(Math.floor(o/10))),e.append(n.toAlphaNumericChar(o%10))}else if(r===1){if(t.available()<4)throw new W;var s=t.readBits(4);if(s>=10)throw new W;e.append(n.toAlphaNumericChar(s))}},n.parseECIValue=function(t){var e=t.readBits(8);if(!(128&e))return 127&e;if((192&e)==128)return(63&e)<<8&4294967295|t.readBits(8);if((224&e)==192)return(31&e)<<16&4294967295|t.readBits(16);throw new W},n.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",n.GB2312_SUBSET=1,n}(),b1=function(){function n(t){this.mirrored=t}return n.prototype.isMirrored=function(){return this.mirrored},n.prototype.applyMirroredCorrection=function(t){if(this.mirrored&&t!==null&&!(t.length<3)){var e=t[0];t[0]=t[2],t[2]=e}},n}(),Th=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},b4=function(){function n(){this.rsDecoder=new ms(hn.QR_CODE_FIELD_256)}return n.prototype.decodeBooleanArray=function(t,e){return this.decodeBitMatrix(Qe.parseFromBooleanArray(t),e)},n.prototype.decodeBitMatrix=function(t,e){var r=new T4(t),i=null;try{return this.decodeBitMatrixParser(r,e)}catch(s){i=s}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();var o=this.decodeBitMatrixParser(r,e);return o.setOther(new b1(!0)),o}catch(s){throw i!==null?i:s}},n.prototype.decodeBitMatrixParser=function(t,e){var r,i,o,s,a=t.readVersion(),u=t.readFormatInformation().getErrorCorrectionLevel(),c=t.readCodewords(),h=C4.getDataBlocks(c,a,u),d=0;try{for(var f=Th(h),g=f.next();!g.done;g=f.next())d+=(N=g.value).getNumDataCodewords()}catch(F){r={error:F}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}var _=new Uint8Array(d),v=0;try{for(var I=Th(h),T=I.next();!T.done;T=I.next()){var N,k=(N=T.value).getCodewords(),P=N.getNumDataCodewords();this.correctErrors(k,P);for(var B=0;B<P;B++)_[v++]=k[B]}}catch(F){o={error:F}}finally{try{T&&!T.done&&(s=I.return)&&s.call(I)}finally{if(o)throw o.error}}return S4.decode(_,a,u,e)},n.prototype.correctErrors=function(t,e){var r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch{throw new xt}for(var i=0;i<e;i++)t[i]=r[i]},n}(),R4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),N4=function(n){function t(e,r,i){var o=n.call(this,e,r)||this;return o.estimatedModuleSize=i,o}return R4(t,n),t.prototype.aboutEquals=function(e,r,i){if(Math.abs(r-this.getY())<=e&&Math.abs(i-this.getX())<=e){var o=Math.abs(e-this.estimatedModuleSize);return o<=1||o<=this.estimatedModuleSize}return!1},t.prototype.combineEstimate=function(e,r,i){return new t((this.getX()+r)/2,(this.getY()+e)/2,(this.estimatedModuleSize+i)/2)},t}(X),O4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},P4=function(){function n(t,e,r,i,o,s,a){this.image=t,this.startX=e,this.startY=r,this.width=i,this.height=o,this.moduleSize=s,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return n.prototype.find=function(){for(var t=this.startX,e=this.height,r=t+this.width,i=this.startY+e/2,o=new Int32Array(3),s=this.image,a=0;a<e;a++){var u=i+(1&a?-Math.floor((a+1)/2):Math.floor((a+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var c=t;c<r&&!s.get(c,u);)c++;for(var h=0;c<r;){if(s.get(c,u))if(h===1)o[1]++;else if(h===2){var d;if(this.foundPatternCross(o)&&(d=this.handlePossibleCenter(o,u,c))!==null)return d;o[0]=o[2],o[1]=1,o[2]=0,h=1}else o[++h]++;else h===1&&h++,o[h]++;c++}if(this.foundPatternCross(o)&&(d=this.handlePossibleCenter(o,u,r))!==null)return d}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new V},n.centerFromEnd=function(t,e){return e-t[2]-t[1]/2},n.prototype.foundPatternCross=function(t){for(var e=this.moduleSize,r=e/2,i=0;i<3;i++)if(Math.abs(e-t[i])>=r)return!1;return!0},n.prototype.crossCheckVertical=function(t,e,r,i){var o=this.image,s=o.getHeight(),a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var u=t;u>=0&&o.get(e,u)&&a[1]<=r;)a[1]++,u--;if(u<0||a[1]>r)return NaN;for(;u>=0&&!o.get(e,u)&&a[0]<=r;)a[0]++,u--;if(a[0]>r)return NaN;for(u=t+1;u<s&&o.get(e,u)&&a[1]<=r;)a[1]++,u++;if(u===s||a[1]>r)return NaN;for(;u<s&&!o.get(e,u)&&a[2]<=r;)a[2]++,u++;if(a[2]>r)return NaN;var c=a[0]+a[1]+a[2];return 5*Math.abs(c-i)>=2*i?NaN:this.foundPatternCross(a)?n.centerFromEnd(a,u):NaN},n.prototype.handlePossibleCenter=function(t,e,r){var i,o,s=t[0]+t[1]+t[2],a=n.centerFromEnd(t,r),u=this.crossCheckVertical(e,a,2*t[1],s);if(!isNaN(u)){var c=(t[0]+t[1]+t[2])/3;try{for(var h=O4(this.possibleCenters),d=h.next();!d.done;d=h.next()){var f=d.value;if(f.aboutEquals(c,u,a))return f.combineEstimate(u,a,c)}}catch(_){i={error:_}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}var g=new N4(a,u,c);this.possibleCenters.push(g),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(g)}return null},n}(),D4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),x4=function(n){function t(e,r,i,o){var s=n.call(this,e,r)||this;return s.estimatedModuleSize=i,s.count=o,o===void 0&&(s.count=1),s}return D4(t,n),t.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},t.prototype.getCount=function(){return this.count},t.prototype.aboutEquals=function(e,r,i){if(Math.abs(r-this.getY())<=e&&Math.abs(i-this.getX())<=e){var o=Math.abs(e-this.estimatedModuleSize);return o<=1||o<=this.estimatedModuleSize}return!1},t.prototype.combineEstimate=function(e,r,i){var o=this.count+1;return new t((this.count*this.getX()+r)/o,(this.count*this.getY()+e)/o,(this.count*this.estimatedModuleSize+i)/o,o)},t}(X),M4=function(){function n(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}return n.prototype.getBottomLeft=function(){return this.bottomLeft},n.prototype.getTopLeft=function(){return this.topLeft},n.prototype.getTopRight=function(){return this.topRight},n}(),Xr=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},k4=function(){function n(t,e){this.image=t,this.resultPointCallback=e,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=e}return n.prototype.getImage=function(){return this.image},n.prototype.getPossibleCenters=function(){return this.possibleCenters},n.prototype.find=function(t){var e=t!=null&&t.get(_t.TRY_HARDER)!==void 0,r=t!=null&&t.get(_t.PURE_BARCODE)!==void 0,i=this.image,o=i.getHeight(),s=i.getWidth(),a=Math.floor(3*o/(4*n.MAX_MODULES));(a<n.MIN_SKIP||e)&&(a=n.MIN_SKIP);for(var u=!1,c=new Int32Array(5),h=a-1;h<o&&!u;h+=a){c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0;for(var d=0,f=0;f<s;f++)if(i.get(f,h))(1&d)==1&&d++,c[d]++;else if(1&d)c[d]++;else if(d===4)if(n.foundPatternCross(c)){if(this.handlePossibleCenter(c,h,f,r)!==!0){c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,d=3;continue}if(a=2,this.hasSkipped===!0)u=this.haveMultiplyConfirmedCenters();else{var g=this.findRowSkip();g>c[2]&&(h+=g-c[2]-a,f=s-1)}d=0,c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0}else c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,d=3;else c[++d]++;n.foundPatternCross(c)&&this.handlePossibleCenter(c,h,s,r)===!0&&(a=c[0],this.hasSkipped&&(u=this.haveMultiplyConfirmedCenters()))}var _=this.selectBestPatterns();return X.orderBestPatterns(_),new M4(_)},n.centerFromEnd=function(t,e){return e-t[4]-t[3]-t[2]/2},n.foundPatternCross=function(t){for(var e=0,r=0;r<5;r++){var i=t[r];if(i===0)return!1;e+=i}if(e<7)return!1;var o=e/7,s=o/2;return Math.abs(o-t[0])<s&&Math.abs(o-t[1])<s&&Math.abs(3*o-t[2])<3*s&&Math.abs(o-t[3])<s&&Math.abs(o-t[4])<s},n.prototype.getCrossCheckStateCount=function(){var t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t},n.prototype.crossCheckDiagonal=function(t,e,r,i){for(var o=this.getCrossCheckStateCount(),s=0,a=this.image;t>=s&&e>=s&&a.get(e-s,t-s);)o[2]++,s++;if(t<s||e<s)return!1;for(;t>=s&&e>=s&&!a.get(e-s,t-s)&&o[1]<=r;)o[1]++,s++;if(t<s||e<s||o[1]>r)return!1;for(;t>=s&&e>=s&&a.get(e-s,t-s)&&o[0]<=r;)o[0]++,s++;if(o[0]>r)return!1;var u=a.getHeight(),c=a.getWidth();for(s=1;t+s<u&&e+s<c&&a.get(e+s,t+s);)o[2]++,s++;if(t+s>=u||e+s>=c)return!1;for(;t+s<u&&e+s<c&&!a.get(e+s,t+s)&&o[3]<r;)o[3]++,s++;if(t+s>=u||e+s>=c||o[3]>=r)return!1;for(;t+s<u&&e+s<c&&a.get(e+s,t+s)&&o[4]<r;)o[4]++,s++;if(o[4]>=r)return!1;var h=o[0]+o[1]+o[2]+o[3]+o[4];return Math.abs(h-i)<2*i&&n.foundPatternCross(o)},n.prototype.crossCheckVertical=function(t,e,r,i){for(var o=this.image,s=o.getHeight(),a=this.getCrossCheckStateCount(),u=t;u>=0&&o.get(e,u);)a[2]++,u--;if(u<0)return NaN;for(;u>=0&&!o.get(e,u)&&a[1]<=r;)a[1]++,u--;if(u<0||a[1]>r)return NaN;for(;u>=0&&o.get(e,u)&&a[0]<=r;)a[0]++,u--;if(a[0]>r)return NaN;for(u=t+1;u<s&&o.get(e,u);)a[2]++,u++;if(u===s)return NaN;for(;u<s&&!o.get(e,u)&&a[3]<r;)a[3]++,u++;if(u===s||a[3]>=r)return NaN;for(;u<s&&o.get(e,u)&&a[4]<r;)a[4]++,u++;if(a[4]>=r)return NaN;var c=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(c-i)>=2*i?NaN:n.foundPatternCross(a)?n.centerFromEnd(a,u):NaN},n.prototype.crossCheckHorizontal=function(t,e,r,i){for(var o=this.image,s=o.getWidth(),a=this.getCrossCheckStateCount(),u=t;u>=0&&o.get(u,e);)a[2]++,u--;if(u<0)return NaN;for(;u>=0&&!o.get(u,e)&&a[1]<=r;)a[1]++,u--;if(u<0||a[1]>r)return NaN;for(;u>=0&&o.get(u,e)&&a[0]<=r;)a[0]++,u--;if(a[0]>r)return NaN;for(u=t+1;u<s&&o.get(u,e);)a[2]++,u++;if(u===s)return NaN;for(;u<s&&!o.get(u,e)&&a[3]<r;)a[3]++,u++;if(u===s||a[3]>=r)return NaN;for(;u<s&&o.get(u,e)&&a[4]<r;)a[4]++,u++;if(a[4]>=r)return NaN;var c=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(c-i)>=i?NaN:n.foundPatternCross(a)?n.centerFromEnd(a,u):NaN},n.prototype.handlePossibleCenter=function(t,e,r,i){var o=t[0]+t[1]+t[2]+t[3]+t[4],s=n.centerFromEnd(t,r),a=this.crossCheckVertical(e,Math.floor(s),t[2],o);if(!isNaN(a)&&(s=this.crossCheckHorizontal(Math.floor(s),Math.floor(a),t[2],o),!isNaN(s)&&(!i||this.crossCheckDiagonal(Math.floor(a),Math.floor(s),t[2],o)))){for(var u=o/7,c=!1,h=this.possibleCenters,d=0,f=h.length;d<f;d++){var g=h[d];if(g.aboutEquals(u,a,s)){h[d]=g.combineEstimate(a,s,u),c=!0;break}}if(!c){var _=new x4(s,a,u);h.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return!0}return!1},n.prototype.findRowSkip=function(){var t,e;if(this.possibleCenters.length<=1)return 0;var r=null;try{for(var i=Xr(this.possibleCenters),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.getCount()>=n.CENTER_QUORUM){if(r!=null)return this.hasSkipped=!0,Math.floor((Math.abs(r.getX()-s.getX())-Math.abs(r.getY()-s.getY()))/2);r=s}}}catch(a){t={error:a}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return 0},n.prototype.haveMultiplyConfirmedCenters=function(){var t,e,r,i,o=0,s=0,a=this.possibleCenters.length;try{for(var u=Xr(this.possibleCenters),c=u.next();!c.done;c=u.next())(_=c.value).getCount()>=n.CENTER_QUORUM&&(o++,s+=_.getEstimatedModuleSize())}catch(v){t={error:v}}finally{try{c&&!c.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}if(o<3)return!1;var h=s/a,d=0;try{for(var f=Xr(this.possibleCenters),g=f.next();!g.done;g=f.next()){var _=g.value;d+=Math.abs(_.getEstimatedModuleSize()-h)}}catch(v){r={error:v}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return d<=.05*s},n.prototype.selectBestPatterns=function(){var t,e,r,i,o=this.possibleCenters.length;if(o<3)throw new V;var s,a=this.possibleCenters;if(o>3){var u=0,c=0;try{for(var h=Xr(this.possibleCenters),d=h.next();!d.done;d=h.next()){var f=d.value.getEstimatedModuleSize();u+=f,c+=f*f}}catch(k){t={error:k}}finally{try{d&&!d.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}s=u/o;var g=Math.sqrt(c/o-s*s);a.sort(function(k,P){var B=Math.abs(P.getEstimatedModuleSize()-s),F=Math.abs(k.getEstimatedModuleSize()-s);return B<F?-1:B>F?1:0});for(var _=Math.max(.2*s,g),v=0;v<a.length&&a.length>3;v++){var I=a[v];Math.abs(I.getEstimatedModuleSize()-s)>_&&(a.splice(v,1),v--)}}if(a.length>3){u=0;try{for(var T=Xr(a),N=T.next();!N.done;N=T.next())u+=N.value.getEstimatedModuleSize()}catch(k){r={error:k}}finally{try{N&&!N.done&&(i=T.return)&&i.call(T)}finally{if(r)throw r.error}}s=u/a.length,a.sort(function(k,P){if(P.getCount()===k.getCount()){var B=Math.abs(P.getEstimatedModuleSize()-s),F=Math.abs(k.getEstimatedModuleSize()-s);return B<F?1:B>F?-1:0}return P.getCount()-k.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]},n.CENTER_QUORUM=2,n.MIN_SKIP=3,n.MAX_MODULES=57,n}(),L4=function(){function n(t){this.image=t}return n.prototype.getImage=function(){return this.image},n.prototype.getResultPointCallback=function(){return this.resultPointCallback},n.prototype.detect=function(t){this.resultPointCallback=t==null?null:t.get(_t.NEED_RESULT_POINT_CALLBACK);var e=new k4(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(e)},n.prototype.processFinderPatternInfo=function(t){var e=t.getTopLeft(),r=t.getTopRight(),i=t.getBottomLeft(),o=this.calculateModuleSize(e,r,i);if(o<1)throw new V("No pattern found in proccess finder.");var s=n.computeDimension(e,r,i,o),a=To.getProvisionalVersionForDimension(s),u=a.getDimensionForVersion()-7,c=null;if(a.getAlignmentPatternCenters().length>0)for(var h=r.getX()-e.getX()+i.getX(),d=r.getY()-e.getY()+i.getY(),f=1-3/u,g=Math.floor(e.getX()+f*(h-e.getX())),_=Math.floor(e.getY()+f*(d-e.getY())),v=4;v<=16;v<<=1)try{c=this.findAlignmentInRegion(o,g,_,v);break}catch(N){if(!(N instanceof V))throw N}var I=n.createTransform(e,r,i,c,s),T=n.sampleGrid(this.image,I,s);return new Fu(T,c===null?[i,e,r]:[i,e,r,c])},n.createTransform=function(t,e,r,i,o){var s,a,u,c,h=o-3.5;return i!==null?(s=i.getX(),a=i.getY(),c=u=h-3):(s=e.getX()-t.getX()+r.getX(),a=e.getY()-t.getY()+r.getY(),u=h,c=h),E1.quadrilateralToQuadrilateral(3.5,3.5,h,3.5,u,c,3.5,h,t.getX(),t.getY(),e.getX(),e.getY(),s,a,r.getX(),r.getY())},n.sampleGrid=function(t,e,r){return Uu.getInstance().sampleGridWithTransform(t,r,r,e)},n.computeDimension=function(t,e,r,i){var o=at.round(X.distance(t,e)/i),s=at.round(X.distance(t,r)/i),a=Math.floor((o+s)/2)+7;switch(3&a){case 0:a++;break;case 2:a--;break;case 3:throw new V("Dimensions could be not found.")}return a},n.prototype.calculateModuleSize=function(t,e,r){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,r))/2},n.prototype.calculateModuleSizeOneWay=function(t,e){var r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY())),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(r)?i/7:isNaN(i)?r/7:(r+i)/14},n.prototype.sizeOfBlackWhiteBlackRunBothWays=function(t,e,r,i){var o=this.sizeOfBlackWhiteBlackRun(t,e,r,i),s=1,a=t-(r-t);a<0?(s=t/(t-a),a=0):a>=this.image.getWidth()&&(s=(this.image.getWidth()-1-t)/(a-t),a=this.image.getWidth()-1);var u=Math.floor(e-(i-e)*s);return s=1,u<0?(s=e/(e-u),u=0):u>=this.image.getHeight()&&(s=(this.image.getHeight()-1-e)/(u-e),u=this.image.getHeight()-1),a=Math.floor(t+(a-t)*s),(o+=this.sizeOfBlackWhiteBlackRun(t,e,a,u))-1},n.prototype.sizeOfBlackWhiteBlackRun=function(t,e,r,i){var o=Math.abs(i-e)>Math.abs(r-t);if(o){var s=t;t=e,e=s,s=r,r=i,i=s}for(var a=Math.abs(r-t),u=Math.abs(i-e),c=-a/2,h=t<r?1:-1,d=e<i?1:-1,f=0,g=r+h,_=t,v=e;_!==g;_+=h){var I=o?v:_,T=o?_:v;if(f===1===this.image.get(I,T)){if(f===2)return at.distance(_,v,t,e);f++}if((c+=u)>0){if(v===i)break;v+=d,c-=a}}return f===2?at.distance(r+h,i,t,e):NaN},n.prototype.findAlignmentInRegion=function(t,e,r,i){var o=Math.floor(i*t),s=Math.max(0,e-o),a=Math.min(this.image.getWidth()-1,e+o);if(a-s<3*t)throw new V("Alignment top exceeds estimated module size.");var u=Math.max(0,r-o),c=Math.min(this.image.getHeight()-1,r+o);if(c-u<3*t)throw new V("Alignment bottom exceeds estimated module size.");return new P4(this.image,s,u,a-s,c-u,t,this.resultPointCallback).find()},n}(),zo=function(){function n(){this.decoder=new b4}return n.prototype.getDecoder=function(){return this.decoder},n.prototype.decode=function(t,e){var r,i;if(e!=null&&e.get(_t.PURE_BARCODE)!==void 0){var o=n.extractPureBits(t.getBlackMatrix());r=this.decoder.decodeBitMatrix(o,e),i=n.NO_POINTS}else{var s=new L4(t.getBlackMatrix()).detect(e);r=this.decoder.decodeBitMatrix(s.getBits(),e),i=s.getPoints()}r.getOther()instanceof b1&&r.getOther().applyMirroredCorrection(i);var a=new pe(r.getText(),r.getRawBytes(),void 0,i,Y.QR_CODE,void 0),u=r.getByteSegments();u!==null&&a.putMetadata(Wt.BYTE_SEGMENTS,u);var c=r.getECLevel();return c!==null&&a.putMetadata(Wt.ERROR_CORRECTION_LEVEL,c),r.hasStructuredAppend()&&(a.putMetadata(Wt.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),a.putMetadata(Wt.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),a},n.prototype.reset=function(){},n.extractPureBits=function(t){var e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(e===null||r===null)throw new V;var i=this.moduleSize(e,t),o=e[1],s=r[1],a=e[0],u=r[0];if(a>=u||o>=s)throw new V;if(s-o!=u-a&&(u=a+(s-o))>=t.getWidth())throw new V;var c=Math.round((u-a+1)/i),h=Math.round((s-o+1)/i);if(c<=0||h<=0)throw new V;if(h!==c)throw new V;var d=Math.floor(i/2);o+=d;var f=(a+=d)+Math.floor((c-1)*i)-u;if(f>0){if(f>d)throw new V;a-=f}var g=o+Math.floor((h-1)*i)-s;if(g>0){if(g>d)throw new V;o-=g}for(var _=new Qe(c,h),v=0;v<h;v++)for(var I=o+Math.floor(v*i),T=0;T<c;T++)t.get(a+Math.floor(T*i),I)&&_.set(T,v);return _},n.moduleSize=function(t,e){for(var r=e.getHeight(),i=e.getWidth(),o=t[0],s=t[1],a=!0,u=0;o<i&&s<r;){if(a!==e.get(o,s)){if(++u==5)break;a=!a}o++,s++}if(o===i||s===r)throw new V;return(o-t[0])/7},n.NO_POINTS=new Array,n}(),V4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ot=function(){function n(){}return n.prototype.PDF417Common=function(){},n.getBitCountSum=function(t){return at.sum(t)},n.toIntArray=function(t){var e,r;if(t==null||!t.length)return n.EMPTY_INT_ARRAY;var i=new Int32Array(t.length),o=0;try{for(var s=V4(t),a=s.next();!a.done;a=s.next()){var u=a.value;i[o++]=u}}catch(c){e={error:c}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return i},n.getCodeword=function(t){var e=we.binarySearch(n.SYMBOL_TABLE,262143&t);return e<0?-1:(n.CODEWORD_TABLE[e]-1)%n.NUMBER_OF_CODEWORDS},n.NUMBER_OF_CODEWORDS=929,n.MAX_CODEWORDS_IN_BARCODE=n.NUMBER_OF_CODEWORDS-1,n.MIN_ROWS_IN_BARCODE=3,n.MAX_ROWS_IN_BARCODE=90,n.MODULES_IN_CODEWORD=17,n.MODULES_IN_STOP_PATTERN=18,n.BARS_IN_MODULE=8,n.EMPTY_INT_ARRAY=new Int32Array([]),n.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),n.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),n}(),B4=function(){function n(t,e){this.bits=t,this.points=e}return n.prototype.getBits=function(){return this.bits},n.prototype.getPoints=function(){return this.points},n}(),F4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},U4=function(){function n(){}return n.detectMultiple=function(t,e,r){var i=t.getBlackMatrix(),o=n.detect(r,i);return o.length||((i=i.clone()).rotate180(),o=n.detect(r,i)),new B4(i,o)},n.detect=function(t,e){for(var r,i,o=new Array,s=0,a=0,u=!1;s<e.getHeight();){var c=n.findVertices(e,s,a);if(c[0]!=null||c[3]!=null){if(u=!0,o.push(c),!t)break;c[2]!=null?(a=Math.trunc(c[2].getX()),s=Math.trunc(c[2].getY())):(a=Math.trunc(c[4].getX()),s=Math.trunc(c[4].getY()))}else{if(!u)break;u=!1,a=0;try{for(var h=(r=void 0,F4(o)),d=h.next();!d.done;d=h.next()){var f=d.value;f[1]!=null&&(s=Math.trunc(Math.max(s,f[1].getY()))),f[3]!=null&&(s=Math.max(s,Math.trunc(f[3].getY())))}}catch(g){r={error:g}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}s+=n.ROW_STEP}}return o},n.findVertices=function(t,e,r){var i=t.getHeight(),o=t.getWidth(),s=new Array(8);return n.copyToResult(s,n.findRowsWithPattern(t,i,o,e,r,n.START_PATTERN),n.INDEXES_START_PATTERN),s[4]!=null&&(r=Math.trunc(s[4].getX()),e=Math.trunc(s[4].getY())),n.copyToResult(s,n.findRowsWithPattern(t,i,o,e,r,n.STOP_PATTERN),n.INDEXES_STOP_PATTERN),s},n.copyToResult=function(t,e,r){for(var i=0;i<r.length;i++)t[r[i]]=e[i]},n.findRowsWithPattern=function(t,e,r,i,o,s){for(var a=new Array(4),u=!1,c=new Int32Array(s.length);i<e;i+=n.ROW_STEP)if((g=n.findGuardPattern(t,o,i,r,!1,s,c))!=null){for(;i>0;){if((f=n.findGuardPattern(t,o,--i,r,!1,s,c))==null){i++;break}g=f}a[0]=new X(g[0],i),a[1]=new X(g[1],i),u=!0;break}var h=i+1;if(u){for(var d=0,f=Int32Array.from([Math.trunc(a[0].getX()),Math.trunc(a[1].getX())]);h<e;h++){var g;if((g=n.findGuardPattern(t,f[0],h,r,!1,s,c))!=null&&Math.abs(f[0]-g[0])<n.MAX_PATTERN_DRIFT&&Math.abs(f[1]-g[1])<n.MAX_PATTERN_DRIFT)f=g,d=0;else{if(d>n.SKIPPED_ROW_COUNT_MAX)break;d++}}h-=d+1,a[2]=new X(f[0],h),a[3]=new X(f[1],h)}return h-i<n.BARCODE_MIN_HEIGHT&&we.fill(a,null),a},n.findGuardPattern=function(t,e,r,i,o,s,a){we.fillWithin(a,0,a.length,0);for(var u=e,c=0;t.get(u,r)&&u>0&&c++<n.MAX_PIXEL_DRIFT;)u--;for(var h=u,d=0,f=s.length,g=o;h<i;h++)if(t.get(h,r)!==g)a[d]++;else{if(d===f-1){if(n.patternMatchVariance(a,s,n.MAX_INDIVIDUAL_VARIANCE)<n.MAX_AVG_VARIANCE)return new Int32Array([u,h]);u+=a[0]+a[1],wt.arraycopy(a,2,a,0,d-1),a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,g=!g}return d===f-1&&n.patternMatchVariance(a,s,n.MAX_INDIVIDUAL_VARIANCE)<n.MAX_AVG_VARIANCE?new Int32Array([u,h-1]):null},n.patternMatchVariance=function(t,e,r){for(var i=t.length,o=0,s=0,a=0;a<i;a++)o+=t[a],s+=e[a];if(o<s)return 1/0;var u=o/s;r*=u;for(var c=0,h=0;h<i;h++){var d=t[h],f=e[h]*u,g=d>f?d-f:f-d;if(g>r)return 1/0;c+=g}return c/o},n.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),n.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),n.MAX_AVG_VARIANCE=.42,n.MAX_INDIVIDUAL_VARIANCE=.8,n.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),n.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),n.MAX_PIXEL_DRIFT=3,n.MAX_PATTERN_DRIFT=5,n.SKIPPED_ROW_COUNT_MAX=25,n.ROW_STEP=5,n.BARCODE_MIN_HEIGHT=10,n}(),j4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Vn=function(){function n(t,e){if(e.length===0)throw new Z;this.field=t;var r=e.length;if(r>1&&e[0]===0){for(var i=1;i<r&&e[i]===0;)i++;i===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-i),wt.arraycopy(e,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}return n.prototype.getCoefficients=function(){return this.coefficients},n.prototype.getDegree=function(){return this.coefficients.length-1},n.prototype.isZero=function(){return this.coefficients[0]===0},n.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},n.prototype.evaluateAt=function(t){var e,r;if(t===0)return this.getCoefficient(0);if(t===1){var i=0;try{for(var o=j4(this.coefficients),s=o.next();!s.done;s=o.next()){var a=s.value;i=this.field.add(i,a)}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i}for(var u=this.coefficients[0],c=this.coefficients.length,h=1;h<c;h++)u=this.field.add(this.field.multiply(t,u),this.coefficients[h]);return u},n.prototype.add=function(t){if(!this.field.equals(t.field))throw new Z("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;var e=this.coefficients,r=t.coefficients;if(e.length>r.length){var i=e;e=r,r=i}var o=new Int32Array(r.length),s=r.length-e.length;wt.arraycopy(r,0,o,0,s);for(var a=s;a<r.length;a++)o[a]=this.field.add(e[a-s],r[a]);return new n(this.field,o)},n.prototype.subtract=function(t){if(!this.field.equals(t.field))throw new Z("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())},n.prototype.multiply=function(t){return t instanceof n?this.multiplyOther(t):this.multiplyScalar(t)},n.prototype.multiplyOther=function(t){if(!this.field.equals(t.field))throw new Z("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new n(this.field,new Int32Array([0]));for(var e=this.coefficients,r=e.length,i=t.coefficients,o=i.length,s=new Int32Array(r+o-1),a=0;a<r;a++)for(var u=e[a],c=0;c<o;c++)s[a+c]=this.field.add(s[a+c],this.field.multiply(u,i[c]));return new n(this.field,s)},n.prototype.negative=function(){for(var t=this.coefficients.length,e=new Int32Array(t),r=0;r<t;r++)e[r]=this.field.subtract(0,this.coefficients[r]);return new n(this.field,e)},n.prototype.multiplyScalar=function(t){if(t===0)return new n(this.field,new Int32Array([0]));if(t===1)return this;for(var e=this.coefficients.length,r=new Int32Array(e),i=0;i<e;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new n(this.field,r)},n.prototype.multiplyByMonomial=function(t,e){if(t<0)throw new Z;if(e===0)return new n(this.field,new Int32Array([0]));for(var r=this.coefficients.length,i=new Int32Array(r+t),o=0;o<r;o++)i[o]=this.field.multiply(this.coefficients[o],e);return new n(this.field,i)},n.prototype.toString=function(){for(var t=new pt,e=this.getDegree();e>=0;e--){var r=this.getCoefficient(e);r!==0&&(r<0?(t.append(" - "),r=-r):t.length()>0&&t.append(" + "),e!==0&&r===1||t.append(r),e!==0&&(e===1?t.append("x"):(t.append("x^"),t.append(e))))}return t.toString()},n}(),H4=function(){function n(){}return n.prototype.add=function(t,e){return(t+e)%this.modulus},n.prototype.subtract=function(t,e){return(this.modulus+t-e)%this.modulus},n.prototype.exp=function(t){return this.expTable[t]},n.prototype.log=function(t){if(t===0)throw new Z;return this.logTable[t]},n.prototype.inverse=function(t){if(t===0)throw new v1;return this.expTable[this.modulus-this.logTable[t]-1]},n.prototype.multiply=function(t,e){return t===0||e===0?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.modulus-1)]},n.prototype.getSize=function(){return this.modulus},n.prototype.equals=function(t){return t===this},n}(),G4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),W4=function(n){function t(e,r){var i=n.call(this)||this;i.modulus=e,i.expTable=new Int32Array(e),i.logTable=new Int32Array(e);for(var o=1,s=0;s<e;s++)i.expTable[s]=o,o=o*r%e;for(s=0;s<e-1;s++)i.logTable[i.expTable[s]]=s;return i.zero=new Vn(i,new Int32Array([0])),i.one=new Vn(i,new Int32Array([1])),i}return G4(t,n),t.prototype.getZero=function(){return this.zero},t.prototype.getOne=function(){return this.one},t.prototype.buildMonomial=function(e,r){if(e<0)throw new Z;if(r===0)return this.zero;var i=new Int32Array(e+1);return i[0]=r,new Vn(this,i)},t.PDF417_GF=new t(ot.NUMBER_OF_CODEWORDS,3),t}(H4),z4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},X4=function(){function n(){this.field=W4.PDF417_GF}return n.prototype.decode=function(t,e,r){for(var i,o,s=new Vn(this.field,t),a=new Int32Array(e),u=!1,c=e;c>0;c--){var h=s.evaluateAt(this.field.exp(c));a[e-c]=h,h!==0&&(u=!0)}if(!u)return 0;var d=this.field.getOne();if(r!=null)try{for(var f=z4(r),g=f.next();!g.done;g=f.next()){var _=g.value,v=this.field.exp(t.length-1-_),I=new Vn(this.field,new Int32Array([this.field.subtract(0,v),1]));d=d.multiply(I)}}catch(A){i={error:A}}finally{try{g&&!g.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}var T=new Vn(this.field,a),N=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),T,e),k=N[0],P=N[1],B=this.findErrorLocations(k),F=this.findErrorMagnitudes(P,k,B);for(c=0;c<B.length;c++){var S=t.length-1-this.field.log(B[c]);if(S<0)throw xt.getChecksumInstance();t[S]=this.field.subtract(t[S],F[c])}return B.length},n.prototype.runEuclideanAlgorithm=function(t,e,r){if(t.getDegree()<e.getDegree()){var i=t;t=e,e=i}for(var o=t,s=e,a=this.field.getZero(),u=this.field.getOne();s.getDegree()>=Math.round(r/2);){var c=o,h=a;if(a=u,(o=s).isZero())throw xt.getChecksumInstance();s=c;for(var d=this.field.getZero(),f=o.getCoefficient(o.getDegree()),g=this.field.inverse(f);s.getDegree()>=o.getDegree()&&!s.isZero();){var _=s.getDegree()-o.getDegree(),v=this.field.multiply(s.getCoefficient(s.getDegree()),g);d=d.add(this.field.buildMonomial(_,v)),s=s.subtract(o.multiplyByMonomial(_,v))}u=d.multiply(a).subtract(h).negative()}var I=u.getCoefficient(0);if(I===0)throw xt.getChecksumInstance();var T=this.field.inverse(I);return[u.multiply(T),s.multiply(T)]},n.prototype.findErrorLocations=function(t){for(var e=t.getDegree(),r=new Int32Array(e),i=0,o=1;o<this.field.getSize()&&i<e;o++)t.evaluateAt(o)===0&&(r[i]=this.field.inverse(o),i++);if(i!==e)throw xt.getChecksumInstance();return r},n.prototype.findErrorMagnitudes=function(t,e,r){for(var i=e.getDegree(),o=new Int32Array(i),s=1;s<=i;s++)o[i-s]=this.field.multiply(s,e.getCoefficient(s));var a=new Vn(this.field,o),u=r.length,c=new Int32Array(u);for(s=0;s<u;s++){var h=this.field.inverse(r[s]),d=this.field.subtract(0,t.evaluateAt(h)),f=this.field.inverse(a.evaluateAt(h));c[s]=this.field.multiply(d,f)}return c},n}(),Ba=function(){function n(t,e,r,i,o){t instanceof n?this.constructor_2(t):this.constructor_1(t,e,r,i,o)}return n.prototype.constructor_1=function(t,e,r,i,o){var s=e==null||r==null,a=i==null||o==null;if(s&&a)throw new V;s?(e=new X(0,i.getY()),r=new X(0,o.getY())):a&&(i=new X(t.getWidth()-1,e.getY()),o=new X(t.getWidth()-1,r.getY())),this.image=t,this.topLeft=e,this.bottomLeft=r,this.topRight=i,this.bottomRight=o,this.minX=Math.trunc(Math.min(e.getX(),r.getX())),this.maxX=Math.trunc(Math.max(i.getX(),o.getX())),this.minY=Math.trunc(Math.min(e.getY(),i.getY())),this.maxY=Math.trunc(Math.max(r.getY(),o.getY()))},n.prototype.constructor_2=function(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()},n.merge=function(t,e){return t==null?e:e==null?t:new n(t.image,t.topLeft,t.bottomLeft,e.topRight,e.bottomRight)},n.prototype.addMissingRows=function(t,e,r){var i=this.topLeft,o=this.bottomLeft,s=this.topRight,a=this.bottomRight;if(t>0){var u=r?this.topLeft:this.topRight,c=Math.trunc(u.getY()-t);c<0&&(c=0);var h=new X(u.getX(),c);r?i=h:s=h}if(e>0){var d=r?this.bottomLeft:this.bottomRight,f=Math.trunc(d.getY()+e);f>=this.image.getHeight()&&(f=this.image.getHeight()-1);var g=new X(d.getX(),f);r?o=g:a=g}return new n(this.image,i,o,s,a)},n.prototype.getMinX=function(){return this.minX},n.prototype.getMaxX=function(){return this.maxX},n.prototype.getMinY=function(){return this.minY},n.prototype.getMaxY=function(){return this.maxY},n.prototype.getTopLeft=function(){return this.topLeft},n.prototype.getTopRight=function(){return this.topRight},n.prototype.getBottomLeft=function(){return this.bottomLeft},n.prototype.getBottomRight=function(){return this.bottomRight},n}(),q4=function(){function n(t,e,r,i){this.columnCount=t,this.errorCorrectionLevel=i,this.rowCountUpperPart=e,this.rowCountLowerPart=r,this.rowCount=e+r}return n.prototype.getColumnCount=function(){return this.columnCount},n.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},n.prototype.getRowCount=function(){return this.rowCount},n.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},n.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},n}(),Hu=function(){function n(){this.buffer=""}return n.form=function(t,e){var r=-1;return t.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(i,o,s,a,u,c){if(i==="%%")return"%";if(e[++r]!==void 0){i=a?parseInt(a.substr(1)):void 0;var h,d=u?parseInt(u.substr(1)):void 0;switch(c){case"s":h=e[r];break;case"c":h=e[r][0];break;case"f":h=parseFloat(e[r]).toFixed(i);break;case"p":h=parseFloat(e[r]).toPrecision(i);break;case"e":h=parseFloat(e[r]).toExponential(i);break;case"x":h=parseInt(e[r]).toString(d||16);break;case"d":h=parseFloat(parseInt(e[r],d||10).toPrecision(i)).toFixed(0)}h=typeof h=="object"?JSON.stringify(h):(+h).toString(d);for(var f=parseInt(s),g=s&&s[0]+""=="0"?"0":" ";h.length<f;)h=o!==void 0?h+g:g+h;return h}})},n.prototype.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.buffer+=n.form(t,e)},n.prototype.toString=function(){return this.buffer},n}(),$4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},R1=function(){function n(t){this.boundingBox=new Ba(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}return n.prototype.getCodewordNearby=function(t){var e=this.getCodeword(t);if(e!=null)return e;for(var r=1;r<n.MAX_NEARBY_DISTANCE;r++){var i=this.imageRowToCodewordIndex(t)-r;if(i>=0&&(e=this.codewords[i])!=null||(i=this.imageRowToCodewordIndex(t)+r)<this.codewords.length&&(e=this.codewords[i])!=null)return e}return null},n.prototype.imageRowToCodewordIndex=function(t){return t-this.boundingBox.getMinY()},n.prototype.setCodeword=function(t,e){this.codewords[this.imageRowToCodewordIndex(t)]=e},n.prototype.getCodeword=function(t){return this.codewords[this.imageRowToCodewordIndex(t)]},n.prototype.getBoundingBox=function(){return this.boundingBox},n.prototype.getCodewords=function(){return this.codewords},n.prototype.toString=function(){var t,e,r=new Hu,i=0;try{for(var o=$4(this.codewords),s=o.next();!s.done;s=o.next()){var a=s.value;a!=null?r.format("%3d: %3d|%3d%n",i++,a.getRowNumber(),a.getValue()):r.format("%3d:    |   %n",i++)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r.toString()},n.MAX_NEARBY_DISTANCE=5,n}(),K4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Y4=function(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r,i,o=e.call(n),s=[];try{for(;(t===void 0||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(i)throw i.error}}return s},Jr=function(){function n(){this.values=new Map}return n.prototype.setValue=function(t){t=Math.trunc(t);var e=this.values.get(t);e==null&&(e=0),e++,this.values.set(t,e)},n.prototype.getValue=function(){var t,e,r=-1,i=new Array,o=function(c,h){var d=function(){return c},f=function(){return h};f()>r?(r=f(),(i=[]).push(d())):f()===r&&i.push(d())};try{for(var s=K4(this.values.entries()),a=s.next();!a.done;a=s.next()){var u=Y4(a.value,2);o(u[0],u[1])}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}return ot.toIntArray(i)},n.prototype.getConfidence=function(t){return this.values.get(t)},n}(),Q4=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),aa=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ch=function(n){function t(e,r){var i=n.call(this,e)||this;return i._isLeft=r,i}return Q4(t,n),t.prototype.setRowNumbers=function(){var e,r;try{for(var i=aa(this.getCodewords()),o=i.next();!o.done;o=i.next()){var s=o.value;s!=null&&s.setRowNumberAsRowIndicatorColumn()}}catch(a){e={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},t.prototype.adjustCompleteIndicatorColumnRowNumbers=function(e){var r=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(r,e);for(var i=this.getBoundingBox(),o=this._isLeft?i.getTopLeft():i.getTopRight(),s=this._isLeft?i.getBottomLeft():i.getBottomRight(),a=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=-1,h=1,d=0,f=a;f<u;f++)if(r[f]!=null){var g=r[f],_=g.getRowNumber()-c;if(_===0)d++;else if(_===1)h=Math.max(h,d),d=1,c=g.getRowNumber();else if(_<0||g.getRowNumber()>=e.getRowCount()||_>f)r[f]=null;else{for(var v=void 0,I=(v=h>2?(h-2)*_:_)>=f,T=1;T<=v&&!I;T++)I=r[f-T]!=null;I?r[f]=null:(c=g.getRowNumber(),d=1)}}},t.prototype.getRowHeights=function(){var e,r,i=this.getBarcodeMetadata();if(i==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(i);var o=new Int32Array(i.getRowCount());try{for(var s=aa(this.getCodewords()),a=s.next();!a.done;a=s.next()){var u=a.value;if(u!=null){var c=u.getRowNumber();if(c>=o.length)continue;o[c]++}}}catch(h){e={error:h}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return o},t.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(e){for(var r=this.getBoundingBox(),i=this._isLeft?r.getTopLeft():r.getTopRight(),o=this._isLeft?r.getBottomLeft():r.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=this.getCodewords(),c=-1,h=s;h<a;h++)if(u[h]!=null){var d=u[h];d.setRowNumberAsRowIndicatorColumn();var f=d.getRowNumber()-c;f===0||(f===1?c=d.getRowNumber():d.getRowNumber()>=e.getRowCount()?u[h]=null:c=d.getRowNumber())}},t.prototype.getBarcodeMetadata=function(){var e,r,i=this.getCodewords(),o=new Jr,s=new Jr,a=new Jr,u=new Jr;try{for(var c=aa(i),h=c.next();!h.done;h=c.next()){var d=h.value;if(d!=null){d.setRowNumberAsRowIndicatorColumn();var f=d.getValue()%30,g=d.getRowNumber();switch(this._isLeft||(g+=2),g%3){case 0:s.setValue(3*f+1);break;case 1:u.setValue(f/3),a.setValue(f%3);break;case 2:o.setValue(f+1)}}}}catch(v){e={error:v}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(o.getValue().length===0||s.getValue().length===0||a.getValue().length===0||u.getValue().length===0||o.getValue()[0]<1||s.getValue()[0]+a.getValue()[0]<ot.MIN_ROWS_IN_BARCODE||s.getValue()[0]+a.getValue()[0]>ot.MAX_ROWS_IN_BARCODE)return null;var _=new q4(o.getValue()[0],s.getValue()[0],a.getValue()[0],u.getValue()[0]);return this.removeIncorrectCodewords(i,_),_},t.prototype.removeIncorrectCodewords=function(e,r){for(var i=0;i<e.length;i++){var o=e[i];if(e[i]!=null){var s=o.getValue()%30,a=o.getRowNumber();if(a>r.getRowCount())e[i]=null;else switch(this._isLeft||(a+=2),a%3){case 0:3*s+1!==r.getRowCountUpperPart()&&(e[i]=null);break;case 1:Math.trunc(s/3)===r.getErrorCorrectionLevel()&&s%3===r.getRowCountLowerPart()||(e[i]=null);break;case 2:s+1!==r.getColumnCount()&&(e[i]=null)}}}},t.prototype.isLeft=function(){return this._isLeft},t.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+n.prototype.toString.call(this)},t}(R1),Z4=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},J4=function(){function n(t,e){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=e,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return n.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var t,e=ot.MAX_CODEWORDS_IN_BARCODE;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns},n.prototype.adjustIndicatorColumnRowNumbers=function(t){t!=null&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},n.prototype.adjustRowNumbersAndGetCount=function(){var t=this.adjustRowNumbersByRow();if(t===0)return 0;for(var e=1;e<this.barcodeColumnCount+1;e++)for(var r=this.detectionResultColumns[e].getCodewords(),i=0;i<r.length;i++)r[i]!=null&&(r[i].hasValidRowNumber()||this.adjustRowNumbers(e,i,r));return t},n.prototype.adjustRowNumbersByRow=function(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()},n.prototype.adjustRowNumbersFromBothRI=function(){if(this.detectionResultColumns[0]!=null&&this.detectionResultColumns[this.barcodeColumnCount+1]!=null){for(var t=this.detectionResultColumns[0].getCodewords(),e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),r=0;r<t.length;r++)if(t[r]!=null&&e[r]!=null&&t[r].getRowNumber()===e[r].getRowNumber())for(var i=1;i<=this.barcodeColumnCount;i++){var o=this.detectionResultColumns[i].getCodewords()[r];o!=null&&(o.setRowNumber(t[r].getRowNumber()),o.hasValidRowNumber()||(this.detectionResultColumns[i].getCodewords()[r]=null))}}},n.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var t=0,e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),r=0;r<e.length;r++)if(e[r]!=null)for(var i=e[r].getRowNumber(),o=0,s=this.barcodeColumnCount+1;s>0&&o<this.ADJUST_ROW_NUMBER_SKIP;s--){var a=this.detectionResultColumns[s].getCodewords()[r];a!=null&&(o=n.adjustRowNumberIfValid(i,o,a),a.hasValidRowNumber()||t++)}return t},n.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var t=0,e=this.detectionResultColumns[0].getCodewords(),r=0;r<e.length;r++)if(e[r]!=null)for(var i=e[r].getRowNumber(),o=0,s=1;s<this.barcodeColumnCount+1&&o<this.ADJUST_ROW_NUMBER_SKIP;s++){var a=this.detectionResultColumns[s].getCodewords()[r];a!=null&&(o=n.adjustRowNumberIfValid(i,o,a),a.hasValidRowNumber()||t++)}return t},n.adjustRowNumberIfValid=function(t,e,r){return r==null||r.hasValidRowNumber()||(r.isValidRowNumber(t)?(r.setRowNumber(t),e=0):++e),e},n.prototype.adjustRowNumbers=function(t,e,r){var i,o,s=r[e],a=this.detectionResultColumns[t-1].getCodewords(),u=a;this.detectionResultColumns[t+1]!=null&&(u=this.detectionResultColumns[t+1].getCodewords());var c=new Array(14);c[2]=a[e],c[3]=u[e],e>0&&(c[0]=r[e-1],c[4]=a[e-1],c[5]=u[e-1]),e>1&&(c[8]=r[e-2],c[10]=a[e-2],c[11]=u[e-2]),e<r.length-1&&(c[1]=r[e+1],c[6]=a[e+1],c[7]=u[e+1]),e<r.length-2&&(c[9]=r[e+2],c[12]=a[e+2],c[13]=u[e+2]);try{for(var h=Z4(c),d=h.next();!d.done;d=h.next()){var f=d.value;if(n.adjustRowNumber(s,f))return}}catch(g){i={error:g}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}},n.adjustRowNumber=function(t,e){return e!=null&&!(!e.hasValidRowNumber()||e.getBucket()!==t.getBucket())&&(t.setRowNumber(e.getRowNumber()),!0)},n.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},n.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},n.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},n.prototype.setBoundingBox=function(t){this.boundingBox=t},n.prototype.getBoundingBox=function(){return this.boundingBox},n.prototype.setDetectionResultColumn=function(t,e){this.detectionResultColumns[t]=e},n.prototype.getDetectionResultColumn=function(t){return this.detectionResultColumns[t]},n.prototype.toString=function(){var t=this.detectionResultColumns[0];t==null&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var e=new Hu,r=0;r<t.getCodewords().length;r++){e.format("CW %3d:",r);for(var i=0;i<this.barcodeColumnCount+2;i++)if(this.detectionResultColumns[i]!=null){var o=this.detectionResultColumns[i].getCodewords()[r];o!=null?e.format(" %3d|%3d",o.getRowNumber(),o.getValue()):e.format("    |   ")}else e.format("    |   ");e.format("%n")}return e.toString()},n}(),t3=function(){function n(t,e,r,i){this.rowNumber=n.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(e),this.bucket=Math.trunc(r),this.value=Math.trunc(i)}return n.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},n.prototype.isValidRowNumber=function(t){return t!==n.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3},n.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))},n.prototype.getWidth=function(){return this.endX-this.startX},n.prototype.getStartX=function(){return this.startX},n.prototype.getEndX=function(){return this.endX},n.prototype.getBucket=function(){return this.bucket},n.prototype.getValue=function(){return this.value},n.prototype.getRowNumber=function(){return this.rowNumber},n.prototype.setRowNumber=function(t){this.rowNumber=t},n.prototype.toString=function(){return this.rowNumber+"|"+this.value},n.BARCODE_ROW_UNKNOWN=-1,n}(),e3=function(){function n(){}return n.initialize=function(){for(var t=0;t<ot.SYMBOL_TABLE.length;t++)for(var e=ot.SYMBOL_TABLE[t],r=1&e,i=0;i<ot.BARS_IN_MODULE;i++){for(var o=0;(1&e)===r;)o+=1,e>>=1;r=1&e,n.RATIOS_TABLE[t]||(n.RATIOS_TABLE[t]=new Array(ot.BARS_IN_MODULE)),n.RATIOS_TABLE[t][ot.BARS_IN_MODULE-i-1]=Math.fround(o/ot.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},n.getDecodedValue=function(t){var e=n.getDecodedCodewordValue(n.sampleBitCounts(t));return e!==-1?e:n.getClosestDecodedValue(t)},n.sampleBitCounts=function(t){for(var e=at.sum(t),r=new Int32Array(ot.BARS_IN_MODULE),i=0,o=0,s=0;s<ot.MODULES_IN_CODEWORD;s++){var a=e/(2*ot.MODULES_IN_CODEWORD)+s*e/ot.MODULES_IN_CODEWORD;o+t[i]<=a&&(o+=t[i],i++),r[i]++}return r},n.getDecodedCodewordValue=function(t){var e=n.getBitValue(t);return ot.getCodeword(e)===-1?-1:e},n.getBitValue=function(t){for(var e=0,r=0;r<t.length;r++)for(var i=0;i<t[r];i++)e=e<<1|(r%2==0?1:0);return Math.trunc(e)},n.getClosestDecodedValue=function(t){var e=at.sum(t),r=new Array(ot.BARS_IN_MODULE);if(e>1)for(var i=0;i<r.length;i++)r[i]=Math.fround(t[i]/e);var o=ka.MAX_VALUE,s=-1;this.bSymbolTableReady||n.initialize();for(var a=0;a<n.RATIOS_TABLE.length;a++){for(var u=0,c=n.RATIOS_TABLE[a],h=0;h<ot.BARS_IN_MODULE;h++){var d=Math.fround(c[h]-r[h]);if((u+=Math.fround(d*d))>=o)break}u<o&&(o=u,s=ot.SYMBOL_TABLE[a])}return s},n.bSymbolTableReady=!1,n.RATIOS_TABLE=new Array(ot.SYMBOL_TABLE.length).map(function(t){return new Array(ot.BARS_IN_MODULE)}),n}(),n3=function(){function n(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return n.prototype.getSegmentIndex=function(){return this.segmentIndex},n.prototype.setSegmentIndex=function(t){this.segmentIndex=t},n.prototype.getFileId=function(){return this.fileId},n.prototype.setFileId=function(t){this.fileId=t},n.prototype.getOptionalData=function(){return this.optionalData},n.prototype.setOptionalData=function(t){this.optionalData=t},n.prototype.isLastSegment=function(){return this.lastSegment},n.prototype.setLastSegment=function(t){this.lastSegment=t},n.prototype.getSegmentCount=function(){return this.segmentCount},n.prototype.setSegmentCount=function(t){this.segmentCount=t},n.prototype.getSender=function(){return this.sender||null},n.prototype.setSender=function(t){this.sender=t},n.prototype.getAddressee=function(){return this.addressee||null},n.prototype.setAddressee=function(t){this.addressee=t},n.prototype.getFileName=function(){return this.fileName},n.prototype.setFileName=function(t){this.fileName=t},n.prototype.getFileSize=function(){return this.fileSize},n.prototype.setFileSize=function(t){this.fileSize=t},n.prototype.getChecksum=function(){return this.checksum},n.prototype.setChecksum=function(t){this.checksum=t},n.prototype.getTimestamp=function(){return this.timestamp},n.prototype.setTimestamp=function(t){this.timestamp=t},n}(),Sh=function(){function n(){}return n.parseLong=function(t,e){return e===void 0&&(e=void 0),parseInt(t,e)},n}(),r3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),i3=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return r3(t,n),t.kind="NullPointerException",t}(fe),o3=function(){function n(){}return n.prototype.writeBytes=function(t){this.writeBytesOffset(t,0,t.length)},n.prototype.writeBytesOffset=function(t,e,r){if(t==null)throw new i3;if(e<0||e>t.length||r<0||e+r>t.length||e+r<0)throw new Bu;if(r!==0)for(var i=0;i<r;i++)this.write(t[e+i])},n.prototype.flush=function(){},n.prototype.close=function(){},n}(),s3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),a3=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return s3(t,n),t}(fe),u3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),c3=function(n){function t(e){e===void 0&&(e=32);var r=n.call(this)||this;if(r.count=0,e<0)throw new Z("Negative initial size: "+e);return r.buf=new Uint8Array(e),r}return u3(t,n),t.prototype.ensureCapacity=function(e){e-this.buf.length>0&&this.grow(e)},t.prototype.grow=function(e){var r=this.buf.length<<1;if(r-e<0&&(r=e),r<0){if(e<0)throw new a3;r=Gt.MAX_VALUE}this.buf=we.copyOfUint8Array(this.buf,r)},t.prototype.write=function(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1},t.prototype.writeBytesOffset=function(e,r,i){if(r<0||r>e.length||i<0||r+i-e.length>0)throw new Bu;this.ensureCapacity(this.count+i),wt.arraycopy(e,r,this.buf,this.count,i),this.count+=i},t.prototype.writeTo=function(e){e.writeBytesOffset(this.buf,0,this.count)},t.prototype.reset=function(){this.count=0},t.prototype.toByteArray=function(){return we.copyOfUint8Array(this.buf,this.count)},t.prototype.size=function(){return this.count},t.prototype.toString=function(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()},t.prototype.toString_void=function(){return new String(this.buf).toString()},t.prototype.toString_string=function(e){return new String(this.buf).toString()},t.prototype.toString_number=function(e){return new String(this.buf).toString()},t.prototype.close=function(){},t}(o3);function N1(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}function sn(n){if(ao===void 0&&(ao=N1()),ao===null)throw new Error("BigInt is not supported!");return ao(n)}(function(n){n[n.ALPHA=0]="ALPHA",n[n.LOWER=1]="LOWER",n[n.MIXED=2]="MIXED",n[n.PUNCT=3]="PUNCT",n[n.ALPHA_SHIFT=4]="ALPHA_SHIFT",n[n.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(dt||(dt={}));var l3=function(){function n(){}return n.decode=function(t,e){var r=new pt(""),i=le.ISO8859_1;r.enableDecoding(i);for(var o=1,s=t[o++],a=new n3;o<t[0];){switch(s){case n.TEXT_COMPACTION_MODE_LATCH:o=n.textCompaction(t,o,r);break;case n.BYTE_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH_6:o=n.byteCompaction(s,t,i,o,r);break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o++]);break;case n.NUMERIC_COMPACTION_MODE_LATCH:o=n.numericCompaction(t,o,r);break;case n.ECI_CHARSET:le.getCharacterSetECIByValue(t[o++]);break;case n.ECI_GENERAL_PURPOSE:o+=2;break;case n.ECI_USER_DEFINED:o++;break;case n.BEGIN_MACRO_PDF417_CONTROL_BLOCK:o=n.decodeMacroBlock(t,o,a);break;case n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case n.MACRO_PDF417_TERMINATOR:throw new W;default:o--,o=n.textCompaction(t,o,r)}if(!(o<t.length))throw W.getFormatInstance();s=t[o++]}if(r.length()===0)throw W.getFormatInstance();var u=new gs(null,r.toString(),null,e);return u.setOther(a),u},n.decodeMacroBlock=function(t,e,r){if(e+n.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw W.getFormatInstance();for(var i=new Int32Array(n.NUMBER_OF_SEQUENCE_CODEWORDS),o=0;o<n.NUMBER_OF_SEQUENCE_CODEWORDS;o++,e++)i[o]=t[e];r.setSegmentIndex(Gt.parseInt(n.decodeBase900toBase10(i,n.NUMBER_OF_SEQUENCE_CODEWORDS)));var s=new pt;e=n.textCompaction(t,e,s),r.setFileId(s.toString());var a=-1;for(t[e]===n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(a=e+1);e<t[0];)switch(t[e]){case n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t[++e]){case n.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var u=new pt;e=n.textCompaction(t,e+1,u),r.setFileName(u.toString());break;case n.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var c=new pt;e=n.textCompaction(t,e+1,c),r.setSender(c.toString());break;case n.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var h=new pt;e=n.textCompaction(t,e+1,h),r.setAddressee(h.toString());break;case n.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var d=new pt;e=n.numericCompaction(t,e+1,d),r.setSegmentCount(Gt.parseInt(d.toString()));break;case n.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var f=new pt;e=n.numericCompaction(t,e+1,f),r.setTimestamp(Sh.parseLong(f.toString()));break;case n.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var g=new pt;e=n.numericCompaction(t,e+1,g),r.setChecksum(Gt.parseInt(g.toString()));break;case n.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var _=new pt;e=n.numericCompaction(t,e+1,_),r.setFileSize(Sh.parseLong(_.toString()));break;default:throw W.getFormatInstance()}break;case n.MACRO_PDF417_TERMINATOR:e++,r.setLastSegment(!0);break;default:throw W.getFormatInstance()}if(a!==-1){var v=e-a;r.isLastSegment()&&v--,r.setOptionalData(we.copyOfRange(t,a,a+v))}return e},n.textCompaction=function(t,e,r){for(var i=new Int32Array(2*(t[0]-e)),o=new Int32Array(2*(t[0]-e)),s=0,a=!1;e<t[0]&&!a;){var u=t[e++];if(u<n.TEXT_COMPACTION_MODE_LATCH)i[s]=u/30,i[s+1]=u%30,s+=2;else switch(u){case n.TEXT_COMPACTION_MODE_LATCH:i[s++]=n.TEXT_COMPACTION_MODE_LATCH;break;case n.BYTE_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH_6:case n.NUMERIC_COMPACTION_MODE_LATCH:case n.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case n.MACRO_PDF417_TERMINATOR:e--,a=!0;break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i[s]=n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,u=t[e++],o[s]=u,s++}}return n.decodeTextCompaction(i,o,s,r),e},n.decodeTextCompaction=function(t,e,r,i){for(var o=dt.ALPHA,s=dt.ALPHA,a=0;a<r;){var u=t[a],c="";switch(o){case dt.ALPHA:if(u<26)c=String.fromCharCode(65+u);else switch(u){case 26:c=" ";break;case n.LL:o=dt.LOWER;break;case n.ML:o=dt.MIXED;break;case n.PS:s=o,o=dt.PUNCT_SHIFT;break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(e[a]);break;case n.TEXT_COMPACTION_MODE_LATCH:o=dt.ALPHA}break;case dt.LOWER:if(u<26)c=String.fromCharCode(97+u);else switch(u){case 26:c=" ";break;case n.AS:s=o,o=dt.ALPHA_SHIFT;break;case n.ML:o=dt.MIXED;break;case n.PS:s=o,o=dt.PUNCT_SHIFT;break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(e[a]);break;case n.TEXT_COMPACTION_MODE_LATCH:o=dt.ALPHA}break;case dt.MIXED:if(u<n.PL)c=n.MIXED_CHARS[u];else switch(u){case n.PL:o=dt.PUNCT;break;case 26:c=" ";break;case n.LL:o=dt.LOWER;break;case n.AL:o=dt.ALPHA;break;case n.PS:s=o,o=dt.PUNCT_SHIFT;break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(e[a]);break;case n.TEXT_COMPACTION_MODE_LATCH:o=dt.ALPHA}break;case dt.PUNCT:if(u<n.PAL)c=n.PUNCT_CHARS[u];else switch(u){case n.PAL:o=dt.ALPHA;break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(e[a]);break;case n.TEXT_COMPACTION_MODE_LATCH:o=dt.ALPHA}break;case dt.ALPHA_SHIFT:if(o=s,u<26)c=String.fromCharCode(65+u);else switch(u){case 26:c=" ";break;case n.TEXT_COMPACTION_MODE_LATCH:o=dt.ALPHA}break;case dt.PUNCT_SHIFT:if(o=s,u<n.PAL)c=n.PUNCT_CHARS[u];else switch(u){case n.PAL:o=dt.ALPHA;break;case n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(e[a]);break;case n.TEXT_COMPACTION_MODE_LATCH:o=dt.ALPHA}}c!==""&&i.append(c),a++}},n.byteCompaction=function(t,e,r,i,o){var s=new c3,a=0,u=0,c=!1;switch(t){case n.BYTE_COMPACTION_MODE_LATCH:for(var h=new Int32Array(6),d=e[i++];i<e[0]&&!c;)switch(h[a++]=d,u=900*u+d,d=e[i++]){case n.TEXT_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH:case n.NUMERIC_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH_6:case n.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case n.MACRO_PDF417_TERMINATOR:i--,c=!0;break;default:if(a%5==0&&a>0){for(var f=0;f<6;++f)s.write(Number(sn(u)>>sn(8*(5-f))));u=0,a=0}}i===e[0]&&d<n.TEXT_COMPACTION_MODE_LATCH&&(h[a++]=d);for(var g=0;g<a;g++)s.write(h[g]);break;case n.BYTE_COMPACTION_MODE_LATCH_6:for(;i<e[0]&&!c;){var _=e[i++];if(_<n.TEXT_COMPACTION_MODE_LATCH)a++,u=900*u+_;else switch(_){case n.TEXT_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH:case n.NUMERIC_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH_6:case n.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case n.MACRO_PDF417_TERMINATOR:i--,c=!0}if(a%5==0&&a>0){for(f=0;f<6;++f)s.write(Number(sn(u)>>sn(8*(5-f))));u=0,a=0}}}return o.append(jn.decode(s.toByteArray(),r)),i},n.numericCompaction=function(t,e,r){for(var i=0,o=!1,s=new Int32Array(n.MAX_NUMERIC_CODEWORDS);e<t[0]&&!o;){var a=t[e++];if(e===t[0]&&(o=!0),a<n.TEXT_COMPACTION_MODE_LATCH)s[i]=a,i++;else switch(a){case n.TEXT_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH:case n.BYTE_COMPACTION_MODE_LATCH_6:case n.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case n.MACRO_PDF417_TERMINATOR:e--,o=!0}(i%n.MAX_NUMERIC_CODEWORDS==0||a===n.NUMERIC_COMPACTION_MODE_LATCH||o)&&i>0&&(r.append(n.decodeBase900toBase10(s,i)),i=0)}return e},n.decodeBase900toBase10=function(t,e){for(var r=sn(0),i=0;i<e;i++)r+=n.EXP900[e-i-1]*sn(t[i]);var o=r.toString();if(o.charAt(0)!=="1")throw new W;return o.substring(1)},n.TEXT_COMPACTION_MODE_LATCH=900,n.BYTE_COMPACTION_MODE_LATCH=901,n.NUMERIC_COMPACTION_MODE_LATCH=902,n.BYTE_COMPACTION_MODE_LATCH_6=924,n.ECI_USER_DEFINED=925,n.ECI_GENERAL_PURPOSE=926,n.ECI_CHARSET=927,n.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,n.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,n.MACRO_PDF417_TERMINATOR=922,n.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,n.MAX_NUMERIC_CODEWORDS=15,n.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,n.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,n.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,n.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,n.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,n.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,n.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,n.PL=25,n.LL=27,n.AS=27,n.ML=28,n.AL=28,n.PS=29,n.PAL=29,n.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,n.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",n.EXP900=N1()?function(){var t=[];t[0]=sn(1);var e=sn(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}():[],n.NUMBER_OF_SEQUENCE_CODEWORDS=2,n}(),qr=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},h3=function(){function n(){}return n.decode=function(t,e,r,i,o,s,a){for(var u,c=new Ba(t,e,r,i,o),h=null,d=null,f=!0;;f=!1){if(e!=null&&(h=n.getRowIndicatorColumn(t,c,e,!0,s,a)),i!=null&&(d=n.getRowIndicatorColumn(t,c,i,!1,s,a)),(u=n.merge(h,d))==null)throw V.getNotFoundInstance();var g=u.getBoundingBox();if(!f||g==null||!(g.getMinY()<c.getMinY()||g.getMaxY()>c.getMaxY()))break;c=g}u.setBoundingBox(c);var _=u.getBarcodeColumnCount()+1;u.setDetectionResultColumn(0,h),u.setDetectionResultColumn(_,d);for(var v=h!=null,I=1;I<=_;I++){var T=v?I:_-I;if(u.getDetectionResultColumn(T)===void 0){var N=void 0;N=T===0||T===_?new Ch(c,T===0):new R1(c),u.setDetectionResultColumn(T,N);for(var k=-1,P=k,B=c.getMinY();B<=c.getMaxY();B++){if((k=n.getStartColumn(u,T,B,v))<0||k>c.getMaxX()){if(P===-1)continue;k=P}var F=n.detectCodeword(t,c.getMinX(),c.getMaxX(),v,k,B,s,a);F!=null&&(N.setCodeword(B,F),P=k,s=Math.min(s,F.getWidth()),a=Math.max(a,F.getWidth()))}}}return n.createDecoderResult(u)},n.merge=function(t,e){if(t==null&&e==null)return null;var r=n.getBarcodeMetadata(t,e);if(r==null)return null;var i=Ba.merge(n.adjustBoundingBox(t),n.adjustBoundingBox(e));return new J4(r,i)},n.adjustBoundingBox=function(t){var e,r;if(t==null)return null;var i=t.getRowHeights();if(i==null)return null;var o=n.getMax(i),s=0;try{for(var a=qr(i),u=a.next();!u.done;u=a.next()){var c=u.value;if(s+=o-c,c>0)break}}catch(g){e={error:g}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}for(var h=t.getCodewords(),d=0;s>0&&h[d]==null;d++)s--;var f=0;for(d=i.length-1;d>=0&&(f+=o-i[d],!(i[d]>0));d--);for(d=h.length-1;f>0&&h[d]==null;d--)f--;return t.getBoundingBox().addMissingRows(s,f,t.isLeft())},n.getMax=function(t){var e,r,i=-1;try{for(var o=qr(t),s=o.next();!s.done;s=o.next()){var a=s.value;i=Math.max(i,a)}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i},n.getBarcodeMetadata=function(t,e){var r,i;return t==null||(r=t.getBarcodeMetadata())==null?e==null?null:e.getBarcodeMetadata():e==null||(i=e.getBarcodeMetadata())==null?r:r.getColumnCount()!==i.getColumnCount()&&r.getErrorCorrectionLevel()!==i.getErrorCorrectionLevel()&&r.getRowCount()!==i.getRowCount()?null:r},n.getRowIndicatorColumn=function(t,e,r,i,o,s){for(var a=new Ch(e,i),u=0;u<2;u++)for(var c=u===0?1:-1,h=Math.trunc(Math.trunc(r.getX())),d=Math.trunc(Math.trunc(r.getY()));d<=e.getMaxY()&&d>=e.getMinY();d+=c){var f=n.detectCodeword(t,0,t.getWidth(),i,h,d,o,s);f!=null&&(a.setCodeword(d,f),h=i?f.getStartX():f.getEndX())}return a},n.adjustCodewordCount=function(t,e){var r=e[0][1],i=r.getValue(),o=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-n.getNumberOfECCodeWords(t.getBarcodeECLevel());if(i.length===0){if(o<1||o>ot.MAX_CODEWORDS_IN_BARCODE)throw V.getNotFoundInstance();r.setValue(o)}else i[0]!==o&&r.setValue(o)},n.createDecoderResult=function(t){var e=n.createBarcodeMatrix(t);n.adjustCodewordCount(t,e);for(var r=new Array,i=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),o=[],s=new Array,a=0;a<t.getBarcodeRowCount();a++)for(var u=0;u<t.getBarcodeColumnCount();u++){var c=e[a][u+1].getValue(),h=a*t.getBarcodeColumnCount()+u;c.length===0?r.push(h):c.length===1?i[h]=c[0]:(s.push(h),o.push(c))}for(var d=new Array(o.length),f=0;f<d.length;f++)d[f]=o[f];return n.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),i,ot.toIntArray(r),ot.toIntArray(s),d)},n.createDecoderResultFromAmbiguousValues=function(t,e,r,i,o){for(var s=new Int32Array(i.length),a=100;a-- >0;){for(var u=0;u<s.length;u++)e[i[u]]=o[u][s[u]];try{return n.decodeCodewords(e,t,r)}catch(c){if(!(c instanceof xt))throw c}if(s.length===0)throw xt.getChecksumInstance();for(u=0;u<s.length;u++){if(s[u]<o[u].length-1){s[u]++;break}if(s[u]=0,u===s.length-1)throw xt.getChecksumInstance()}}throw xt.getChecksumInstance()},n.createBarcodeMatrix=function(t){for(var e,r,i,o,s=Array.from({length:t.getBarcodeRowCount()},function(){return new Array(t.getBarcodeColumnCount()+2)}),a=0;a<s.length;a++)for(var u=0;u<s[a].length;u++)s[a][u]=new Jr;var c=0;try{for(var h=qr(t.getDetectionResultColumns()),d=h.next();!d.done;d=h.next()){var f=d.value;if(f!=null)try{for(var g=(i=void 0,qr(f.getCodewords())),_=g.next();!_.done;_=g.next()){var v=_.value;if(v!=null){var I=v.getRowNumber();if(I>=0){if(I>=s.length)continue;s[I][c].setValue(v.getValue())}}}}catch(T){i={error:T}}finally{try{_&&!_.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}c++}}catch(T){e={error:T}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}return s},n.isValidBarcodeColumn=function(t,e){return e>=0&&e<=t.getBarcodeColumnCount()+1},n.getStartColumn=function(t,e,r,i){var o,s,a=i?1:-1,u=null;if(n.isValidBarcodeColumn(t,e-a)&&(u=t.getDetectionResultColumn(e-a).getCodeword(r)),u!=null)return i?u.getEndX():u.getStartX();if((u=t.getDetectionResultColumn(e).getCodewordNearby(r))!=null)return i?u.getStartX():u.getEndX();if(n.isValidBarcodeColumn(t,e-a)&&(u=t.getDetectionResultColumn(e-a).getCodewordNearby(r)),u!=null)return i?u.getEndX():u.getStartX();for(var c=0;n.isValidBarcodeColumn(t,e-a);){e-=a;try{for(var h=(o=void 0,qr(t.getDetectionResultColumn(e).getCodewords())),d=h.next();!d.done;d=h.next()){var f=d.value;if(f!=null)return(i?f.getEndX():f.getStartX())+a*c*(f.getEndX()-f.getStartX())}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}c++}return i?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()},n.detectCodeword=function(t,e,r,i,o,s,a,u){o=n.adjustCodewordStartColumn(t,e,r,i,o,s);var c,h=n.getModuleBitCount(t,e,r,i,o,s);if(h==null)return null;var d=at.sum(h);if(i)c=o+d;else{for(var f=0;f<h.length/2;f++){var g=h[f];h[f]=h[h.length-1-f],h[h.length-1-f]=g}o=(c=o)-d}if(!n.checkCodewordSkew(d,a,u))return null;var _=e3.getDecodedValue(h),v=ot.getCodeword(_);return v===-1?null:new t3(o,c,n.getCodewordBucketNumber(_),v)},n.getModuleBitCount=function(t,e,r,i,o,s){for(var a=o,u=new Int32Array(8),c=0,h=i?1:-1,d=i;(i?a<r:a>=e)&&c<u.length;)t.get(a,s)===d?(u[c]++,a+=h):(c++,d=!d);return c===u.length||a===(i?r:e)&&c===u.length-1?u:null},n.getNumberOfECCodeWords=function(t){return 2<<t},n.adjustCodewordStartColumn=function(t,e,r,i,o,s){for(var a=o,u=i?-1:1,c=0;c<2;c++){for(;(i?a>=e:a<r)&&i===t.get(a,s);){if(Math.abs(o-a)>n.CODEWORD_SKEW_SIZE)return o;a+=u}u=-u,i=!i}return a},n.checkCodewordSkew=function(t,e,r){return e-n.CODEWORD_SKEW_SIZE<=t&&t<=r+n.CODEWORD_SKEW_SIZE},n.decodeCodewords=function(t,e,r){if(t.length===0)throw W.getFormatInstance();var i=1<<e+1,o=n.correctErrors(t,r,i);n.verifyCodewordCount(t,i);var s=l3.decode(t,""+e);return s.setErrorsCorrected(o),s.setErasures(r.length),s},n.correctErrors=function(t,e,r){if(e!=null&&e.length>r/2+n.MAX_ERRORS||r<0||r>n.MAX_EC_CODEWORDS)throw xt.getChecksumInstance();return n.errorCorrection.decode(t,r,e)},n.verifyCodewordCount=function(t,e){if(t.length<4)throw W.getFormatInstance();var r=t[0];if(r>t.length)throw W.getFormatInstance();if(r===0){if(!(e<t.length))throw W.getFormatInstance();t[0]=t.length-e}},n.getBitCountForCodeword=function(t){for(var e=new Int32Array(8),r=0,i=e.length-1;!((1&t)!==r&&(r=1&t,--i<0));)e[i]++,t>>=1;return e},n.getCodewordBucketNumber=function(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)},n.getCodewordBucketNumber_number=function(t){return n.getCodewordBucketNumber(n.getBitCountForCodeword(t))},n.getCodewordBucketNumber_Int32Array=function(t){return(t[0]-t[2]+t[4]-t[6]+9)%9},n.toString=function(t){for(var e=new Hu,r=0;r<t.length;r++){e.format("Row %2d: ",r);for(var i=0;i<t[r].length;i++){var o=t[r][i];o.getValue().length===0?e.format("        ",null):e.format("%4d(%2d)",o.getValue()[0],o.getConfidence(o.getValue()[0]))}e.format("%n")}return e.toString()},n.CODEWORD_SKEW_SIZE=2,n.MAX_ERRORS=3,n.MAX_EC_CODEWORDS=512,n.errorCorrection=new X4,n}(),d3=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Xo=function(){function n(){}return n.prototype.decode=function(t,e){e===void 0&&(e=null);var r=n.decode(t,e,!1);if(r==null||r.length===0||r[0]==null)throw V.getNotFoundInstance();return r[0]},n.prototype.decodeMultiple=function(t,e){e===void 0&&(e=null);try{return n.decode(t,e,!0)}catch(r){throw r instanceof W||r instanceof xt?V.getNotFoundInstance():r}},n.decode=function(t,e,r){var i,o,s=new Array,a=U4.detectMultiple(t,e,r);try{for(var u=d3(a.getPoints()),c=u.next();!c.done;c=u.next()){var h=c.value,d=h3.decode(a.getBits(),h[4],h[5],h[6],h[7],n.getMinCodewordWidth(h),n.getMaxCodewordWidth(h)),f=new pe(d.getText(),d.getRawBytes(),void 0,h,Y.PDF_417);f.putMetadata(Wt.ERROR_CORRECTION_LEVEL,d.getECLevel());var g=d.getOther();g!=null&&f.putMetadata(Wt.PDF417_EXTRA_METADATA,g),s.push(f)}}catch(_){i={error:_}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}return s.map(function(_){return _})},n.getMaxWidth=function(t,e){return t==null||e==null?0:Math.trunc(Math.abs(t.getX()-e.getX()))},n.getMinWidth=function(t,e){return t==null||e==null?Gt.MAX_VALUE:Math.trunc(Math.abs(t.getX()-e.getX()))},n.getMaxCodewordWidth=function(t){return Math.floor(Math.max(Math.max(n.getMaxWidth(t[0],t[4]),n.getMaxWidth(t[6],t[2])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN),Math.max(n.getMaxWidth(t[1],t[5]),n.getMaxWidth(t[7],t[3])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN)))},n.getMinCodewordWidth=function(t){return Math.floor(Math.min(Math.min(n.getMinWidth(t[0],t[4]),n.getMinWidth(t[6],t[2])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN),Math.min(n.getMinWidth(t[1],t[5]),n.getMinWidth(t[7],t[3])*ot.MODULES_IN_CODEWORD/ot.MODULES_IN_STOP_PATTERN)))},n.prototype.reset=function(){},n}(),f3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),bh=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return f3(t,n),t.kind="ReaderException",t}(fe),Rh=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},O1=function(){function n(){}return n.prototype.decode=function(t,e){return this.setHints(e),this.decodeInternal(t)},n.prototype.decodeWithState=function(t){return this.readers!==null&&this.readers!==void 0||this.setHints(null),this.decodeInternal(t)},n.prototype.setHints=function(t){this.hints=t;var e=t!=null&&t.get(_t.TRY_HARDER)!==void 0,r=t==null?null:t.get(_t.POSSIBLE_FORMATS),i=new Array;if(r!=null){var o=r.some(function(s){return s===Y.UPC_A||s===Y.UPC_E||s===Y.EAN_13||s===Y.EAN_8||s===Y.CODABAR||s===Y.CODE_39||s===Y.CODE_93||s===Y.CODE_128||s===Y.ITF||s===Y.RSS_14||s===Y.RSS_EXPANDED});o&&!e&&i.push(new ir(t)),r.includes(Y.QR_CODE)&&i.push(new zo),r.includes(Y.DATA_MATRIX)&&i.push(new Wo),r.includes(Y.AZTEC)&&i.push(new Ho),r.includes(Y.PDF_417)&&i.push(new Xo),o&&e&&i.push(new ir(t))}i.length===0&&(e||i.push(new ir(t)),i.push(new zo),i.push(new Wo),i.push(new Ho),i.push(new Xo),e&&i.push(new ir(t))),this.readers=i},n.prototype.reset=function(){var t,e;if(this.readers!==null)try{for(var r=Rh(this.readers),i=r.next();!i.done;i=r.next())i.value.reset()}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},n.prototype.decodeInternal=function(t){var e,r;if(this.readers===null)throw new bh("No readers where selected, nothing can be read.");try{for(var i=Rh(this.readers),o=i.next();!o.done;o=i.next()){var s=o.value;try{return s.decode(t,this.hints)}catch(a){if(a instanceof bh)continue}}}catch(a){e={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}throw new V("No MultiFormat Readers were able to detect the code.")},n}(),p3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){e===void 0&&(e=null),r===void 0&&(r=500);var i=new O1;return i.setHints(e),n.call(this,i,r)||this}p3(t,n),t.prototype.decodeBitmap=function(e){return this.reader.decodeWithState(e)}})(Cr);var g3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e){return e===void 0&&(e=500),n.call(this,new Xo,e)||this}g3(t,n)})(Cr);var Nh,m3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e){return e===void 0&&(e=500),n.call(this,new zo,e)||this}m3(t,n)})(Cr),function(n){n[n.ERROR_CORRECTION=0]="ERROR_CORRECTION",n[n.CHARACTER_SET=1]="CHARACTER_SET",n[n.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",n[n.MIN_SIZE=3]="MIN_SIZE",n[n.MAX_SIZE=4]="MAX_SIZE",n[n.MARGIN=5]="MARGIN",n[n.PDF417_COMPACT=6]="PDF417_COMPACT",n[n.PDF417_COMPACTION=7]="PDF417_COMPACTION",n[n.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",n[n.AZTEC_LAYERS=9]="AZTEC_LAYERS",n[n.QR_VERSION=10]="QR_VERSION"}(Nh||(Nh={}));var _3=function(){function n(){}return n.applyMaskPenaltyRule1=function(t){return n.applyMaskPenaltyRule1Internal(t,!0)+n.applyMaskPenaltyRule1Internal(t,!1)},n.applyMaskPenaltyRule2=function(t){for(var e=0,r=t.getArray(),i=t.getWidth(),o=t.getHeight(),s=0;s<o-1;s++)for(var a=r[s],u=0;u<i-1;u++){var c=a[u];c===a[u+1]&&c===r[s+1][u]&&c===r[s+1][u+1]&&e++}return n.N2*e},n.applyMaskPenaltyRule3=function(t){for(var e=0,r=t.getArray(),i=t.getWidth(),o=t.getHeight(),s=0;s<o;s++)for(var a=0;a<i;a++){var u=r[s];a+6<i&&u[a]===1&&u[a+1]===0&&u[a+2]===1&&u[a+3]===1&&u[a+4]===1&&u[a+5]===0&&u[a+6]===1&&(n.isWhiteHorizontal(u,a-4,a)||n.isWhiteHorizontal(u,a+7,a+11))&&e++,s+6<o&&r[s][a]===1&&r[s+1][a]===0&&r[s+2][a]===1&&r[s+3][a]===1&&r[s+4][a]===1&&r[s+5][a]===0&&r[s+6][a]===1&&(n.isWhiteVertical(r,a,s-4,s)||n.isWhiteVertical(r,a,s+7,s+11))&&e++}return e*n.N3},n.isWhiteHorizontal=function(t,e,r){e=Math.max(e,0),r=Math.min(r,t.length);for(var i=e;i<r;i++)if(t[i]===1)return!1;return!0},n.isWhiteVertical=function(t,e,r,i){r=Math.max(r,0),i=Math.min(i,t.length);for(var o=r;o<i;o++)if(t[o][e]===1)return!1;return!0},n.applyMaskPenaltyRule4=function(t){for(var e=0,r=t.getArray(),i=t.getWidth(),o=t.getHeight(),s=0;s<o;s++)for(var a=r[s],u=0;u<i;u++)a[u]===1&&e++;var c=t.getHeight()*t.getWidth();return Math.floor(10*Math.abs(2*e-c)/c)*n.N4},n.getDataMaskBit=function(t,e,r){var i,o;switch(t){case 0:i=r+e&1;break;case 1:i=1&r;break;case 2:i=e%3;break;case 3:i=(r+e)%3;break;case 4:i=Math.floor(r/2)+Math.floor(e/3)&1;break;case 5:i=(1&(o=r*e))+o%3;break;case 6:i=(1&(o=r*e))+o%3&1;break;case 7:i=(o=r*e)%3+(r+e&1)&1;break;default:throw new Z("Invalid mask pattern: "+t)}return i===0},n.applyMaskPenaltyRule1Internal=function(t,e){for(var r=0,i=e?t.getHeight():t.getWidth(),o=e?t.getWidth():t.getHeight(),s=t.getArray(),a=0;a<i;a++){for(var u=0,c=-1,h=0;h<o;h++){var d=e?s[a][h]:s[h][a];d===c?u++:(u>=5&&(r+=n.N1+(u-5)),u=1,c=d)}u>=5&&(r+=n.N1+(u-5))}return r},n.N1=3,n.N2=3,n.N3=40,n.N4=10,n}(),y3=function(){function n(){this.maskPattern=-1}return n.prototype.getMode=function(){return this.mode},n.prototype.getECLevel=function(){return this.ecLevel},n.prototype.getVersion=function(){return this.version},n.prototype.getMaskPattern=function(){return this.maskPattern},n.prototype.getMatrix=function(){return this.matrix},n.prototype.toString=function(){var t=new pt;return t.append(`<<
`),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append(`
 ecLevel: `),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append(`
 version: `),t.append(this.version?this.version.toString():"null"),t.append(`
 maskPattern: `),t.append(this.maskPattern.toString()),this.matrix?(t.append(`
 matrix:
`),t.append(this.matrix.toString())):t.append(`
 matrix: null
`),t.append(`>>
`),t.toString()},n.prototype.setMode=function(t){this.mode=t},n.prototype.setECLevel=function(t){this.ecLevel=t},n.prototype.setVersion=function(t){this.version=t},n.prototype.setMaskPattern=function(t){this.maskPattern=t},n.prototype.setMatrix=function(t){this.matrix=t},n.isValidMaskPattern=function(t){return t>=0&&t<n.NUM_MASK_PATTERNS},n.NUM_MASK_PATTERNS=8,n}(),w3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Pn=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w3(t,n),t.kind="WriterException",t}(fe);(function(){function n(){}return n.clearMatrix=function(t){t.clear(255)},n.buildMatrix=function(t,e,r,i,o){n.clearMatrix(o),n.embedBasicPatterns(r,o),n.embedTypeInfo(e,i,o),n.maybeEmbedVersionInfo(r,o),n.embedDataBits(t,i,o)},n.embedBasicPatterns=function(t,e){n.embedPositionDetectionPatternsAndSeparators(e),n.embedDarkDotAtLeftBottomCorner(e),n.maybeEmbedPositionAdjustmentPatterns(t,e),n.embedTimingPatterns(e)},n.embedTypeInfo=function(t,e,r){var i=new be;n.makeTypeInfoBits(t,e,i);for(var o=0,s=i.getSize();o<s;++o){var a=i.get(i.getSize()-1-o),u=n.TYPE_INFO_COORDINATES[o],c=u[0],h=u[1];if(r.setBoolean(c,h,a),o<8){var d=r.getWidth()-o-1,f=8;r.setBoolean(d,f,a)}else d=8,f=r.getHeight()-7+(o-8),r.setBoolean(d,f,a)}},n.maybeEmbedVersionInfo=function(t,e){if(!(t.getVersionNumber()<7)){var r=new be;n.makeVersionInfoBits(t,r);for(var i=17,o=0;o<6;++o)for(var s=0;s<3;++s){var a=r.get(i);i--,e.setBoolean(o,e.getHeight()-11+s,a),e.setBoolean(e.getHeight()-11+s,o,a)}}},n.embedDataBits=function(t,e,r){for(var i=0,o=-1,s=r.getWidth()-1,a=r.getHeight()-1;s>0;){for(s===6&&(s-=1);a>=0&&a<r.getHeight();){for(var u=0;u<2;++u){var c=s-u;if(n.isEmpty(r.get(c,a))){var h=void 0;i<t.getSize()?(h=t.get(i),++i):h=!1,e!==255&&_3.getDataMaskBit(e,c,a)&&(h=!h),r.setBoolean(c,a,h)}}a+=o}a+=o=-o,s-=2}if(i!==t.getSize())throw new Pn("Not all bits consumed: "+i+"/"+t.getSize())},n.findMSBSet=function(t){return 32-Gt.numberOfLeadingZeros(t)},n.calculateBCHCode=function(t,e){if(e===0)throw new Z("0 polynomial");var r=n.findMSBSet(e);for(t<<=r-1;n.findMSBSet(t)>=r;)t^=e<<n.findMSBSet(t)-r;return t},n.makeTypeInfoBits=function(t,e,r){if(!y3.isValidMaskPattern(e))throw new Pn("Invalid mask pattern");var i=t.getBits()<<3|e;r.appendBits(i,5);var o=n.calculateBCHCode(i,n.TYPE_INFO_POLY);r.appendBits(o,10);var s=new be;if(s.appendBits(n.TYPE_INFO_MASK_PATTERN,15),r.xor(s),r.getSize()!==15)throw new Pn("should not happen but we got: "+r.getSize())},n.makeVersionInfoBits=function(t,e){e.appendBits(t.getVersionNumber(),6);var r=n.calculateBCHCode(t.getVersionNumber(),n.VERSION_INFO_POLY);if(e.appendBits(r,12),e.getSize()!==18)throw new Pn("should not happen but we got: "+e.getSize())},n.isEmpty=function(t){return t===255},n.embedTimingPatterns=function(t){for(var e=8;e<t.getWidth()-8;++e){var r=(e+1)%2;n.isEmpty(t.get(e,6))&&t.setNumber(e,6,r),n.isEmpty(t.get(6,e))&&t.setNumber(6,e,r)}},n.embedDarkDotAtLeftBottomCorner=function(t){if(t.get(8,t.getHeight()-8)===0)throw new Pn;t.setNumber(8,t.getHeight()-8,1)},n.embedHorizontalSeparationPattern=function(t,e,r){for(var i=0;i<8;++i){if(!n.isEmpty(r.get(t+i,e)))throw new Pn;r.setNumber(t+i,e,0)}},n.embedVerticalSeparationPattern=function(t,e,r){for(var i=0;i<7;++i){if(!n.isEmpty(r.get(t,e+i)))throw new Pn;r.setNumber(t,e+i,0)}},n.embedPositionAdjustmentPattern=function(t,e,r){for(var i=0;i<5;++i)for(var o=n.POSITION_ADJUSTMENT_PATTERN[i],s=0;s<5;++s)r.setNumber(t+s,e+i,o[s])},n.embedPositionDetectionPattern=function(t,e,r){for(var i=0;i<7;++i)for(var o=n.POSITION_DETECTION_PATTERN[i],s=0;s<7;++s)r.setNumber(t+s,e+i,o[s])},n.embedPositionDetectionPatternsAndSeparators=function(t){var e=n.POSITION_DETECTION_PATTERN[0].length;n.embedPositionDetectionPattern(0,0,t),n.embedPositionDetectionPattern(t.getWidth()-e,0,t),n.embedPositionDetectionPattern(0,t.getWidth()-e,t),n.embedHorizontalSeparationPattern(0,7,t),n.embedHorizontalSeparationPattern(t.getWidth()-8,7,t),n.embedHorizontalSeparationPattern(0,t.getWidth()-8,t),n.embedVerticalSeparationPattern(7,0,t),n.embedVerticalSeparationPattern(t.getHeight()-7-1,0,t),n.embedVerticalSeparationPattern(7,t.getHeight()-7,t)},n.maybeEmbedPositionAdjustmentPatterns=function(t,e){if(!(t.getVersionNumber()<2))for(var r=t.getVersionNumber()-1,i=n.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r],o=0,s=i.length;o!==s;o++){var a=i[o];if(a>=0)for(var u=0;u!==s;u++){var c=i[u];c>=0&&n.isEmpty(e.get(c,a))&&n.embedPositionAdjustmentPattern(c-2,a-2,e)}}},n.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),n.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),n.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),n.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),n.VERSION_INFO_POLY=7973,n.TYPE_INFO_POLY=1335,n.TYPE_INFO_MASK_PATTERN=21522,n})();(function(){Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),le.UTF8.getName()})();var v3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r,i,o,s,a,u,c){var h=n.call(this,a,u)||this;if(h.yuvData=e,h.dataWidth=r,h.dataHeight=i,h.left=o,h.top=s,o+a>r||s+u>i)throw new Z("Crop rectangle does not fit within image data.");return c&&h.reverseHorizontal(a,u),h}v3(t,n),t.prototype.getRow=function(e,r){if(e<0||e>=this.getHeight())throw new Z("Requested row is outside the image: "+e);var i=this.getWidth();(r==null||r.length<i)&&(r=new Uint8ClampedArray(i));var o=(e+this.top)*this.dataWidth+this.left;return wt.arraycopy(this.yuvData,o,r,0,i),r},t.prototype.getMatrix=function(){var e=this.getWidth(),r=this.getHeight();if(e===this.dataWidth&&r===this.dataHeight)return this.yuvData;var i=e*r,o=new Uint8ClampedArray(i),s=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return wt.arraycopy(this.yuvData,s,o,0,i),o;for(var a=0;a<r;a++){var u=a*e;wt.arraycopy(this.yuvData,s,o,u,e),s+=this.dataWidth}return o},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(e,r,i,o){return new t(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+r,i,o,!1)},t.prototype.renderThumbnail=function(){for(var e=this.getWidth()/t.THUMBNAIL_SCALE_FACTOR,r=this.getHeight()/t.THUMBNAIL_SCALE_FACTOR,i=new Int32Array(e*r),o=this.yuvData,s=this.top*this.dataWidth+this.left,a=0;a<r;a++){for(var u=a*e,c=0;c<e;c++){var h=255&o[s+c*t.THUMBNAIL_SCALE_FACTOR];i[u+c]=4278190080|65793*h}s+=this.dataWidth*t.THUMBNAIL_SCALE_FACTOR}return i},t.prototype.getThumbnailWidth=function(){return this.getWidth()/t.THUMBNAIL_SCALE_FACTOR},t.prototype.getThumbnailHeight=function(){return this.getHeight()/t.THUMBNAIL_SCALE_FACTOR},t.prototype.reverseHorizontal=function(e,r){for(var i=this.yuvData,o=0,s=this.top*this.dataWidth+this.left;o<r;o++,s+=this.dataWidth)for(var a=s+e/2,u=s,c=s+e-1;u<a;u++,c--){var h=i[u];i[u]=i[c],i[c]=h}},t.prototype.invert=function(){return new ps(this)},t.THUMBNAIL_SCALE_FACTOR=2})(Ni);var E3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r,i,o,s,a,u){var c=n.call(this,r,i)||this;if(c.dataWidth=o,c.dataHeight=s,c.left=a,c.top=u,e.BYTES_PER_ELEMENT===4){for(var h=r*i,d=new Uint8ClampedArray(h),f=0;f<h;f++){var g=e[f],_=g>>16&255,v=g>>7&510,I=255&g;d[f]=(_+v+I)/4&255}c.luminances=d}else c.luminances=e;if(o===void 0&&(c.dataWidth=r),s===void 0&&(c.dataHeight=i),a===void 0&&(c.left=0),u===void 0&&(c.top=0),c.left+r>c.dataWidth||c.top+i>c.dataHeight)throw new Z("Crop rectangle does not fit within image data.");return c}E3(t,n),t.prototype.getRow=function(e,r){if(e<0||e>=this.getHeight())throw new Z("Requested row is outside the image: "+e);var i=this.getWidth();(r==null||r.length<i)&&(r=new Uint8ClampedArray(i));var o=(e+this.top)*this.dataWidth+this.left;return wt.arraycopy(this.luminances,o,r,0,i),r},t.prototype.getMatrix=function(){var e=this.getWidth(),r=this.getHeight();if(e===this.dataWidth&&r===this.dataHeight)return this.luminances;var i=e*r,o=new Uint8ClampedArray(i),s=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return wt.arraycopy(this.luminances,s,o,0,i),o;for(var a=0;a<r;a++){var u=a*e;wt.arraycopy(this.luminances,s,o,u,e),s+=this.dataWidth}return o},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(e,r,i,o){return new t(this.luminances,i,o,this.dataWidth,this.dataHeight,this.left+e,this.top+r)},t.prototype.invert=function(){return new ps(this)}})(Ni);var I3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}I3(t,n),t.forName=function(e){return this.getCharacterSetECIByName(e)}})(le);var A3=function(){function n(t){this.previous=t}return n.prototype.getPrevious=function(){return this.previous},n}(),T3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),P1=function(n){function t(e,r,i){var o=n.call(this,e)||this;return o.value=r,o.bitCount=i,o}return T3(t,n),t.prototype.appendTo=function(e,r){e.appendBits(this.value,this.bitCount)},t.prototype.add=function(e,r){return new t(this,e,r)},t.prototype.addBinaryShift=function(e,r){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new t(this,e,r)},t.prototype.toString=function(){var e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+Gt.toBinaryString(e|1<<this.bitCount).substring(1)+">"},t}(A3),C3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r,i){var o=n.call(this,e,0,0)||this;return o.binaryShiftStart=r,o.binaryShiftByteCount=i,o}C3(t,n),t.prototype.appendTo=function(e,r){for(var i=0;i<this.binaryShiftByteCount;i++)(i===0||i===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):i===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(r[this.binaryShiftStart+i],8)},t.prototype.addBinaryShift=function(e,r){return new t(this,e,r)},t.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}})(P1);new P1(null,0,0);var S3=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(n){var t,e;try{for(var r=S3(n),i=r.next();!i.done;i=r.next()){var o=i.value;we.fill(o,-1)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}n[0][4]=0,n[1][4]=0,n[1][0]=28,n[3][4]=0,n[2][4]=0,n[2][0]=15})(we.createInt32Array(6,6)),function(n){var t=Vt.getCharCode(" "),e=Vt.getCharCode("."),r=Vt.getCharCode(",");n[0][t]=1;for(var i=Vt.getCharCode("Z"),o=Vt.getCharCode("A"),s=o;s<=i;s++)n[0][s]=s-o+2;n[1][t]=1;var a=Vt.getCharCode("z"),u=Vt.getCharCode("a");for(s=u;s<=a;s++)n[1][s]=s-u+2;n[2][t]=1;var c=Vt.getCharCode("9"),h=Vt.getCharCode("0");for(s=h;s<=c;s++)n[2][s]=s-h+2;n[2][r]=12,n[2][e]=13;for(var d=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],f=0;f<d.length;f++)n[3][Vt.getCharCode(d[f])]=f;var g=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(f=0;f<g.length;f++)Vt.getCharCode(g[f])>0&&(n[4][Vt.getCharCode(g[f])]=f)}(we.createInt32Array(5,256));var b3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),R3=function(n){function t(e){var r=n.call(this,e.width,e.height)||this;return r.canvas=e,r.buffer=t.makeBufferFromCanvasImageData(e),r}return b3(t,n),t.makeBufferFromCanvasImageData=function(e){var r=e.getContext("2d");if(!r)throw new Error("Couldn't get canvas context.");var i=r.getImageData(0,0,e.width,e.height);return t.toGrayscaleBuffer(i.data,e.width,e.height)},t.toGrayscaleBuffer=function(e,r,i){for(var o=new Uint8ClampedArray(r*i),s=0,a=0,u=e.length;s<u;s+=4,a++){var c=void 0;e[s+3]===0?c=255:c=306*e[s]+601*e[s+1]+117*e[s+2]+512>>10,o[a]=c}return o},t.prototype.getRow=function(e,r){if(e<0||e>=this.getHeight())throw new Z("Requested row is outside the image: "+e);var i=this.getWidth(),o=e*i;return r===null?r=this.buffer.slice(o,o+i):(r.length<i&&(r=new Uint8ClampedArray(i)),r.set(this.buffer.slice(o,o+i))),r},t.prototype.getMatrix=function(){return this.buffer},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(e,r,i,o){return n.prototype.crop.call(this,e,r,i,o),this},t.prototype.isRotateSupported=function(){return!0},t.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},t.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},t.prototype.invert=function(){return new ps(this)},t.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement},t.prototype.rotate=function(e){var r=this.getTempCanvasElement();if(!r)throw new Error("Could not create a Canvas element.");var i=e*t.DEGREE_TO_RADIANS,o=this.canvas.width,s=this.canvas.height,a=Math.ceil(Math.abs(Math.cos(i))*o+Math.abs(Math.sin(i))*s),u=Math.ceil(Math.abs(Math.sin(i))*o+Math.abs(Math.cos(i))*s);r.width=a,r.height=u;var c=r.getContext("2d");if(!c)throw new Error("Could not create a Convas Context element.");return c.translate(a/2,u/2),c.rotate(i),c.drawImage(this.canvas,o/-2,s/-2),this.buffer=t.makeBufferFromCanvasImageData(r),this},t.DEGREE_TO_RADIANS=Math.PI/180,t}(Ni);function D1(){return typeof navigator<"u"}function N3(){return!!(D1()&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)}var sr=function(){return sr=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},sr.apply(this,arguments)},Tt=function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function s(c){try{u(r.next(c))}catch(h){o(h)}}function a(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){var h;c.done?i(c.value):(h=c.value,h instanceof e?h:new e(function(d){d(h)})).then(s,a)}u((r=r.apply(n,[])).next())})},Ct=function(n,t){var e,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return function(h){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(i=2&h[0]?r.return:h[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,h[1])).done)return i;switch(r=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return s.label++,{value:h[1],done:!1};case 5:s.label++,r=h[1],h=[0];continue;case 7:h=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||h[0]!==6&&h[0]!==2)){s=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){s.label=h[1];break}if(h[0]===6&&s.label<i[1]){s.label=i[1],i=h;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(h);break}i[2]&&s.ops.pop(),s.trys.pop();continue}h=t.call(n,s)}catch(d){h=[6,d],r=0}finally{e=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([u,c])}}},uo=function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},O3={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},Sr=function(){function n(t,e,r){e===void 0&&(e=new Map),r===void 0&&(r={}),this.reader=t,this.hints=e,this.options=sr(sr({},O3),r)}return Object.defineProperty(n.prototype,"possibleFormats",{set:function(t){this.hints.set(_t.POSSIBLE_FORMATS,t)},enumerable:!1,configurable:!0}),n.addVideoSource=function(t,e){try{t.srcObject=e}catch{t.src=URL.createObjectURL(e)}},n.mediaStreamSetTorch=function(t,e){return Tt(this,void 0,void 0,function(){return Ct(this,function(r){switch(r.label){case 0:return[4,t.applyConstraints({advanced:[{fillLightMode:e?"flash":"off",torch:!!e}]})];case 1:return r.sent(),[2]}})})},n.mediaStreamIsTorchCompatible=function(t){var e,r,i=t.getVideoTracks();try{for(var o=uo(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(n.mediaStreamIsTorchCompatibleTrack(a))return!0}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!1},n.mediaStreamIsTorchCompatibleTrack=function(t){try{return"torch"in t.getCapabilities()}catch(e){return console.error(e),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},n.isVideoPlaying=function(t){return t.currentTime>0&&!t.paused&&t.readyState>2},n.getMediaElement=function(t,e){var r=document.getElementById(t);if(!r)throw new St("element with id '"+t+"' not found");if(r.nodeName.toLowerCase()!==e.toLowerCase())throw new St("element with id '"+t+"' must be an "+e+" element");return r},n.createVideoElement=function(t){if(t instanceof HTMLVideoElement)return t;if(typeof t=="string")return n.getMediaElement(t,"video");if(!t&&typeof document<"u"){var e=document.createElement("video");return e.width=200,e.height=200,e}throw new Error("Couldn't get videoElement from videoSource!")},n.prepareImageElement=function(t){if(t instanceof HTMLImageElement)return t;if(typeof t=="string")return n.getMediaElement(t,"img");if(t===void 0){var e=document.createElement("img");return e.width=200,e.height=200,e}throw new Error("Couldn't get imageElement from imageSource!")},n.prepareVideoElement=function(t){var e=n.createVideoElement(t);return e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e},n.isImageLoaded=function(t){return!!t.complete&&t.naturalWidth!==0},n.createBinaryBitmapFromCanvas=function(t){var e=new R3(t),r=new w1(e);return new y1(r)},n.drawImageOnCanvas=function(t,e){t.drawImage(e,0,0)},n.getMediaElementDimensions=function(t){if(t instanceof HTMLVideoElement)return{height:t.videoHeight,width:t.videoWidth};if(t instanceof HTMLImageElement)return{height:t.naturalHeight||t.height,width:t.naturalWidth||t.width};throw new Error("Couldn't find the Source's dimentions!")},n.createCaptureCanvas=function(t){if(!t)throw new St("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var e=document.createElement("canvas"),r=n.getMediaElementDimensions(t),i=r.width,o=r.height;return e.style.width=i+"px",e.style.height=o+"px",e.width=i,e.height=o,e},n.tryPlayVideo=function(t){return Tt(this,void 0,void 0,function(){var e;return Ct(this,function(r){switch(r.label){case 0:if(t!=null&&t.ended)return console.error("Trying to play video that has ended."),[2,!1];if(n.isVideoPlaying(t))return console.warn("Trying to play video that is already playing."),[2,!0];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.play()];case 2:return r.sent(),[2,!0];case 3:return e=r.sent(),console.warn("It was not possible to play the video.",e),[2,!1];case 4:return[2]}})})},n.createCanvasFromMediaElement=function(t){var e=n.createCaptureCanvas(t),r=e.getContext("2d");if(!r)throw new Error("Couldn't find Canvas 2D Context.");return n.drawImageOnCanvas(r,t),e},n.createBinaryBitmapFromMediaElem=function(t){var e=n.createCanvasFromMediaElement(t);return n.createBinaryBitmapFromCanvas(e)},n.destroyImageElement=function(t){t.src="",t.removeAttribute("src"),t=void 0},n.listVideoInputDevices=function(){return Tt(this,void 0,void 0,function(){var t,e,r,i,o,s,a,u,c,h,d,f;return Ct(this,function(g){switch(g.label){case 0:if(!D1())throw new Error("Can't enumerate devices, navigator is not present.");if(!N3())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:t=g.sent(),e=[];try{for(r=uo(t),i=r.next();!i.done;i=r.next())o=i.value,(s=o.kind==="video"?"videoinput":o.kind)==="videoinput"&&(a=o.deviceId||o.id,u=o.label||"Video device "+(e.length+1),c=o.groupId,h={deviceId:a,label:u,kind:s,groupId:c},e.push(h))}catch(_){d={error:_}}finally{try{i&&!i.done&&(f=r.return)&&f.call(r)}finally{if(d)throw d.error}}return[2,e]}})})},n.findDeviceById=function(t){return Tt(this,void 0,void 0,function(){var e;return Ct(this,function(r){switch(r.label){case 0:return[4,n.listVideoInputDevices()];case 1:return(e=r.sent())?[2,e.find(function(i){return i.deviceId===t})]:[2]}})})},n.cleanVideoSource=function(t){if(t){try{t.srcObject=null}catch{t.src=""}t&&t.removeAttribute("src")}},n.playVideoOnLoadAsync=function(t,e){return Tt(this,void 0,void 0,function(){return Ct(this,function(r){switch(r.label){case 0:return[4,n.tryPlayVideo(t)];case 1:return r.sent()?[2,!0]:[2,new Promise(function(i,o){var s=setTimeout(function(){n.isVideoPlaying(t)||(o(!1),t.removeEventListener("canplay",a))},e),a=function(){n.tryPlayVideo(t).then(function(u){clearTimeout(s),t.removeEventListener("canplay",a),i(u)})};t.addEventListener("canplay",a)})]}})})},n.attachStreamToVideo=function(t,e,r){return r===void 0&&(r=5e3),Tt(this,void 0,void 0,function(){var i;return Ct(this,function(o){switch(o.label){case 0:return i=n.prepareVideoElement(e),n.addVideoSource(i,t),[4,n.playVideoOnLoadAsync(i,r)];case 1:return o.sent(),[2,i]}})})},n._waitImageLoad=function(t){return new Promise(function(e,r){var i=setTimeout(function(){n.isImageLoaded(t)||(t.removeEventListener("load",o),r())},1e4),o=function(){clearTimeout(i),t.removeEventListener("load",o),e()};t.addEventListener("load",o)})},n.checkCallbackFnOrThrow=function(t){if(!t)throw new St("`callbackFn` is a required parameter, you cannot capture results without it.")},n.disposeMediaStream=function(t){t.getVideoTracks().forEach(function(e){return e.stop()}),t=void 0},n.prototype.decode=function(t){var e=n.createCanvasFromMediaElement(t);return this.decodeFromCanvas(e)},n.prototype.decodeBitmap=function(t){return this.reader.decode(t,this.hints)},n.prototype.decodeFromCanvas=function(t){var e=n.createBinaryBitmapFromCanvas(t);return this.decodeBitmap(e)},n.prototype.decodeFromImageElement=function(t){return Tt(this,void 0,void 0,function(){var e;return Ct(this,function(r){switch(r.label){case 0:if(!t)throw new St("An image element must be provided.");return e=n.prepareImageElement(t),[4,this._decodeOnLoadImage(e)];case 1:return[2,r.sent()]}})})},n.prototype.decodeFromImageUrl=function(t){return Tt(this,void 0,void 0,function(){var e;return Ct(this,function(r){switch(r.label){case 0:if(!t)throw new St("An URL must be provided.");(e=n.prepareImageElement()).src=t,r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.decodeFromImageElement(e)];case 2:return[2,r.sent()];case 3:return n.destroyImageElement(e),[7];case 4:return[2]}})})},n.prototype.decodeFromConstraints=function(t,e,r){return Tt(this,void 0,void 0,function(){var i,o;return Ct(this,function(s){switch(s.label){case 0:return n.checkCallbackFnOrThrow(r),[4,navigator.mediaDevices.getUserMedia(t)];case 1:i=s.sent(),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.decodeFromStream(i,e,r)];case 3:return[2,s.sent()];case 4:throw o=s.sent(),n.disposeMediaStream(i),o;case 5:return[2]}})})},n.prototype.decodeFromStream=function(t,e,r){return Tt(this,void 0,void 0,function(){var i,o,s,a,u,c,h,d,f,g,_=this;return Ct(this,function(v){switch(v.label){case 0:return n.checkCallbackFnOrThrow(r),i=this.options.tryPlayVideoTimeout,[4,n.attachStreamToVideo(t,e,i)];case 1:return o=v.sent(),s=function(){var I,T;try{for(var N=uo(t.getVideoTracks()),k=N.next();!k.done;k=N.next())k.value.stop()}catch(P){I={error:P}}finally{try{k&&!k.done&&(T=N.return)&&T.call(N)}finally{if(I)throw I.error}}t=void 0},a=function(){s(),n.cleanVideoSource(o)},u=this.scan(o,r,a),c=t.getVideoTracks(),h=sr(sr({},u),{stop:function(){u.stop()},streamVideoConstraintsApply:function(I,T){return Tt(this,void 0,void 0,function(){var N,k,P,B,F,S;return Ct(this,function(A){switch(A.label){case 0:N=T?c.filter(T):c,A.label=1;case 1:A.trys.push([1,6,7,8]),k=uo(N),P=k.next(),A.label=2;case 2:return P.done?[3,5]:[4,P.value.applyConstraints(I)];case 3:A.sent(),A.label=4;case 4:return P=k.next(),[3,2];case 5:return[3,8];case 6:return B=A.sent(),F={error:B},[3,8];case 7:try{P&&!P.done&&(S=k.return)&&S.call(k)}finally{if(F)throw F.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(I){return c.find(I).getConstraints()},streamVideoSettingsGet:function(I){return c.find(I).getSettings()},streamVideoCapabilitiesGet:function(I){return c.find(I).getCapabilities()}}),n.mediaStreamIsTorchCompatible(t)&&(d=c==null?void 0:c.find(function(I){return n.mediaStreamIsTorchCompatibleTrack(I)}),f=function(I){return Tt(_,void 0,void 0,function(){return Ct(this,function(T){switch(T.label){case 0:return[4,n.mediaStreamSetTorch(d,I)];case 1:return T.sent(),[2]}})})},h.switchTorch=f,g=function(){u.stop(),f(!1)},h.stop=g),[2,h]}})})},n.prototype.decodeFromVideoDevice=function(t,e,r){return Tt(this,void 0,void 0,function(){var i;return Ct(this,function(o){switch(o.label){case 0:return n.checkCallbackFnOrThrow(r),i={video:t?{deviceId:{exact:t}}:{facingMode:"environment"}},[4,this.decodeFromConstraints(i,e,r)];case 1:return[2,o.sent()]}})})},n.prototype.decodeFromVideoElement=function(t,e){return Tt(this,void 0,void 0,function(){var r,i;return Ct(this,function(o){switch(o.label){case 0:if(n.checkCallbackFnOrThrow(e),!t)throw new St("A video element must be provided.");return r=n.prepareVideoElement(t),i=this.options.tryPlayVideoTimeout,[4,n.playVideoOnLoadAsync(r,i)];case 1:return o.sent(),[2,this.scan(r,e)]}})})},n.prototype.decodeFromVideoUrl=function(t,e){return Tt(this,void 0,void 0,function(){var r,i,o;return Ct(this,function(s){switch(s.label){case 0:if(n.checkCallbackFnOrThrow(e),!t)throw new St("An URL must be provided.");return(r=n.prepareVideoElement()).src=t,i=function(){n.cleanVideoSource(r)},o=this.options.tryPlayVideoTimeout,[4,n.playVideoOnLoadAsync(r,o)];case 1:return s.sent(),[2,this.scan(r,e,i)]}})})},n.prototype.decodeOnceFromConstraints=function(t,e){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return r=i.sent(),[4,this.decodeOnceFromStream(r,e)];case 2:return[2,i.sent()]}})})},n.prototype.decodeOnceFromStream=function(t,e){return Tt(this,void 0,void 0,function(){var r,i;return Ct(this,function(o){switch(o.label){case 0:return r=!!e,[4,n.attachStreamToVideo(t,e)];case 1:i=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(i)];case 3:return[2,o.sent()];case 4:return r||n.cleanVideoSource(i),[7];case 5:return[2]}})})},n.prototype.decodeOnceFromVideoDevice=function(t,e){return Tt(this,void 0,void 0,function(){var r;return Ct(this,function(i){switch(i.label){case 0:return r={video:t?{deviceId:{exact:t}}:{facingMode:"environment"}},[4,this.decodeOnceFromConstraints(r,e)];case 1:return[2,i.sent()]}})})},n.prototype.decodeOnceFromVideoElement=function(t){return Tt(this,void 0,void 0,function(){var e,r;return Ct(this,function(i){switch(i.label){case 0:if(!t)throw new St("A video element must be provided.");return e=n.prepareVideoElement(t),r=this.options.tryPlayVideoTimeout,[4,n.playVideoOnLoadAsync(e,r)];case 1:return i.sent(),[4,this.scanOneResult(e)];case 2:return[2,i.sent()]}})})},n.prototype.decodeOnceFromVideoUrl=function(t){return Tt(this,void 0,void 0,function(){var e,r;return Ct(this,function(i){switch(i.label){case 0:if(!t)throw new St("An URL must be provided.");(e=n.prepareVideoElement()).src=t,r=this.decodeOnceFromVideoElement(e),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,r];case 2:return[2,i.sent()];case 3:return n.cleanVideoSource(e),[7];case 4:return[2]}})})},n.prototype.scanOneResult=function(t,e,r,i){var o=this;return e===void 0&&(e=!0),r===void 0&&(r=!0),i===void 0&&(i=!0),new Promise(function(s,a){o.scan(t,function(u,c,h){if(u)return s(u),void h.stop();if(c){if(c instanceof V&&e||c instanceof xt&&r||c instanceof W&&i)return;h.stop(),a(c)}})})},n.prototype.scan=function(t,e,r){var i=this;n.checkCallbackFnOrThrow(e);var o=n.createCaptureCanvas(t),s=o.getContext("2d");if(!s)throw new Error("Couldn't create canvas for visual element scan.");var a,u=function(){s=void 0,o=void 0},c=!1,h={stop:function(){c=!0,clearTimeout(a),u(),r&&r()}},d=function(){if(!c)try{n.drawImageOnCanvas(s,t);var f=i.decodeFromCanvas(o);e(f,void 0,h),a=setTimeout(d,i.options.delayBetweenScanSuccess)}catch(g){if(e(void 0,g,h),g instanceof xt||g instanceof W||g instanceof V)return void(a=setTimeout(d,i.options.delayBetweenScanAttempts));u(),r&&r(g)}};return d(),h},n.prototype._decodeOnLoadImage=function(t){return Tt(this,void 0,void 0,function(){return Ct(this,function(e){switch(e.label){case 0:return n.isImageLoaded(t)?[3,2]:[4,n._waitImageLoad(t)];case 1:e.sent(),e.label=2;case 2:return[2,this.decode(t)]}})})},n}(),P3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){return n.call(this,new Ho,e,r)||this}P3(t,n)})(Sr);var D3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){return n.call(this,new ir(e),e,r)||this}D3(t,n)})(Sr);var x3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){return n.call(this,new Wo,e,r)||this}x3(t,n)})(Sr);var M3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){var i=this,o=new O1;return o.setHints(e),(i=n.call(this,o,e,r)||this).reader=o,i}M3(t,n),Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(_t.POSSIBLE_FORMATS,e),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),t.prototype.decodeBitmap=function(e){return this.reader.decodeWithState(e)},t.prototype.setHints=function(e){this.hints=e,this.reader.setHints(this.hints)}})(Sr);var k3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();(function(n){function t(e,r){return n.call(this,new Xo,e,r)||this}k3(t,n)})(Sr);var L3=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},n(t,e)};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),V3=function(n){function t(e,r){return n.call(this,new zo,e,r)||this}return L3(t,n),t}(Sr),co=function(n,t,e){var r=typeof n===e;return r||console.warn('[ReactQrReader]: Expected "'.concat(t,'" to be a of type "').concat(e,'".')),r},B3=function(n){var t=n.scanDelay,e=n.constraints,r=n.onResult,i=n.videoId,o=$.useRef(null);$.useEffect(function(){var s=new V3(null,{delayBetweenScanAttempts:t});return!function(){var a=typeof navigator<"u"&&!!navigator.mediaDevices;return a||console.warn('[ReactQrReader]: MediaDevices API has no support for your browser. You can fix this by running "npm i webrtc-adapter"'),a}()&&co(r,"onResult","function")&&r(null,new Error('MediaDevices API has no support for your browser. You can fix this by running "npm i webrtc-adapter"'),s),co(e,"constraints","object")&&s.decodeFromConstraints({video:e},i,function(a,u){co(r,"onResult","function")&&r(a,u,s)}).then(function(a){return o.current=a}).catch(function(a){co(r,"onResult","function")&&r(null,a,s)}),function(){var a;(a=o.current)===null||a===void 0||a.stop()}},[])},Mn=function(){return Mn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},Mn.apply(this,arguments)},Oh={container:{width:"100%",paddingTop:"100%",overflow:"hidden",position:"relative"},video:{top:0,left:0,width:"100%",height:"100%",display:"block",overflow:"hidden",position:"absolute",transform:void 0}},Fa=function(n){var t=n.videoContainerStyle,e=n.containerStyle,r=n.videoStyle,i=n.constraints,o=n.ViewFinder,s=n.scanDelay,a=n.className,u=n.onResult,c=n.videoId;return B3({constraints:i,scanDelay:s,onResult:u,videoId:c}),$.createElement("section",{className:a,style:e},$.createElement("div",{style:Mn(Mn({},Oh.container),t)},!!o&&$.createElement(o,null),$.createElement("video",{muted:!0,id:c,style:Mn(Mn(Mn({},Oh.video),r),{transform:(i==null?void 0:i.facingMode)==="user"&&"scaleX(-1)"})})))};Fa.displayName="QrReader",Fa.defaultProps={constraints:{facingMode:"user"},videoId:"video",scanDelay:500};const F3=({user:n,handleTabClick:t})=>{const[e,r]=$.useState(!0),[i,o]=$.useState(""),[s,a]=$.useState(null),[u,c]=$.useState(null),[h,d]=$.useState(null),f=async g=>{if(e&&g!=null&&g.text){d(g.text);try{const _=g.text,v=new Date().toISOString().split("T")[0],I=mn(ae,_,n.uid),T=await si(I);if(T.exists()){const N=T.data();if((N.lastScannedDate||"")===v){a("今日は既にスキャンされています。明日またお試しください。"),o("Ranking");return}const P=N.count||0;await Kf(I,{count:P+1,lastScannedDate:v})}else await jo(I,{count:1,lastScannedDate:v});c(`Store: ${_} が正常にスキャンされました！`),t(_),r(!1),setTimeout(()=>{r(!0)},3e3)}catch{a("スキャン中にエラーが発生しました。")}}};return y.jsxs("div",{children:[y.jsx(Fa,{delay:300,onResult:f}),s&&y.jsx("div",{children:s}),u&&y.jsx("div",{children:u}),h&&y.jsxs("div",{children:["読み取ったテキスト: ",h]})," "]})},U3=()=>{const[n,t]=$.useState(null),[e,r]=$.useState("scan"),[i,o]=$.useState("");$.useEffect(()=>{const a=W2(Ri,u=>{t(u||null)});return()=>a()},[]);const s=a=>{console.log("現在のアクティブなタブ:",a),o(a),r("ranking")};return y.jsx("div",{children:n?e==="scan"?y.jsx(F3,{user:n,handleTabClick:s}):y.jsx(p1,{storeName:i}):y.jsx("p",{children:"ログインしてください。"})})},Gu=({AppImage:n,BtnText:t,onClick:e})=>y.jsxs("div",{className:"mb-3 w-[316px] h-[52px] relative",onClick:e,children:[y.jsx("div",{className:"w-[316px] h-[52px] left-0 top-0 absolute bg-white rounded-[26px] border border-[#513c38]"}),y.jsx("img",{className:"w-[27px] h-[27px] left-[21px] top-[13px] absolute",src:n,alt:t}),y.jsx("div",{className:"left-[95px] top-[15px] absolute text-[#513c38] text-[15px] font-medium font-['Noto Sans JP']",children:t})]}),j3=({setCurrentPage:n,setUserInfo:t})=>{const e=async()=>{const r=new Ce;try{const o=(await tu(Ri,r)).user;console.log(o),await jo(mn(ae,"users",o.displayName),{name:o.displayName,address:o.email,icon:o.photoURL,userId:o.uid}),await(async(u,c)=>{const h=await _n(gn(u,"stores"));for(const d of h.docs){const f=d.id,g=mn(u,`${f}`,c.uid),_=await si(g);(!_.exists()||_.data().count===void 0)&&await jo(g,{count:0},{merge:!0})}})(ae,o),await(async()=>{const u=await _n(gn(ae,"stores"));for(const c of u.docs){const h=c.id,d=await _n(gn(ae,h));let f=0;d.forEach(_=>{const v=_.data();v.count&&(f+=v.count)});const g=mn(ae,"stores",h);await Kf(g,{score:f}),console.log(`Total score for ${h}: ${f}`)}})(),t({name:o.displayName,address:o.email,icon:o.photoURL,userId:o.uid,email:o.email}),n("Map")}catch(i){console.error("Googleログインエラー:",i)}};return y.jsx(Gu,{BtnText:"Googleでログイン",AppImage:"/public/images/Google.png",onClick:e})},H3=({setCurrentPage:n,setUserInfo:t})=>{const e=async()=>{const r=new ei("apple.com");try{const o=(await tu(Ri,r)).user;console.log(o),t({name:o.displayName,age:null,address:o.email,icon:o.photoURL}),n("map")}catch(i){console.error("Appleログインエラー:",i)}};return y.jsx(Gu,{BtnText:"Appleでログイン",AppImage:"/public/images/apple.svg",onClick:e})},G3=({setCurrentPage:n,setUserInfo:t})=>{const e=async()=>{const r=new Fe;try{const o=(await tu(Ri,r)).user;console.log(o),t({name:o.displayName,age:null,address:o.email,icon:o.photoURL}),n("map")}catch(i){console.error("Twitterログインエラー:",i)}};return y.jsx(Gu,{BtnText:"X(旧Twitter)でログイン",AppImage:"/public/images/twitter.svg",onClick:e})},W3=({setCurrentPage:n,setUserInfo:t})=>y.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[y.jsx("img",{className:"mb-5",src:"/public/images/AppIcon.png",alt:"アイコン"}),y.jsx("p",{className:"text-2xl mb-11 text-[#513C38]",children:"ログイン"}),y.jsx(j3,{setCurrentPage:n,setUserInfo:t}),y.jsx(H3,{setCurrentPage:n,setUserInfo:t}),y.jsx(G3,{setCurrentPage:n,setUserInfo:t})]}),z3=()=>{const[n,t]=$.useState("Toplogin"),[e,r]=$.useState({name:"",age:null,address:"",icon:"",email:""}),i=()=>{switch(n){case"Toplogin":return y.jsx(W3,{setCurrentPage:t,setUserInfo:r});case"ranking":return y.jsx(p1,{});case"menu":return y.jsx(kv,{userInfo:e});case"QRCodeReader":return y.jsx(U3,{});case"trending":return y.jsx(Vv,{});case"map":default:return y.jsx(bv,{})}};return y.jsxs("div",{children:[i(),n!=="Toplogin"&&y.jsx(Cp,{setCurrentPage:t})]})},X3=()=>{const[n,t]=$.useState(null),e=r=>{t(r)};return y.jsx("div",{children:y.jsx(z3,{onSignIn:e,userId:n})})};xh(document.getElementById("root")).render(y.jsx($.StrictMode,{children:y.jsx(X3,{})}));
